/*! For license information please see 879.js.LICENSE.txt */
(self.webpackChunksocial_selectors=self.webpackChunksocial_selectors||[]).push([[879],{879:function(t,e,n){"use strict";n.r(e);var r=n(973),i=n(561),o=n(293),s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function u(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var a,c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},h=h||{},f=c||self;function l(){}function p(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function d(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var v="closure_uid_"+(1e9*Math.random()>>>0),y=0;function m(t,e,n){return t.call.apply(t.bind,arguments)}function g(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function w(t,e,n){return(w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?m:g).apply(null,arguments)}function b(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function I(){return Date.now()}function _(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function T(){this.j=this.j,this.i=this.i}T.prototype.j=!1,T.prototype.ja=function(){if(!this.j&&(this.j=!0,this.G(),0))(function(t){Object.prototype.hasOwnProperty.call(t,v)&&t[v]||(t[v]=++y)})(this)},T.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var E=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},N=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function S(t){return Array.prototype.concat.apply([],arguments)}function A(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function x(t){return/^[\s\xa0]*$/.test(t)}var D,k=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function O(t,e){return-1!=t.indexOf(e)}function C(t,e){return t<e?-1:t>e?1:0}t:{var P=f.navigator;if(P){var L=P.userAgent;if(L){D=L;break t}}D=""}function R(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function M(t){var e={};for(var n in t)e[n]=t[n];return e}var V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function U(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<V.length;o++)n=V[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function G(t){return G[" "](t),t}G[" "]=l;var q,j,F=O(D,"Opera"),J=O(D,"Trident")||O(D,"MSIE"),z=O(D,"Edge"),H=z||J,B=O(D,"Gecko")&&!(O(D.toLowerCase(),"webkit")&&!O(D,"Edge"))&&!(O(D,"Trident")||O(D,"MSIE"))&&!O(D,"Edge"),K=O(D.toLowerCase(),"webkit")&&!O(D,"Edge");function Z(){var t=f.document;return t?t.documentMode:void 0}t:{var X="",W=(j=D,B?/rv:([^\);]+)(\)|;)/.exec(j):z?/Edge\/([\d\.]+)/.exec(j):J?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(j):K?/WebKit\/(\S+)/.exec(j):F?/(?:Version)[ \/]?(\S+)/.exec(j):void 0);if(W&&(X=W?W[1]:""),J){var Y=Z();if(null!=Y&&Y>parseFloat(X)){q=String(Y);break t}}q=X}var Q,$={};function tt(t){return function(t,e){var n=$;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=k(String(q)).split("."),r=k(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=C(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||C(0==s[2].length,0==u[2].length)||C(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e}))}if(f.document&&J){var et=Z();Q=et||(parseInt(q,10)||void 0)}else Q=void 0;var nt=Q,rt=!J||9<=Number(nt),it=J&&!tt("9"),ot=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{f.addEventListener("test",l,e),f.removeEventListener("test",l,e)}catch(t){}return t}();function st(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function ut(t,e){if(st.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(B){t:{try{G(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:at[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}st.prototype.b=function(){this.defaultPrevented=!0},_(ut,st);var at={2:"touch",3:"pen",4:"mouse"};ut.prototype.b=function(){ut.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,it)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var ct="closure_listenable_"+(1e6*Math.random()|0),ht=0;function ft(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++ht,this.Y=this.Z=!1}function lt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function pt(t){this.src=t,this.a={},this.b=0}function dt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=E(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(lt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function vt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}pt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=vt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new ft(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var yt="closure_lm_"+(1e6*Math.random()|0),mt={};function gt(t,e,n,r,i){if(r&&r.once)return bt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)gt(t,e[o],n,r,i);return null}return n=xt(n),t&&t[ct]?t.va(e,n,d(r)?!!r.capture:!!r,i):wt(t,e,n,!1,r,i)}function wt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=d(i)?!!i.capture:!!i;if(s&&!rt)return null;var u=St(t);if(u||(t[yt]=u=new pt(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Nt,e=rt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)ot||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Tt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function bt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)bt(t,e[o],n,r,i);return null}return n=xt(n),t&&t[ct]?t.wa(e,n,d(r)?!!r.capture:!!r,i):wt(t,e,n,!0,r,i)}function It(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)It(t,e[o],n,r,i);else r=d(r)?!!r.capture:!!r,n=xt(n),t&&t[ct]?(t=t.c,(e=String(e).toString())in t.a&&(-1<(n=vt(o=t.a[e],n,r,i))&&(lt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=St(t))&&(e=t.a[e.toString()],t=-1,e&&(t=vt(e,n,r,i)),(n=-1<t?e[t]:null)&&_t(n))}function _t(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[ct])dt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Tt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=St(e))?(dt(n,t),0==n.b&&(n.src=null,e[yt]=null)):lt(t)}}}function Tt(t){return t in mt?mt[t]:mt[t]="on"+t}function Et(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&_t(t),n.call(r,e)}function Nt(t,e){if(t.Y)return!0;if(!rt){if(!e)t:{e=["window","event"];for(var n=f,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Et(t,e=new ut(e,this))}return Et(t,new ut(e,this))}function St(t){return(t=t[yt])instanceof pt?t:null}var At="__closure_events_fn_"+(1e9*Math.random()>>>0);function xt(t){return"function"==typeof t?t:(t[At]||(t[At]=function(e){return t.handleEvent(e)}),t[At])}function Dt(){T.call(this),this.c=new pt(this),this.J=this,this.C=null}function kt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new st(e,t);else if(e instanceof st)e.target=e.target||t;else{var i=e;U(e=new st(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=Ot(s,r,!0,e)&&i}if(i=Ot(s=e.a=t,r,!0,e)&&i,i=Ot(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Ot(s=e.a=n[o],r,!1,e)&&i}function Ot(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&dt(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}_(Dt,T),Dt.prototype[ct]=!0,(a=Dt.prototype).addEventListener=function(t,e,n,r){gt(this,t,e,n,r)},a.removeEventListener=function(t,e,n,r){It(this,t,e,n,r)},a.G=function(){if(Dt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)lt(n[r]);delete e.a[t],e.b--}}this.C=null},a.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},a.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ct=f.JSON.stringify;function Pt(){this.b=this.a=null}var Lt,Rt=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new Vt}),(function(t){t.reset()}));function Mt(){var t=jt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Vt(){this.next=this.b=this.a=null}function Ut(t){f.setTimeout((function(){throw t}),0)}function Gt(t,e){Lt||function(){var t=f.Promise.resolve(void 0);Lt=function(){t.then(Ft)}}(),qt||(Lt(),qt=!0),jt.add(t,e)}Pt.prototype.add=function(t,e){var n=Rt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Vt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Vt.prototype.reset=function(){this.next=this.b=this.a=null};var qt=!1,jt=new Pt;function Ft(){for(var t;t=Mt();){try{t.a.call(t.b)}catch(t){Ut(t)}var e=Rt;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}qt=!1}function Jt(t,e){Dt.call(this),this.b=t||1,this.a=e||f,this.f=w(this.Za,this),this.g=I()}function zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Ht(t,e,n){if("function"==typeof t)n&&(t=w(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=w(t.handleEvent,t)}return 2147483647<Number(e)?-1:f.setTimeout(t,e||0)}function Bt(t){t.a=Ht((function(){t.a=null,t.c&&(t.c=!1,Bt(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}_(Jt,Dt),(a=Jt.prototype).aa=!1,a.M=null,a.Za=function(){if(this.aa){var t=I()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),kt(this,"tick"),this.aa&&(zt(this),this.start()))}},a.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=I())},a.G=function(){Jt.X.G.call(this),zt(this),delete this.a};var Kt=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Bt(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(f.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(T);function Zt(t){T.call(this),this.b=t,this.a={}}_(Zt,T);var Xt=[];function Wt(t,e,n,r){Array.isArray(n)||(n&&(Xt[0]=n.toString()),n=Xt);for(var i=0;i<n.length;i++){var o=gt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Yt(t){R(t.a,(function(t,e){this.a.hasOwnProperty(e)&&_t(t)}),t),t.a={}}function Qt(){this.a=!0}function $t(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Ct(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}Zt.prototype.G=function(){Zt.X.G.call(this),Yt(this)},Zt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Qt.prototype.info=function(){};var te={},ee=null;function ne(){return ee=ee||new Dt}function re(t){st.call(this,te.Fa,t)}function ie(t){var e=ne();kt(e,new re(e,t))}function oe(t,e){st.call(this,te.STAT_EVENT,t),this.stat=e}function se(t){var e=ne();kt(e,new oe(e,t))}function ue(t){st.call(this,te.Ga,t)}function ae(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return f.setTimeout((function(){t()}),e)}te.Fa="serverreachability",_(re,st),te.STAT_EVENT="statevent",_(oe,st),te.Ga="timingevent",_(ue,st);var ce={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},he={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function fe(){}function le(t){var e;return(e=t.a)||(e=t.a={}),e}function pe(){}fe.prototype.a=null;var de,ve={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function ye(){st.call(this,"d")}function me(){st.call(this,"c")}function ge(){}function we(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new Zt(this),this.P=be,t=H?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}_(ye,st),_(me,st),_(ge,fe),de=new ge;var be=45e3,Ie={},_e={};function Te(t,e,n){t.H=1,t.i=He(Ge(e)),t.j=n,t.I=!0,Ee(t,null)}function Ee(t,e){t.u=I(),Ae(t),t.l=Ge(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),on(n.b,"t",r),t.D=0,t.a=$n(t.g,t.g.C?e:null),0<t.O&&(t.F=new Kt(w(t.Ca,t,t.a),t.O)),Wt(t.J,t.a,"readystatechange",t.Xa),e=t.B?M(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ie(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.c,t.m,t.l,t.f,t.S,t.j)}function Ne(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Se(t,n);if(i==_e){4==e&&(t.h=4,se(14),r=!1),$t(t.c,t.f,null,"[Incomplete Response]");break}if(i==Ie){t.h=4,se(15),$t(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}$t(t.c,t.f,i,null),Ce(t,i)}4==e&&0==n.length&&(t.h=1,se(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Hn(e),e.F=!0,se(11))):($t(t.c,t.f,n,"[Invalid Chunked Response]"),Oe(t),ke(t))}function Se(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?_e:(n=Number(e.substring(n,r)),isNaN(n)?Ie:(r+=1)+n>e.length?_e:(e=e.substr(r,n),t.D=r+n,e))}function Ae(t){t.T=I()+t.P,xe(t,t.P)}function xe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ae(w(t.Va,t),e)}function De(t){t.o&&(f.clearTimeout(t.o),t.o=null)}function ke(t){0==t.g.v||t.A||Zn(t.g,t)}function Oe(t){De(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,zt(t.R),Yt(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ce(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||ln(n.b,t)))if(n.I=t.N,!t.C&&ln(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Kn(n),Mn(n)}zn(n),se(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=ae(w(n.Sa,n),6e3));if(1>=fn(n.b)&&n.ea){try{n.ea()}catch(t){}n.ea=void 0}}else Wn(n,11)}else if((t.C||n.a==t)&&Kn(n),!x(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(O(h,"spdy")||O(h,"quic")||O(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(pn(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,ze(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=I()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=Qn(a,a.C?a.ga:null,a.fa),p.C){dn(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(De(d),Ae(d)),a.a=p}else Jn(a);0<n.g.length&&Gn(n)}else"stop"!=i[0]&&"close"!=i[0]||Wn(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Wn(n,7):Rn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);ie(4)}catch(t){}}function Pe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||"string"==typeof t)N(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(p(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(p(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Le(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Le)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Re(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Me(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Me(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Me(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(a=we.prototype).setTimeout=function(t){this.P=t},a.Xa=function(t){t=t.target;var e=this.F;e&&3==On(t)?e.f():this.Ca(t)},a.Ca=function(t){try{if(t==this.a)t:{var e=On(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!H&&!this.a.$())){this.A||4!=e||7==n||ie(8==n||0>=r?3:2),De(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,se(12),Oe(this),ke(this);break t}$t(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ce(this,a)}this.I?(Ne(this,e,o),H&&this.b&&3==e&&(Wt(this.J,this.R,"tick",this.Wa),this.R.start())):($t(this.c,this.f,o,null),Ce(this,o)),4==e&&Oe(this),this.b&&!this.A&&(4==e?Zn(this.g,this):(this.b=!1,Ae(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,se(12)):(this.h=0,se(13)),Oe(this),ke(this)}}}catch(t){}},a.Wa=function(){if(this.a){var t=On(this.a),e=this.a.$();this.D<e.length&&(De(this),Ne(this,t,e),this.b&&4!=t&&Ae(this))}},a.cancel=function(){this.A=!0,Oe(this)},a.Va=function(){this.o=null;var t=I();0<=t-this.T?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(ie(3),se(17)),Oe(this),this.h=2,ke(this)):xe(this,this.T-t)},(a=Le.prototype).K=function(){Re(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},a.L=function(){return Re(this),this.a.concat()},a.get=function(t,e){return Me(this.b,t)?this.b[t]:e},a.set=function(t,e){Me(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},a.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ve=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ue(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ue){this.a=void 0!==e?e:t.a,qe(this,t.f),this.j=t.j,je(this,t.c),Fe(this,t.h),this.g=t.g,e=t.b;var n=new tn;n.c=e.c,e.a&&(n.a=new Le(e.a),n.b=e.b),Je(this,n),this.i=t.i}else t&&(n=String(t).match(Ve))?(this.a=!!e,qe(this,n[1]||"",!0),this.j=Be(n[2]||""),je(this,n[3]||"",!0),Fe(this,n[4]),this.g=Be(n[5]||"",!0),Je(this,n[6]||"",!0),this.i=Be(n[7]||"")):(this.a=!!e,this.b=new tn(null,this.a))}function Ge(t){return new Ue(t)}function qe(t,e,n){t.f=n?Be(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function je(t,e,n){t.c=n?Be(e,!0):e}function Fe(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Je(t,e,n){e instanceof tn?(t.b=e,function(t,e){e&&!t.f&&(en(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(nn(this,e),on(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=Ke(e,Qe)),t.b=new tn(e,t.a))}function ze(t,e,n){t.b.set(e,n)}function He(t){return ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^I()).toString(36)),t}function Be(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ke(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Ze),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ze(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ue.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ke(e,Xe,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Ke(e,Xe,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ke(n,"/"==n.charAt(0)?Ye:We,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ke(n,$e)),t.join("")};var Xe=/[#\/\?@]/g,We=/[#\?:]/g,Ye=/[#\?]/g,Qe=/[#\?@]/g,$e=/#/g;function tn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function en(t){t.a||(t.a=new Le,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function nn(t,e){en(t),e=sn(t,e),Me(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Me((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Re(t)))}function rn(t,e){return en(t),e=sn(t,e),Me(t.a.b,e)}function on(t,e,n){nn(t,e),0<n.length&&(t.c=null,t.a.set(sn(t,e),A(n)),t.b+=n.length)}function sn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(a=tn.prototype).add=function(t,e){en(this),this.c=null,t=sn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},a.forEach=function(t,e){en(this),this.a.forEach((function(n,r){N(n,(function(n){t.call(e,n,r,this)}),this)}),this)},a.L=function(){en(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},a.K=function(t){en(this);var e=[];if("string"==typeof t)rn(this,t)&&(e=S(e,this.a.get(sn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=S(e,t[n])}return e},a.set=function(t,e){return en(this),this.c=null,rn(this,t=sn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},a.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},a.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var un=function(t,e){this.b=t,this.a=e};function an(t){this.g=t||cn,f.PerformanceNavigationTiming?t=0<(t=f.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(f.ia&&f.ia.ya&&f.ia.ya()&&f.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var cn=10;function hn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function fn(t){return t.b?1:t.a?t.a.size:0}function ln(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function pn(t,e){t.a?t.a.add(e):t.b=e}function dn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function vn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=u(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return A(t.c)}function yn(){}function mn(){this.a=new yn}function gn(t,e,n){var r=n||"";try{Pe(t,(function(t,n){var i=t;d(t)&&(i=Ct(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function wn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}an.prototype.cancel=function(){var t,e;if(this.c=vn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=u(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},yn.prototype.stringify=function(t){return f.JSON.stringify(t,void 0)},yn.prototype.parse=function(t){return f.JSON.parse(t,void 0)};var bn=f.JSON.parse;function In(t){Dt.call(this),this.headers=new Le,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=_n,this.D=this.F=!1}_(In,Dt);var _n="",Tn=/^https?$/i,En=["POST","PUT"];function Nn(t){return"content-type"==t.toLowerCase()}function Sn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,An(t),Dn(t)}function An(t){t.u||(t.u=!0,kt(t,"complete"),kt(t,"error"))}function xn(t){if(t.b&&void 0!==h&&(!t.s[1]||4!=On(t)||2!=t.W()))if(t.l&&4==On(t))Ht(t.za,0,t);else if(kt(t,"readystatechange"),4==On(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Ve)[1]||null;if(!o&&f.self&&f.self.location){var s=f.self.location.protocol;o=s.substr(0,s.length-1)}i=!Tn.test(o?o.toLowerCase():"")}e=i}if(e)kt(t,"complete"),kt(t,"success");else{t.h=6;try{var u=2<On(t)?t.a.statusText:""}catch(n){u=""}t.f=u+" ["+t.W()+"]",An(t)}}finally{Dn(t)}}}function Dn(t,e){if(t.a){kn(t);var n=t.a,r=t.s[0]?l:null;t.a=null,t.s=null,e||kt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function kn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(f.clearTimeout(t.m),t.m=null)}function On(t){return t.a?t.a.readyState:0}function Cn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return R(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):ze(t,e,n))}function Pn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Ln(t){this.pa=0,this.g=[],this.c=new Qt,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Pn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Pn("baseRetryDelayMs",5e3,t),this.Ra=Pn("retryDelaySeedMs",1e4,t),this.Ma=Pn("forwardChannelMaxRetries",2,t),this.ma=Pn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new an(t&&t.concurrentRequestLimit),this.ka=new mn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Rn(t){if(Vn(t),3==t.v){var e=t.R++,n=Ge(t.B);ze(n,"SID",t.J),ze(n,"RID",e),ze(n,"TYPE","terminate"),jn(t,n),(e=new we(t,t.c,e,void 0)).H=2,e.i=He(Ge(n)),n=!1,f.navigator&&f.navigator.sendBeacon&&(n=f.navigator.sendBeacon(e.i.toString(),"")),!n&&f.Image&&((new Image).src=e.i,n=!0),n||(e.a=$n(e.g,null),e.a.ba(e.i)),e.u=I(),Ae(e)}Yn(t)}function Mn(t){t.a&&(Hn(t),t.a.cancel(),t.a=null)}function Vn(t){Mn(t),t.j&&(f.clearTimeout(t.j),t.j=null),Kn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&f.clearTimeout(t.h),t.h=null)}function Un(t,e){t.g.push(new un(t.Oa++,e)),3==t.v&&Gn(t)}function Gn(t){hn(t.b)||t.h||(t.h=!0,Gt(t.Ba,t),t.u=0)}function qn(t,e){var n;n=e?e.f:t.R++;var r=Ge(t.B);ze(r,"SID",t.J),ze(r,"RID",n),ze(r,"AID",t.P),jn(t,r),t.i&&t.l&&Cn(r,t.i,t.l),n=new we(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Fn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),pn(t.b,n),Te(n,r,e)}function jn(t,e){t.f&&Pe({},(function(t,n){ze(e,n,t)}))}function Fn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?w(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{gn(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Jn(t){t.a||t.j||(t.T=1,Gt(t.Aa,t),t.o=0)}function zn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ae(w(t.Aa,t),Xn(t,t.o)),t.o++,!0)}function Hn(t){null!=t.s&&(f.clearTimeout(t.s),t.s=null)}function Bn(t){t.a=new we(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ge(t.la);ze(e,"RID","rpc"),ze(e,"SID",t.J),ze(e,"CI",t.H?"0":"1"),ze(e,"AID",t.P),jn(t,e),ze(e,"TYPE","xmlhttp"),t.i&&t.l&&Cn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=He(Ge(e)),n.j=null,n.I=!0,Ee(n,t)}function Kn(t){null!=t.m&&(f.clearTimeout(t.m),t.m=null)}function Zn(t,e){var n=null;if(t.a==e){Kn(t),Hn(t),t.a=null;var r=2}else{if(!ln(t.b,e))return;n=e.s,dn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=I()-e.u;var i=t.u;kt(r=ne(),new ue(r,n,e,i)),Gn(t)}else Jn(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(fn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=ae(w(t.Ba,t,e),Xn(t,t.u)),t.u++,0)))}(t,e)||2==r&&zn(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Wn(t,5);break;case 4:Wn(t,10);break;case 3:Wn(t,6);break;default:Wn(t,2)}}function Xn(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function Wn(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=w(t.Ya,t);n||(n=new Ue("//www.google.com/images/cleardot.gif"),f.location&&"http"==f.location.protocol||qe(n,"https"),He(n)),function(t,e){var n=new Qt;if(f.Image){var r=new Image;r.onload=b(wn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=b(wn,n,r,"TestLoadImage: error",!1,e),r.onabort=b(wn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=b(wn,n,r,"TestLoadImage: timeout",!1,e),f.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else se(2);t.v=0,t.f&&t.f.ra(e),Yn(t),Vn(t)}function Yn(t){t.v=0,t.I=-1,t.f&&(0==vn(t.b).length&&0==t.g.length||(t.b.c.length=0,A(t.g),t.g.length=0),t.f.qa())}function Qn(t,e,n){var r=function(t){return t instanceof Ue?Ge(t):new Ue(t,void 0)}(n);if(""!=r.c)e&&je(r,e+"."+r.c),Fe(r,r.h);else{var i=f.location;r=function(t,e,n,r){var i=new Ue(null,void 0);return t&&qe(i,t),e&&je(i,e),n&&Fe(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&R(t.V,(function(t,e){ze(r,e,t)})),e=t.A,n=t.na,e&&n&&ze(r,e,n),ze(r,"VER",t.ha),jn(t,r),r}function $n(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new In(t.Na)).F=t.C,e}function tr(){}function er(){if(J&&!(10<=Number(nt)))throw Error("Environmental error: no available transport.")}function nr(t,e){Dt.call(this),this.a=new Ln(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!x(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!x(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new or(this)}function rr(t){ye.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function ir(){me.call(this),this.status=1}function or(t){this.a=t}(a=In.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?le(this.H):le(de),this.a.onreadystatechange=w(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Sn(this,t)}t=n||"";var i=new Le(this.headers);r&&Pe(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=Nn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=f.FormData&&t instanceof f.FormData,!(0<=E(En,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{kn(this),0<this.o&&((this.D=function(t){return J&&tt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=w(this.xa,this)):this.m=Ht(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Sn(this,t)}},a.xa=function(){void 0!==h&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,kt(this,"timeout"),this.abort(8))},a.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,kt(this,"complete"),kt(this,"abort"),Dn(this))},a.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Dn(this,!0)),In.X.G.call(this)},a.za=function(){this.j||(this.A||this.l||this.g?xn(this):this.Ua())},a.Ua=function(){xn(this)},a.W=function(){try{return 2<On(this)?this.a.status:-1}catch(t){return-1}},a.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},a.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),bn(e)}},a.ua=function(){return this.h},a.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(a=Ln.prototype).ha=8,a.v=1,a.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new we(this,this.c,t,void 0),r=this.l;if(this.O&&(r?U(r=M(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Fn(this,n,e),ze(i=Ge(this.B),"RID",t),ze(i,"CVER",22),this.A&&ze(i,"X-HTTP-Session-Id",this.A),jn(this,i),this.i&&r&&Cn(i,this.i,r),pn(this.b,n),this.Ia&&ze(i,"TYPE","init"),this.da?(ze(i,"$req",e),ze(i,"SID","null"),n.U=!0,Te(n,i,null)):Te(n,i,e),this.v=2}}else 3==this.v&&(t?qn(this,t):0==this.g.length||hn(this.b)||qn(this))},a.Aa=function(){if(this.j=null,Bn(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=ae(w(this.Ta,this),t)}},a.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,se(10),Mn(this),Bn(this))},a.Sa=function(){null!=this.m&&(this.m=null,Mn(this),zn(this),se(19))},a.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),se(2)):(this.c.info("Failed to ping google.com"),se(1))},(a=tr.prototype).ta=function(){},a.sa=function(){},a.ra=function(){},a.qa=function(){},a.Ja=function(){},er.prototype.a=function(t,e){return new nr(t,e)},_(nr,Dt),nr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;se(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=Qn(t,null,t.fa),Gn(t)},nr.prototype.close=function(){Rn(this.a)},nr.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,Un(this.a,e)}else this.l?((e={}).__data__=Ct(t),Un(this.a,e)):Un(this.a,t)},nr.prototype.G=function(){this.a.f=null,delete this.f,Rn(this.a),delete this.a,nr.X.G.call(this)},_(rr,ye),_(ir,me),_(or,tr),or.prototype.ta=function(){kt(this.a,"a")},or.prototype.sa=function(t){kt(this.a,new rr(t))},or.prototype.ra=function(t){kt(this.a,new ir(t))},or.prototype.qa=function(){kt(this.a,"b")},er.prototype.createWebChannel=er.prototype.a,nr.prototype.send=nr.prototype.h,nr.prototype.open=nr.prototype.g,nr.prototype.close=nr.prototype.close,ce.NO_ERROR=0,ce.TIMEOUT=8,ce.HTTP_ERROR=6,he.COMPLETE="complete",pe.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",Dt.prototype.listen=Dt.prototype.va,In.prototype.listenOnce=In.prototype.wa,In.prototype.getLastError=In.prototype.Qa,In.prototype.getLastErrorCode=In.prototype.ua,In.prototype.getStatus=In.prototype.W,In.prototype.getResponseJson=In.prototype.Pa,In.prototype.getResponseText=In.prototype.$,In.prototype.send=In.prototype.ba;var sr=function(){return new er},ur=function(){return ne()},ar=ce,cr=he,hr=te,fr={gb:0,jb:1,kb:2,Db:3,Ib:4,Fb:5,Gb:6,Eb:7,Cb:8,Hb:9,PROXY:10,NOPROXY:11,Ab:12,wb:13,xb:14,vb:15,yb:16,zb:17,bb:18,ab:19,cb:20},lr=pe,pr=In,dr=n(940),vr=new i.Yd("@firebase/firestore");function yr(){return vr.logLevel}function mr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(vr.logLevel<=i.in.DEBUG){var r=e.map(br);vr.debug.apply(vr,(0,dr.pr)(["Firestore (8.2.1): "+t],r))}}function gr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(vr.logLevel<=i.in.ERROR){var r=e.map(br);vr.error.apply(vr,(0,dr.pr)(["Firestore (8.2.1): "+t],r))}}function wr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(vr.logLevel<=i.in.WARN){var r=e.map(br);vr.warn.apply(vr,(0,dr.pr)(["Firestore (8.2.1): "+t],r))}}function br(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Ir(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.2.1) INTERNAL ASSERTION FAILED: "+t;throw gr(e),new Error(e)}function _r(t,e){t||Ir()}function Tr(t,e){return t}function Er(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Nr=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Er(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Sr(t,e){return t<e?-1:t>e?1:0}function Ar(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function xr(t){return t+"\0"}var Dr=function(){function t(t){this.i=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.i,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},t.prototype.o=function(){return 2*this.i.length},t.prototype.u=function(t){return Sr(this.i,t.i)},t.prototype.isEqual=function(t){return this.i===t.i},t}();Dr.h=new Dr("");var kr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Or=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return(0,dr.ZT)(e,t),e}(Error),Cr=function(){function t(t){this.l=t}return t.fromBase64String=function(e){try{return new t(Dr.fromBase64String(e))}catch(e){throw new Or(kr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Dr.fromUint8Array(e))},t.prototype.toBase64=function(){return this.l.toBase64()},t.prototype.toUint8Array=function(){return this.l.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.l.isEqual(t.l)},t}(),Pr=function(t){this._=t};function Lr(){if("undefined"==typeof Uint8Array)throw new Or(kr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Rr(){if("undefined"==typeof atob)throw new Or(kr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Mr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,dr.ZT)(e,t),e.fromBase64String=function(t){return Rr(),new e(Cr.fromBase64String(t))},e.fromUint8Array=function(t){return Lr(),new e(Cr.fromUint8Array(t))},e.prototype.toBase64=function(){return Rr(),this._.toBase64()},e.prototype.toUint8Array=function(){return Lr(),this._.toUint8Array()},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(Pr),Vr=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},Ur=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Gr=function(){function t(t){this.uid=t}return t.prototype.A=function(){return null!=this.uid},t.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Gr.UNAUTHENTICATED=new Gr(null),Gr.P=new Gr("google-credentials-uid"),Gr.g=new Gr("first-party-uid");var qr=function(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t},jr=function(){function t(){this.p=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.v=function(){},t.prototype.S=function(t){this.p=t,t(Gr.UNAUTHENTICATED)},t.prototype.D=function(){this.p=null},t}(),Fr=function(){function t(t){var e=this;this.C=null,this.currentUser=Gr.UNAUTHENTICATED,this.N=!1,this.F=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.F++,e.currentUser=e.O(),e.N=!0,e.p&&e.p(e.currentUser)},this.F=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then((function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.F,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.F!==e?(mr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(_r("string"==typeof n.accessToken),new qr(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.v=function(){this.forceRefresh=!0},t.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},t.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},t.prototype.O=function(){var t=this.auth&&this.auth.getUid();return _r(null===t||"string"==typeof t),new Gr(t)},t}(),Jr=function(){function t(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=Gr.g}return Object.defineProperty(t.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),zr=function(){function t(t,e){this.k=t,this.M=e}return t.prototype.getToken=function(){return Promise.resolve(new Jr(this.k,this.M))},t.prototype.S=function(t){t(Gr.g)},t.prototype.D=function(){},t.prototype.v=function(){},t}(),Hr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.L=function(t){return n.$(t)},this.B=function(t){return e.q(t)})}return t.prototype.$=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},t}();Hr.U=-1;var Br=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Or(kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Or(kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Or(kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Or(kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.K=function(t){return this.seconds===t.seconds?Sr(this.nanoseconds,t.nanoseconds):Sr(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Kr=function(){function t(t){this.timestamp=t}return t.W=function(e){return new t(e)},t.min=function(){return new t(new Br(0,0))},t.prototype.u=function(t){return this.timestamp.K(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.j=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.G=function(){return this.timestamp},t}(),Zr=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Ir(),void 0===n?n=t.length-e:n>t.length-e&&Ir(),this.segments=t,this.offset=e,this.H=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.J(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.Y(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.X=function(t){return t=void 0===t?1:t,this.Y(this.segments,this.offset+t,this.length-t)},t.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},t.prototype.tt=function(){return this.segments[this.offset]},t.prototype.et=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.nt=function(){return 0===this.length},t.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},t.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Xr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,dr.ZT)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.prototype.ot=function(){return this.rt().join("/")},e.prototype.toString=function(){return this.ot()},e.ct=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Or(kr.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.at=function(){return new e([])},e}(Zr),Wr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Yr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,dr.ZT)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.ut=function(t){return Wr.test(t)},e.prototype.ot=function(){return this.rt().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.ut(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.ot()},e.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},e.lt=function(){return new e(["__name__"])},e._t=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Or(kr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new Or(kr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Or(kr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new Or(kr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.at=function(){return new e([])},e}(Zr),Qr=function(){function t(t){this.path=t}return t.ft=function(e){return new t(Xr.ct(e))},t.dt=function(e){return new t(Xr.ct(e).X(5))},t.prototype.wt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Xr.J(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.J=function(t,e){return Xr.J(t.path,e.path)},t.Et=function(t){return t.length%2==0},t.Tt=function(e){return new t(new Xr(e.slice()))},t}();function $r(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ti(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ei(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var ni=function(){function t(t){this.fields=t,t.sort(Yr.J)}return t.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},t.prototype.isEqual=function(t){return Ar(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),ri=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ii(t){if(_r(!!t),"string"==typeof t){var e=0,n=ri.exec(t);if(_r(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:oi(t.seconds),nanos:oi(t.nanos)}}function oi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function si(t){return"string"==typeof t?Dr.fromBase64String(t):Dr.fromUint8Array(t)}function ui(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ai(t){var e=t.mapValue.fields.__previous_value__;return ui(e)?ai(e):e}function ci(t){var e=ii(t.mapValue.fields.__local_write_time__.timestampValue);return new Br(e.seconds,e.nanos)}function hi(t){return null==t}function fi(t){return 0===t&&1/t==-1/0}function li(t){return"number"==typeof t&&Number.isInteger(t)&&!fi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function pi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ui(t)?4:10:Ir()}function di(t,e){var n=pi(t);if(n!==pi(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ci(t).isEqual(ci(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=ii(t.timestampValue),r=ii(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return si(t.bytesValue).isEqual(si(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return oi(t.geoPointValue.latitude)===oi(e.geoPointValue.latitude)&&oi(t.geoPointValue.longitude)===oi(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return oi(t.integerValue)===oi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=oi(t.doubleValue),r=oi(e.doubleValue);return n===r?fi(n)===fi(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Ar(t.arrayValue.values||[],e.arrayValue.values||[],di);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if($r(n)!==$r(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!di(n[i],r[i])))return!1;return!0}(t,e);default:return Ir()}}function vi(t,e){return void 0!==(t.values||[]).find((function(t){return di(t,e)}))}function yi(t,e){var n=pi(t),r=pi(e);if(n!==r)return Sr(n,r);switch(n){case 0:return 0;case 1:return Sr(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=oi(t.integerValue||t.doubleValue),r=oi(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return mi(t.timestampValue,e.timestampValue);case 4:return mi(ci(t),ci(e));case 5:return Sr(t.stringValue,e.stringValue);case 6:return function(t,e){var n=si(t),r=si(e);return n.u(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Sr(n[i],r[i]);if(0!==o)return o}return Sr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Sr(oi(t.latitude),oi(e.latitude));return 0!==n?n:Sr(oi(t.longitude),oi(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=yi(n[i],r[i]);if(o)return o}return Sr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Sr(r[s],o[s]);if(0!==u)return u;var a=yi(n[r[s]],i[o[s]]);if(0!==a)return a}return Sr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Ir()}}function mi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Sr(t,e);var n=ii(t),r=ii(e),i=Sr(n.seconds,r.seconds);return 0!==i?i:Sr(n.nanos,r.nanos)}function gi(t){return wi(t)}function wi(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=ii(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?si(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Qr.dt(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=wi(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+wi(t.fields[o])}return e+"}"}(t.mapValue):Ir();var e,n}function bi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function Ii(t){return!!t&&"integerValue"in t}function _i(t){return!!t&&"arrayValue"in t}function Ti(t){return!!t&&"nullValue"in t}function Ei(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ni(t){return!!t&&"mapValue"in t}var Si=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ni(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},t.prototype.isEqual=function(t){return di(this.proto,t.proto)},t}(),Ai=function(){function t(t){void 0===t&&(t=Si.empty()),this.At=t,this.Rt=new Map}return t.prototype.set=function(t,e){return this.Pt(t,e),this},t.prototype.delete=function(t){return this.Pt(t,null),this},t.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===pi(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.et(),e)},t.prototype.yt=function(){var t=this.gt(Yr.at(),this.Rt);return null!=t?new Si(t):this.At},t.prototype.gt=function(t,e){var n=this,r=!1,i=this.At.field(t),o=Ni(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.gt(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function xi(t){var e=[];return ti(t.fields||{},(function(t,n){var r=new Yr([t]);if(Ni(n)){var i=xi(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var u=s[o];e.push(r.child(u))}}else e.push(r)})),new ni(e)}var Di=function(t,e){this.key=t,this.version=e},ki=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).Vt=r,o.bt=!!i.bt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return(0,dr.ZT)(e,t),e.prototype.field=function(t){return this.Vt.field(t)},e.prototype.data=function(){return this.Vt},e.prototype.vt=function(){return this.Vt.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(Di),Oi=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return(0,dr.ZT)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Di),Ci=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,dr.ZT)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Di),Pi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function Li(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Pi(t,e,n,r,i,o,s)}function Ri(t){var e=Tr(t);if(null===e.St){var n=e.path.ot();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.ot()+t.op.toString()+gi(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.ot()+t.dir}(t)})).join(","),hi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Zi(e.startAt)),e.endAt&&(n+="|ub:",n+=Zi(e.endAt)),e.St=n}return e.St}function Mi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Wi(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!di(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Qi(t.startAt,e.startAt)&&Qi(t.endAt,e.endAt)}function Vi(t){return Qr.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ui=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return(0,dr.ZT)(e,t),e.create=function(t,n,r){return t.ht()?"in"===n||"not-in"===n?this.Dt(t,n,r):new Gi(t,n,r):"array-contains"===n?new Ji(t,r):"in"===n?new zi(t,r):"not-in"===n?new Hi(t,r):"array-contains-any"===n?new Bi(t,r):new e(t,n,r)},e.Dt=function(t,e,n){return"in"===e?new qi(t,n):new ji(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Ct(yi(e,this.value)):null!==e&&pi(this.value)===pi(e)&&this.Ct(yi(e,this.value))},e.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Ir()}},e.prototype.xt=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Gi=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Qr.dt(r.referenceValue),i}return(0,dr.ZT)(e,t),e.prototype.matches=function(t){var e=Qr.J(t.key,this.key);return this.Ct(e)},e}(Ui),qi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Fi("in",n),r}return(0,dr.ZT)(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Ui),ji=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Fi("not-in",n),r}return(0,dr.ZT)(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Ui);function Fi(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Qr.dt(t.referenceValue)}))}var Ji=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return(0,dr.ZT)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return _i(e)&&vi(e.arrayValue,this.value)},e}(Ui),zi=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return(0,dr.ZT)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&vi(this.value.arrayValue,e)},e}(Ui),Hi=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return(0,dr.ZT)(e,t),e.prototype.matches=function(t){if(vi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!vi(this.value.arrayValue,e)},e}(Ui),Bi=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return(0,dr.ZT)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!_i(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return vi(e.value.arrayValue,t)}))},e}(Ui),Ki=function(t,e){this.position=t,this.before=e};function Zi(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return gi(t)})).join(",")}var Xi=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Wi(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Yi(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.ht()?Qr.J(Qr.dt(s.referenceValue),n.key):yi(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Qi(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!di(t.position[n],e.position[n]))return!1;return!0}var $i=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Ft=null,this.Ot=null,this.startAt,this.endAt};function to(t,e,n,r,i,o,s,u){return new $i(t,e,n,r,i,o,s,u)}function eo(t){return new $i(t)}function no(t){return!hi(t.limit)&&"F"===t.limitType}function ro(t){return!hi(t.limit)&&"L"===t.limitType}function io(t){return t.Nt.length>0?t.Nt[0].field:null}function oo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function so(t){return null!==t.collectionGroup}function uo(t){var e=Tr(t);if(null===e.Ft){e.Ft=[];var n=oo(e),r=io(e);if(null!==n&&null===r)n.ht()||e.Ft.push(new Xi(n)),e.Ft.push(new Xi(Yr.lt(),"asc"));else{for(var i=!1,o=0,s=e.Nt;o<s.length;o++){var u=s[o];e.Ft.push(u),u.field.ht()&&(i=!0)}if(!i){var a=e.Nt.length>0?e.Nt[e.Nt.length-1].dir:"asc";e.Ft.push(new Xi(Yr.lt(),a))}}}return e.Ft}function ao(t){var e=Tr(t);if(!e.Ot)if("F"===e.limitType)e.Ot=Li(e.path,e.collectionGroup,uo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=uo(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Xi(o.field,s))}var u=e.endAt?new Ki(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Ki(e.startAt.position,!e.startAt.before):null;e.Ot=Li(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.Ot}function co(t,e,n){return new $i(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ho(t,e){return Mi(ao(t),ao(e))&&t.limitType===e.limitType}function fo(t){return Ri(ao(t))+"|lt:"+t.limitType}function lo(t){return"Query(target="+function(t){var e=t.path.ot();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.ot()+" "+e.op+" "+gi(e.value);var e})).join(", ")+"]"),hi(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.ot()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Zi(t.startAt)),t.endAt&&(e+=", endAt: "+Zi(t.endAt)),"Target("+e+")"}(ao(t))+"; limitType="+t.limitType+")"}function po(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.wt(t.collectionGroup)&&t.path.st(n):Qr.Et(t.path)?t.path.isEqual(n):t.path.it(n)}(t,e)&&function(t,e){for(var n=0,r=t.Nt;n<r.length;n++){var i=r[n];if(!i.field.ht()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Yi(t.startAt,uo(t),e)||t.endAt&&Yi(t.endAt,uo(t),e))}(t,e)}function vo(t){return function(e,n){for(var r=!1,i=0,o=uo(t);i<o.length;i++){var s=o[i],u=yo(s,e,n);if(0!==u)return u;r=r||s.field.ht()}return 0}}function yo(t,e,n){var r=t.field.ht()?Qr.J(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?yi(r,i):Ir()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ir()}}var mo=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Kr.min()),void 0===o&&(o=Kr.min()),void 0===s&&(s=Dr.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.Lt=function(e){return new t(this.target,this.targetId,this.kt,e,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.$t=function(e,n){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Bt=function(e){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,e,this.resumeToken)},t}();function go(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fi(e)?"-0":e}}function wo(t){return{integerValue:""+t}}function bo(t,e){return li(e)?wo(e):go(t,e)}var Io=function(){this.Ut=void 0};function _o(t,e,n){return t instanceof No?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof So?Ao(t,e):t instanceof xo?Do(t,e):function(t,e){var n=Eo(t,e),r=Oo(n)+Oo(t.Qt);return Ii(n)&&Ii(t.Qt)?wo(r):go(t.Kt,r)}(t,e)}function To(t,e,n){return t instanceof So?Ao(t,e):t instanceof xo?Do(t,e):n}function Eo(t,e){return t instanceof ko?Ii(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var No=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,dr.ZT)(e,t),e}(Io),So=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,dr.ZT)(e,t),e}(Io);function Ao(t,e){for(var n=Co(e),r=function(t){n.some((function(e){return di(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var xo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,dr.ZT)(e,t),e}(Io);function Do(t,e){for(var n=Co(e),r=function(t){n=n.filter((function(e){return!di(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ko=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Kt=e,r.Qt=n,r}return(0,dr.ZT)(e,t),e}(Io);function Oo(t){return oi(t.integerValue||t.doubleValue)}function Co(t){return _i(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Po=function(t,e){this.field=t,this.transform=e},Lo=function(t,e){this.version=t,this.transformResults=e},Ro=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.Wt=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"jt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Mo(t,e){return void 0!==t.updateTime?e instanceof ki&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof ki}var Vo=function(){};function Uo(t,e,n){return t instanceof Jo?function(t,e,n){var r=t.value;if(n.transformResults){var i=Bo(t.fieldTransforms,e,n.transformResults);r=Zo(t.fieldTransforms,r,i)}return new ki(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof zo?function(t,e,n){if(!Mo(t.Gt,e))return new Ci(t.key,n.version);var r=Ho(t,e,n.transformResults?Bo(t.fieldTransforms,e,n.transformResults):[]);return new ki(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Oi(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Go(t,e,n,r){return t instanceof Jo?function(t,e,n,r){if(!Mo(t.Gt,e))return e;var i=t.value;if(t.fieldTransforms){var o=Ko(t.fieldTransforms,n,e,r);i=Zo(t.fieldTransforms,i,o)}var s=Fo(e);return new ki(t.key,s,i,{bt:!0})}(t,e,r,n):t instanceof zo?function(t,e,n,r){if(!Mo(t.Gt,e))return e;var i=Fo(e),o=Ho(t,e,Ko(t.fieldTransforms,n,e,r));return new ki(t.key,i,o,{bt:!0})}(t,e,r,n):function(t,e){return Mo(t.Gt,e)?new Oi(t.key,Kr.min()):e}(t,e)}function qo(t,e){return void 0!==t.fieldTransforms?function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof ki?e.field(o.field):void 0,u=Eo(o.transform,s||null);null!=u&&(n=null==n?(new Ai).set(o.field,u):n.set(o.field,u))}return n?n.yt():null}(t.fieldTransforms,e):null}function jo(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Ar(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof So&&e instanceof So||t instanceof xo&&e instanceof xo?Ar(t.elements,e.elements,di):t instanceof ko&&e instanceof ko?di(t.Qt,e.Qt):t instanceof No&&e instanceof No}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt))}function Fo(t){return t instanceof ki?t.version:Kr.min()}var Jo=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.Gt=r,o.fieldTransforms=i,o.type=0,o}return(0,dr.ZT)(e,t),e}(Vo),zo=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.zt=r,s.Gt=i,s.fieldTransforms=o,s.type=1,s}return(0,dr.ZT)(e,t),e}(Vo);function Ho(t,e,n){var r;return r=function(t,e){var n=new Ai(e);return t.zt.fields.forEach((function(e){if(!e.nt()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.yt()}(t,r=e instanceof ki?e.data():Si.empty()),Zo(t.fieldTransforms,r,n)}function Bo(t,e,n){var r=[];_r(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof ki&&(u=e.field(o.field)),r.push(To(s,u,n[i]))}return r}function Ko(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof ki&&(c=n.field(u.field)),null===c&&r instanceof ki&&(c=r.field(u.field)),i.push(_o(a,c,e))}return i}function Zo(t,e,n){for(var r=new Ai(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.yt()}var Xo,Wo,Yo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=2,r.fieldTransforms=[],r}return(0,dr.ZT)(e,t),e}(Vo),Qo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=3,r.fieldTransforms=[],r}return(0,dr.ZT)(e,t),e}(Vo),$o=function(t){this.count=t};function ts(t){switch(t){case kr.OK:return Ir();case kr.CANCELLED:case kr.UNKNOWN:case kr.DEADLINE_EXCEEDED:case kr.RESOURCE_EXHAUSTED:case kr.INTERNAL:case kr.UNAVAILABLE:case kr.UNAUTHENTICATED:return!1;case kr.INVALID_ARGUMENT:case kr.NOT_FOUND:case kr.ALREADY_EXISTS:case kr.PERMISSION_DENIED:case kr.FAILED_PRECONDITION:case kr.ABORTED:case kr.OUT_OF_RANGE:case kr.UNIMPLEMENTED:case kr.DATA_LOSS:return!0;default:return Ir()}}function es(t){if(void 0===t)return gr("GRPC error has no .code"),kr.UNKNOWN;switch(t){case Xo.OK:return kr.OK;case Xo.CANCELLED:return kr.CANCELLED;case Xo.UNKNOWN:return kr.UNKNOWN;case Xo.DEADLINE_EXCEEDED:return kr.DEADLINE_EXCEEDED;case Xo.RESOURCE_EXHAUSTED:return kr.RESOURCE_EXHAUSTED;case Xo.INTERNAL:return kr.INTERNAL;case Xo.UNAVAILABLE:return kr.UNAVAILABLE;case Xo.UNAUTHENTICATED:return kr.UNAUTHENTICATED;case Xo.INVALID_ARGUMENT:return kr.INVALID_ARGUMENT;case Xo.NOT_FOUND:return kr.NOT_FOUND;case Xo.ALREADY_EXISTS:return kr.ALREADY_EXISTS;case Xo.PERMISSION_DENIED:return kr.PERMISSION_DENIED;case Xo.FAILED_PRECONDITION:return kr.FAILED_PRECONDITION;case Xo.ABORTED:return kr.ABORTED;case Xo.OUT_OF_RANGE:return kr.OUT_OF_RANGE;case Xo.UNIMPLEMENTED:return kr.UNIMPLEMENTED;case Xo.DATA_LOSS:return kr.DATA_LOSS;default:return Ir()}}(Wo=Xo||(Xo={}))[Wo.OK=0]="OK",Wo[Wo.CANCELLED=1]="CANCELLED",Wo[Wo.UNKNOWN=2]="UNKNOWN",Wo[Wo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Wo[Wo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Wo[Wo.NOT_FOUND=5]="NOT_FOUND",Wo[Wo.ALREADY_EXISTS=6]="ALREADY_EXISTS",Wo[Wo.PERMISSION_DENIED=7]="PERMISSION_DENIED",Wo[Wo.UNAUTHENTICATED=16]="UNAUTHENTICATED",Wo[Wo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Wo[Wo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Wo[Wo.ABORTED=10]="ABORTED",Wo[Wo.OUT_OF_RANGE=11]="OUT_OF_RANGE",Wo[Wo.UNIMPLEMENTED=12]="UNIMPLEMENTED",Wo[Wo.INTERNAL=13]="INTERNAL",Wo[Wo.UNAVAILABLE=14]="UNAVAILABLE",Wo[Wo.DATA_LOSS=15]="DATA_LOSS";var ns=function(){function t(t,e){this.J=t,this.root=e||is.EMPTY}return t.prototype.Ht=function(e,n){return new t(this.J,this.root.Ht(e,n,this.J).copy(null,null,is.Jt,null,null))},t.prototype.remove=function(e){return new t(this.J,this.root.remove(e,this.J).copy(null,null,is.Jt,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.nt=function(){return this.root.nt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Yt=function(){return this.root.Yt()},t.prototype.Xt=function(){return this.root.Xt()},t.prototype.Zt=function(t){return this.root.Zt(t)},t.prototype.forEach=function(t){this.Zt((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.Zt((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.te=function(t){return this.root.te(t)},t.prototype.ee=function(){return new rs(this.root,null,this.J,!1)},t.prototype.ne=function(t){return new rs(this.root,t,this.J,!1)},t.prototype.se=function(){return new rs(this.root,null,this.J,!0)},t.prototype.ie=function(t){return new rs(this.root,t,this.J,!0)},t}(),rs=function(){function t(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}return t.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},t.prototype.ae=function(){return this.oe.length>0},t.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},t}(),is=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.nt=function(){return!1},t.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},t.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},t.prototype.min=function(){return this.left.nt()?this:this.left.min()},t.prototype.Yt=function(){return this.min().key},t.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},t.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},t.prototype.le=function(){if(this.left.nt())return t.EMPTY;var e=this;return e.left._e()||e.left.left._e()||(e=e.fe()),(e=e.copy(null,null,null,e.left.le(),null)).he()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.nt()||i.left._e()||i.left.left._e()||(i=i.fe()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left._e()&&(i=i.de()),i.right.nt()||i.right._e()||i.right.left._e()||(i=i.we()),0===n(e,i.key)){if(i.right.nt())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.le())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.he()},t.prototype._e=function(){return this.color},t.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Ee()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Te()),t},t.prototype.fe=function(){var t=this.Te();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Ee()).Te()),t},t.prototype.we=function(){var t=this.Te();return t.left.left._e()&&(t=(t=t.de()).Te()),t},t.prototype.Ee=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.de=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Te=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},t.prototype.me=function(){if(this._e()&&this.left._e())throw Ir();if(this.right._e())throw Ir();var t=this.left.me();if(t!==this.right.me())throw Ir();return t+(this._e()?0:1)},t}();is.EMPTY=null,is.RED=!0,is.Jt=!1,is.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Ir()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Ir()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Ir()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Ir()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Ir()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Ht=function(t,e,n){return new is(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.nt=function(){return!0},t.prototype.Zt=function(t){return!1},t.prototype.te=function(t){return!1},t.prototype.Yt=function(){return null},t.prototype.Xt=function(){return null},t.prototype._e=function(){return!1},t.prototype.Ie=function(){return!0},t.prototype.me=function(){return 0},t}());var os=function(){function t(t){this.J=t,this.data=new ns(this.J)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Yt()},t.prototype.last=function(){return this.data.Xt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Zt((function(e,n){return t(e),!1}))},t.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(this.J(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Re=function(t,e){var n;for(n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},t.prototype.Pe=function(t){var e=this.data.ne(t);return e.ae()?e.ce().key:null},t.prototype.ee=function(){return new ss(this.data.ee())},t.prototype.ne=function(t){return new ss(this.data.ne(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.nt=function(){return this.data.nt()},t.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.ee(),r=e.data.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(0!==this.J(i,o))return!1}return!0},t.prototype.rt=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.J);return n.data=e,n},t}(),ss=function(){function t(t){this.ge=t}return t.prototype.ce=function(){return this.ge.ce().key},t.prototype.ae=function(){return this.ge.ae()},t}(),us=new ns(Qr.J);function as(){return us}function cs(){return as()}var hs=new ns(Qr.J);function fs(){return hs}var ls=new ns(Qr.J);function ps(){return ls}var ds=new os(Qr.J);function vs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ds,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var ys=new os(Sr);function ms(){return ys}var gs=function(){function t(t){this.J=t?function(e,n){return t(e,n)||Qr.J(e.key,n.key)}:function(t,e){return Qr.J(t.key,e.key)},this.Ve=fs(),this.pe=new ns(this.J)}return t.be=function(e){return new t(e.J)},t.prototype.has=function(t){return null!=this.Ve.get(t)},t.prototype.get=function(t){return this.Ve.get(t)},t.prototype.first=function(){return this.pe.Yt()},t.prototype.last=function(){return this.pe.Xt()},t.prototype.nt=function(){return this.pe.nt()},t.prototype.indexOf=function(t){var e=this.Ve.get(t);return e?this.pe.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.pe.Zt((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.pe.ee(),r=e.pe.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.J=this.J,r.Ve=e,r.pe=n,r},t}(),ws=function(){function t(){this.ve=new ns(Qr.J)}return t.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);n?0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):Ir():this.ve=this.ve.Ht(e,t)},t.prototype.Se=function(){var t=[];return this.ve.Zt((function(e,n){t.push(n)})),t},t}(),bs=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=u}return t.Fe=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,gs.be(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&ho(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Is=function(){function t(t,e,n,r,i){this.Mt=t,this.Oe=e,this.ke=n,this.Me=r,this.Le=i}return t.$e=function(e,n){var r=new Map;return r.set(e,_s.Be(e,n)),new t(Kr.min(),r,ms(),as(),vs())},t}(),_s=function(){function t(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}return t.Be=function(e,n){return new t(Dr.h,n,vs(),vs(),vs())},t}(),Ts=function(t,e,n,r){this.We=t,this.removedTargetIds=e,this.key=n,this.je=r},Es=function(t,e){this.targetId=t,this.Ge=e},Ns=function(t,e,n,r){void 0===n&&(n=Dr.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Ss=function(){function t(){this.ze=0,this.He=Ds(),this.Je=Dr.h,this.Ye=!1,this.Xe=!0}return Object.defineProperty(t.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),t.prototype.en=function(t){t.o()>0&&(this.Xe=!0,this.Je=t)},t.prototype.nn=function(){var t=vs(),e=vs(),n=vs();return this.He.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Ir()}})),new _s(this.Je,this.Ye,t,e,n)},t.prototype.sn=function(){this.Xe=!1,this.He=Ds()},t.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},t.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},t.prototype.cn=function(){this.ze+=1},t.prototype.an=function(){this.ze-=1},t.prototype.un=function(){this.Xe=!0,this.Ye=!0},t}(),As=function(){function t(t){this.hn=t,this.ln=new Map,this._n=as(),this.fn=xs(),this.dn=new os(Sr)}return t.prototype.wn=function(t){for(var e=0,n=t.We;e<n.length;e++){var r=n[e];t.je instanceof ki?this.En(r,t.je):t.je instanceof Oi&&this.Tn(r,t.key,t.je)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Tn(r,t.key,t.je)},t.prototype.In=function(t){var e=this;this.mn(t,(function(n){var r=e.An(n);switch(t.state){case 0:e.Rn(n)&&r.en(t.resumeToken);break;case 1:r.an(),r.Ze||r.sn(),r.en(t.resumeToken);break;case 2:r.an(),r.Ze||e.removeTarget(n);break;case 3:e.Rn(n)&&(r.un(),r.en(t.resumeToken));break;case 4:e.Rn(n)&&(e.Pn(n),r.en(t.resumeToken));break;default:Ir()}}))},t.prototype.mn=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.ln.forEach((function(t,r){n.Rn(r)&&e(r)}))},t.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count,r=this.gn(e);if(r){var i=r.target;if(Vi(i))if(0===n){var o=new Qr(i.path);this.Tn(e,o,new Oi(o,Kr.min()))}else _r(1===n);else this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e))}},t.prototype.pn=function(t){var e=this,n=new Map;this.ln.forEach((function(r,i){var o=e.gn(i);if(o){if(r.qe&&Vi(o.target)){var s=new Qr(o.target.path);null!==e._n.get(s)||e.bn(i,s)||e.Tn(i,s,new Oi(s,t))}r.tn&&(n.set(i,r.nn()),r.sn())}}));var r=vs();this.fn.forEach((function(t,n){var i=!0;n.Re((function(t){var n=e.gn(t);return!n||2===n.kt||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Is(t,n,this.dn,this._n,r);return this._n=as(),this.fn=xs(),this.dn=new os(Sr),i},t.prototype.En=function(t,e){if(this.Rn(t)){var n=this.bn(t,e.key)?2:0;this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t))}},t.prototype.Tn=function(t,e,n){if(this.Rn(t)){var r=this.An(t);this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n))}},t.prototype.removeTarget=function(t){this.ln.delete(t)},t.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},t.prototype.cn=function(t){this.An(t).cn()},t.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new Ss,this.ln.set(t,e)),e},t.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new os(Sr),this.fn=this.fn.Ht(t,e)),e},t.prototype.Rn=function(t){var e=null!==this.gn(t);return e||mr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},t.prototype.Pn=function(t){var e=this;this.ln.set(t,new Ss),this.hn.Sn(t).forEach((function(n){e.Tn(t,n,null)}))},t.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},t}();function xs(){return new ns(Qr.J)}function Ds(){return new ns(Qr.J)}var ks={asc:"ASCENDING",desc:"DESCENDING"},Os={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Cs=function(t,e){this.T=t,this.qt=e};function Ps(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ls(t,e){return t.qt?e.toBase64():e.toUint8Array()}function Rs(t,e){return Ps(t,e.G())}function Ms(t){return _r(!!t),Kr.W(function(t){var e=ii(t);return new Br(e.seconds,e.nanos)}(t))}function Vs(t,e){return function(t){return new Xr(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).ot()}function Us(t){var e=Xr.ct(t);return _r(au(e)),e}function Gs(t,e){return Vs(t.T,e.path)}function qs(t,e){var n=Us(e);if(n.get(1)!==t.T.projectId)throw new Or(kr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.T.projectId);if(n.get(3)!==t.T.database)throw new Or(kr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.T.database);return new Qr(zs(n))}function js(t,e){return Vs(t.T,e)}function Fs(t){var e=Us(t);return 4===e.length?Xr.at():zs(e)}function Js(t){return new Xr(["projects",t.T.projectId,"databases",t.T.database]).ot()}function zs(t){return _r(t.length>4&&"documents"===t.get(4)),t.X(5)}function Hs(t,e,n){return{name:Gs(t,e),fields:n.proto.mapValue.fields}}function Bs(t,e,n){var r=qs(t,e.name),i=Ms(e.updateTime),o=new Si({mapValue:{fields:e.fields}});return new ki(r,i,o,{hasCommittedMutations:!!n})}function Ks(t,e){var n;if(e instanceof Jo)n={update:Hs(t,e.key,e.value)};else if(e instanceof Yo)n={delete:Gs(t,e.key)};else if(e instanceof zo)n={update:Hs(t,e.key,e.data),updateMask:uu(e.zt)};else{if(!(e instanceof Qo))return Ir();n={verify:Gs(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof No)return{fieldPath:e.field.ot(),setToServerValue:"REQUEST_TIME"};if(n instanceof So)return{fieldPath:e.field.ot(),appendMissingElements:{values:n.elements}};if(n instanceof xo)return{fieldPath:e.field.ot(),removeAllFromArray:{values:n.elements}};if(n instanceof ko)return{fieldPath:e.field.ot(),increment:n.Qt};throw Ir()}(0,t)}))),e.Gt.jt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Rs(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Ir()}(t,e.Gt)),n}function Zs(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Ro.updateTime(Ms(t.updateTime)):void 0!==t.exists?Ro.exists(t.exists):Ro.Wt()}(e.currentDocument):Ro.Wt(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)_r("REQUEST_TIME"===e.setToServerValue),n=new No;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new So(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new xo(i)}else"increment"in e?n=new ko(t,e.increment):Ir();var o=Yr._t(e.fieldPath);return new Po(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=qs(t,e.update.name),o=new Si({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new ni(e.map((function(t){return Yr._t(t)})))}(e.updateMask);return new zo(i,o,s,n,r)}return new Jo(i,o,n,r)}if(e.delete){var u=qs(t,e.delete);return new Yo(u,n)}if(e.verify){var a=qs(t,e.verify);return new Qo(a,n)}return Ir()}function Xs(t,e){return{documents:[js(t,e.path)]}}function Ws(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=js(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=js(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(Ei(t.value))return{unaryFilter:{field:ru(t.field),op:"IS_NAN"}};if(Ti(t.value))return{unaryFilter:{field:ru(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ei(t.value))return{unaryFilter:{field:ru(t.field),op:"IS_NOT_NAN"}};if(Ti(t.value))return{unaryFilter:{field:ru(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ru(t.field),op:nu(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:ru(t.field),direction:eu(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.qt||hi(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=$s(e.startAt)),e.endAt&&(n.structuredQuery.endAt=$s(e.endAt)),n}function Ys(t){var e=Fs(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){_r(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Qs(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(t){return function(t){return new Xi(iu(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var a=null;n.limit&&(a=function(t){var e;return hi(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=tu(n.startAt));var h=null;return n.endAt&&(h=tu(n.endAt)),to(e,i,u,s,a,"F",c,h)}function Qs(t){return t?void 0!==t.unaryFilter?[su(t)]:void 0!==t.fieldFilter?[ou(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Qs(t)})).reduce((function(t,e){return t.concat(e)})):Ir():[]}function $s(t){return{before:t.before,values:t.position}}function tu(t){var e=!!t.before,n=t.values||[];return new Ki(n,e)}function eu(t){return ks[t]}function nu(t){return Os[t]}function ru(t){return{fieldPath:t.ot()}}function iu(t){return Yr._t(t.fieldPath)}function ou(t){return Ui.create(iu(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Ir()}}(t.fieldFilter.op),t.fieldFilter.value)}function su(t){switch(t.unaryFilter.op){case"IS_NAN":var e=iu(t.unaryFilter.field);return Ui.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=iu(t.unaryFilter.field);return Ui.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=iu(t.unaryFilter.field);return Ui.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=iu(t.unaryFilter.field);return Ui.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Ir()}}function uu(t){var e=[];return t.fields.forEach((function(t){return e.push(t.ot())})),{fieldPaths:e}}function au(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var cu=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},hu=function(){function t(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.Fn=!1,t((function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)}),(function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Fn&&Ir(),this.Fn=!0,this.Nn?this.error?this.On(n,this.error):this.kn(e,this.result):new t((function(t,i){r.Cn=function(n){r.kn(e,n).next(t,i)},r.xn=function(e){r.On(n,e).next(t,i)}}))},t.prototype.Mn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.Ln=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.kn=function(e,n){return e?this.Ln((function(){return e(n)})):t.resolve(n)},t.prototype.On=function(e,n){return e?this.Ln((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.$n=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.Bn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.$n(r)},t}(),fu=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.qn=new cu,this.transaction.oncomplete=function(){n.qn.resolve()},this.transaction.onabort=function(){e.error?n.qn.reject(new du(t,e.error)):n.qn.resolve()},this.transaction.onerror=function(e){var r=wu(e.target.error);n.qn.reject(new du(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new du(n,e)}},Object.defineProperty(t.prototype,"Un",{get:function(){return this.qn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.qn.reject(t),this.aborted||(mr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new yu(e)},t}(),lu=function(){function t(e,n,r){this.name=e,this.version=n,this.Qn=r,12.2===t.Kn((0,o.z$)())&&gr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return mr("SimpleDb","Removing database:",t),mu(window.indexedDB.deleteDatabase(t)).Mn()},t.Wn=function(){if("undefined"==typeof indexedDB)return!1;if(t.jn())return!0;var e=(0,o.z$)(),n=t.Kn(e),r=0<n&&n<10,i=t.Gn(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)},t.jn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.zn)},t.Hn=function(t,e){return t.store(e)},t.Kn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Gn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Jn=function(t){return(0,dr.mG)(this,void 0,void 0,(function(){var e,n=this;return(0,dr.Jh)(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(mr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new du(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new Or(kr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new du(t,n))},i.onupgradeneeded=function(t){mr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.Qn.Yn(e,i.transaction,t.oldVersion,n.version).next((function(){mr("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Xn&&(this.db.onversionchange=function(t){return n.Xn(t)}),this.db)]}}))}))},t.prototype.Zn=function(t){this.Xn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return(0,dr.mG)(this,void 0,void 0,(function(){var i,o,s,u,a;return(0,dr.Jh)(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,a,c,h;return(0,dr.Jh)(this,(function(f){switch(f.label){case 0:++o,f.label=1;case 1:return f.trys.push([1,4,,5]),[4,u.Jn(t)];case 2:return u.db=f.sent(),e=fu.open(u.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),hu.reject(t)})).Mn(),a={},s.catch((function(){})),[4,e.Un];case 3:return[2,(a.value=(f.sent(),s),a)];case 4:return c=f.sent(),h="FirebaseError"!==c.name&&o<3,mr("SimpleDb","Transaction failed with error:",c.message,"Retrying:",h),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},u=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),pu=function(){function t(t){this.ts=t,this.es=!1,this.ns=null}return Object.defineProperty(t.prototype,"Nn",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ss",{get:function(){return this.ns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ts=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.es=!0},t.prototype.rs=function(t){this.ns=t},t.prototype.delete=function(){return mu(this.ts.delete())},t}(),du=function(t){function e(e,n){var r=this;return(r=t.call(this,kr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return(0,dr.ZT)(e,t),e}(Or);function vu(t){return"IndexedDbTransactionError"===t.name}var yu=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(mr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(mr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),mu(n)},t.prototype.add=function(t){return mr("SimpleDb","ADD",this.store.name,t,t),mu(this.store.add(t))},t.prototype.get=function(t){var e=this;return mu(this.store.get(t)).next((function(n){return void 0===n&&(n=null),mr("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return mr("SimpleDb","DELETE",this.store.name,t),mu(this.store.delete(t))},t.prototype.count=function(){return mr("SimpleDb","COUNT",this.store.name),mu(this.store.count())},t.prototype.os=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.cs(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.us=function(t,e){mr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.hs=!1;var r=this.cursor(n);return this.cs(r,(function(t,e,n){return n.delete()}))},t.prototype.ls=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.cs(r,e)},t.prototype._s=function(t){var e=this.cursor({});return new hu((function(n,r){e.onerror=function(t){var e=wu(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.cs=function(t,e){var n=[];return new hu((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new pu(i),s=e(i.primaryKey,i.value,o);if(s instanceof hu){var u=s.catch((function(t){return o.done(),hu.reject(t)}));n.push(u)}o.Nn?r():null===o.ss?i.continue():i.continue(o.ss)}else r()}})).next((function(){return hu.$n(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.hs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function mu(t){return new hu((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=wu(t.target.error);n(e)}}))}var gu=!1;function wu(t){var e=lu.Kn((0,o.z$)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Or("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return gu||(gu=!0,setTimeout((function(){throw r}),0)),r}}return t}var bu=function(){function t(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Es=i,this.Ts=new cu,this.then=this.Ts.promise.then.bind(this.Ts.promise),this.Ts.promise.catch((function(t){}))}return t.Is=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.As=setTimeout((function(){return e.Rs()}),t)},t.prototype.Ps=function(){return this.Rs()},t.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Ts.reject(new Or(kr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Rs=function(){var t=this;this.fs.ys((function(){return null!==t.As?(t.clearTimeout(),t.op().then((function(e){return t.Ts.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.As&&(this.Es(this),clearTimeout(this.As),this.As=null)},t}();function Iu(t,e){if(gr("AsyncQueue",e+": "+t),vu(t))return new Or(kr.UNAVAILABLE,e+": "+t);throw t}var _u=function(t,e){this.progress=t,this.gs=e},Tu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Eu=function(){function t(){this.Vs=[]}return t.prototype.ps=function(t){this.Vs.push(t)},t.prototype.bs=function(){this.Vs.forEach((function(t){return t()}))},t}();function Nu(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Au(e)),e=Su(t.get(n),e);return Au(e)}function Su(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Au(t){return t+""}function xu(t){var e=t.length;if(_r(e>=2),2===e)return _r(""===t.charAt(0)&&""===t.charAt(1)),Xr.at();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&Ir(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Ir()}o=s+2}return new Xr(r)}var Du=function(t,e){this.seconds=t,this.nanoseconds=e},ku=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};ku.store="owner",ku.key="owner";var Ou=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ou.store="mutationQueues",Ou.keyPath="userId";var Cu=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Cu.store="mutations",Cu.keyPath="batchId",Cu.userMutationsIndex="userMutationsIndex",Cu.userMutationsKeyPath=["userId","batchId"];var Pu=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Nu(e)]},t.key=function(t,e,n){return[t,Nu(e),n]},t}();Pu.store="documentMutations",Pu.PLACEHOLDER=new Pu;var Lu=function(t,e){this.path=t,this.readTime=e},Ru=function(t,e){this.path=t,this.version=e},Mu=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Mu.store="remoteDocuments",Mu.readTimeIndex="readTimeIndex",Mu.readTimeIndexPath="readTime",Mu.collectionReadTimeIndex="collectionReadTimeIndex",Mu.collectionReadTimeIndexPath=["parentPath","readTime"];var Vu=function(t){this.byteSize=t};Vu.store="remoteDocumentGlobal",Vu.key="remoteDocumentGlobalKey";var Uu=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Uu.store="targets",Uu.keyPath="targetId",Uu.queryTargetsIndexName="queryTargetsIndex",Uu.queryTargetsKeyPath=["canonicalId","targetId"];var Gu=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Gu.store="targetDocuments",Gu.keyPath=["targetId","path"],Gu.documentTargetsIndex="documentTargetsIndex",Gu.documentTargetsKeyPath=["path","targetId"];var qu=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};qu.key="targetGlobalKey",qu.store="targetGlobal";var ju=function(t,e){this.collectionId=t,this.parent=e};ju.store="collectionParents",ju.keyPath=["collectionId","parent"];var Fu=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Fu.store="clientMetadata",Fu.keyPath="clientId";var Ju=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Ju.store="bundles",Ju.keyPath="bundleId";var zu=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};zu.store="namedQueries",zu.keyPath="name";var Hu=(0,dr.pr)((0,dr.pr)((0,dr.pr)((0,dr.pr)([Ou.store,Cu.store,Pu.store,Mu.store,Uu.store,ku.store,qu.store,Gu.store],[Fu.store]),[Vu.store]),[ju.store]),[Ju.store,zu.store]),Bu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).vs=e,r.Ss=n,r}return(0,dr.ZT)(e,t),e}(Eu);function Ku(t,e){var n=Tr(t);return lu.Hn(n.vs,e)}var Zu=function(){function t(t,e,n,r){this.batchId=t,this.Ds=e,this.baseMutations=n,this.mutations=r}return t.prototype.Cs=function(t,e,n){for(var r=n.xs,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Uo(o,e,r[i]))}return e},t.prototype.Ns=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Go(i,e,e,this.Ds))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Go(a,e,o,this.Ds))}return e},t.prototype.Fs=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.Ns(r.key,t.get(r.key));i&&(n=n.Ht(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),vs())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ar(this.mutations,t.mutations,(function(t,e){return jo(t,e)}))&&Ar(this.baseMutations,t.baseMutations,(function(t,e){return jo(t,e)}))},t}(),Xu=function(){function t(t,e,n,r){this.batch=t,this.Os=e,this.xs=n,this.ks=r}return t.from=function(e,n,r){_r(e.mutations.length===r.length);for(var i=ps(),o=e.mutations,s=0;s<o.length;s++)i=i.Ht(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Wu=function(t){this.Ms=t};function Yu(t,e){if(e.document)return Bs(t.Ms,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Qr.Tt(e.noDocument.path),r=na(e.noDocument.readTime);return new Oi(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=Qr.Tt(e.unknownDocument.path);return r=na(e.unknownDocument.version),new Ci(i,r)}return Ir()}function Qu(t,e,n){var r=$u(n),i=e.key.path.Z().rt();if(e instanceof ki){var o=function(t,e){return{name:Gs(t,e.key),fields:e.vt().mapValue.fields,updateTime:Ps(t,e.version.G())}}(t.Ms,e),s=e.hasCommittedMutations;return new Mu(null,null,o,s,r,i)}if(e instanceof Oi){var u=e.key.path.rt(),a=ea(e.version);return s=e.hasCommittedMutations,new Mu(null,new Lu(u,a),null,s,r,i)}if(e instanceof Ci){var c=e.key.path.rt(),h=ea(e.version);return new Mu(new Ru(c,h),null,null,!0,r,i)}return Ir()}function $u(t){var e=t.G();return[e.seconds,e.nanoseconds]}function ta(t){var e=new Br(t[0],t[1]);return Kr.W(e)}function ea(t){var e=t.G();return new Du(e.seconds,e.nanoseconds)}function na(t){var e=new Br(t.seconds,t.nanoseconds);return Kr.W(e)}function ra(t,e){for(var n=(e.baseMutations||[]).map((function(e){return Zs(t.Ms,e)})),r=e.mutations.length-1;r>=0;--r){var i=e.mutations[r];void 0!==(null==i?void 0:i.transform)&&(e.mutations[r-1].updateTransforms=i.transform.fieldTransforms,e.mutations.splice(r,1),--r)}var o=e.mutations.map((function(e){return Zs(t.Ms,e)})),s=Br.fromMillis(e.localWriteTimeMs);return new Zu(e.batchId,s,n,o)}function ia(t){var e,n,r=na(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?na(t.lastLimboFreeSnapshotVersion):Kr.min();return void 0!==t.query.documents?(_r(1===(n=t.query).documents.length),e=ao(eo(Fs(n.documents[0])))):e=function(t){return ao(Ys(t))}(t.query),new mo(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Dr.fromBase64String(t.resumeToken))}function oa(t,e){var n,r=ea(e.Mt),i=ea(e.lastLimboFreeSnapshotVersion);n=Vi(e.target)?Xs(t.Ms,e.target):Ws(t.Ms,e.target);var o=e.resumeToken.toBase64();return new Uu(e.targetId,Ri(e.target),r,o,e.sequenceNumber,i,n)}function sa(t){var e=Ys({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?co(e,e.limit,"L"):e}var ua=function(){function t(){}return t.prototype.Ls=function(t,e){return aa(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:na(e.createTime),version:e.version};var e}))},t.prototype.$s=function(t,e){return aa(t).put({bundleId:(n=e).id,createTime:ea(Ms(n.createTime)),version:n.version});var n},t.prototype.Bs=function(t,e){return ca(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:sa(e.bundledQuery),readTime:na(e.readTime)};var e}))},t.prototype.qs=function(t,e){return ca(t).put(function(t){return{name:t.name,readTime:ea(Ms(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function aa(t){return Ku(t,Ju.store)}function ca(t){return Ku(t,zu.store)}var ha=function(){function t(){this.Us=new fa}return t.prototype.Qs=function(t,e){return this.Us.add(e),hu.resolve()},t.prototype.Ks=function(t,e){return hu.resolve(this.Us.getEntries(e))},t}(),fa=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new os(Xr.J),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.et(),n=t.Z(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new os(Xr.J)).rt()},t}(),la=function(){function t(){this.Ws=new fa}return t.prototype.Qs=function(t,e){var n=this;if(!this.Ws.has(e)){var r=e.et(),i=e.Z();t.ps((function(){n.Ws.add(e)}));var o={collectionId:r,parent:Nu(i)};return pa(t).put(o)}return hu.resolve()},t.prototype.Ks=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[xr(e),""],!1,!0);return pa(t).os(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(xu(o.parent))}return n}))},t}();function pa(t){return Ku(t,ju.store)}var da={js:!1,Gs:0,zs:0,Hs:0},va=function(){function t(t,e,n){this.Js=t,this.Ys=e,this.Xs=n}return t.Zs=function(e){return new t(e,t.ti,t.ei)},t}();function ya(t){return(0,dr.mG)(this,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(e){if(t.code!==kr.FAILED_PRECONDITION||t.message!==Tu)throw t;return mr("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}va.ti=10,va.ei=1e3,va.ni=new va(41943040,va.ti,va.ei),va.si=new va(-1,0,0);var ma=function(){function t(t,e){this.ii=t,this.ri=e,this.oi={}}return t.prototype.get=function(t){var e=this.ii(t),n=this.oi[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.ri(s,t))return u}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.ii(t),r=this.oi[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ri(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.oi[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.ii(t),n=this.oi[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ri(n[r][0],t))return 1===n.length?delete this.oi[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){ti(this.oi,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];t(s,u)}}))},t.prototype.nt=function(){return ei(this.oi)},t}(),ga=function(){function t(){this.ci=new ma((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.ai=!1}return t.prototype.ui=function(t){var e=this.ci.get(t);return e?e.readTime:Kr.min()},t.prototype.hi=function(t,e){this.li(),this.ci.set(t.key,{_i:t,readTime:e})},t.prototype.fi=function(t,e){void 0===e&&(e=null),this.li(),this.ci.set(t,{_i:null,readTime:e})},t.prototype.di=function(t,e){this.li();var n=this.ci.get(e);return void 0!==n?hu.resolve(n._i):this.wi(t,e)},t.prototype.getEntries=function(t,e){return this.Ei(t,e)},t.prototype.apply=function(t){return this.li(),this.ai=!0,this.Ti(t)},t.prototype.li=function(){},t}();function wa(t,e,n){var r=t.store(Cu.store),i=t.store(Pu.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.ls({range:s},(function(t,e,n){return u++,n.delete()}));o.push(a.next((function(){_r(1===u)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Pu.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return hu.$n(o).next((function(){return c}))}function ba(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ir();e=t.noDocument}return JSON.stringify(e).length}var Ia=function(){function t(t,e,n,r){this.userId=t,this.Kt=e,this.Ii=n,this.mi=r,this.Ai={}}return t.Ri=function(e,n,r,i){return _r(""!==e.uid),new t(e.A()?e.uid:"",n,r,i)},t.prototype.Pi=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ta(t).ls({index:Cu.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.yi=function(t,e,n,r){var i=this,o=Ea(t),s=Ta(t);return s.add({}).next((function(u){_r("number"==typeof u);for(var a=new Zu(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Ks(t.Ms,e)})),i=n.mutations.map((function(e){return Ks(t.Ms,e)}));return new Cu(e,n.batchId,n.Ds.toMillis(),r,i)}(i.Kt,i.userId,a),h=[],f=new os((function(t,e){return Sr(t.ot(),e.ot())})),l=0,p=r;l<p.length;l++){var d=p[l],v=Pu.key(i.userId,d.key.path,u);f=f.add(d.key.path.Z()),h.push(s.put(c)),h.push(o.put(v,Pu.PLACEHOLDER))}return f.forEach((function(e){h.push(i.Ii.Qs(t,e))})),t.ps((function(){i.Ai[u]=a.keys()})),hu.$n(h).next((function(){return a}))}))},t.prototype.gi=function(t,e){var n=this;return Ta(t).get(e).next((function(t){return t?(_r(t.userId===n.userId),ra(n.Kt,t)):null}))},t.prototype.Vi=function(t,e){var n=this;return this.Ai[e]?hu.resolve(this.Ai[e]):this.gi(t,e).next((function(t){if(t){var r=t.keys();return n.Ai[e]=r,r}return null}))},t.prototype.pi=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ta(t).ls({index:Cu.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(_r(e.batchId>=r),o=ra(n.Kt,e)),i.done()})).next((function(){return o}))},t.prototype.bi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Ta(t).ls({index:Cu.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.vi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ta(t).os(Cu.userMutationsIndex,n).next((function(t){return t.map((function(t){return ra(e.Kt,t)}))}))},t.prototype.Si=function(t,e){var n=this,r=Pu.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Ea(t).ls({range:i},(function(r,i,s){var u=r[0],a=r[1],c=r[2],h=xu(a);if(u===n.userId&&e.path.isEqual(h))return Ta(t).get(c).next((function(t){if(!t)throw Ir();_r(t.userId===n.userId),o.push(ra(n.Kt,t))}));s.done()})).next((function(){return o}))},t.prototype.Di=function(t,e){var n=this,r=new os(Sr),i=[];return e.forEach((function(e){var o=Pu.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=Ea(t).ls({range:s},(function(t,i,o){var s=t[0],u=t[1],a=t[2],c=xu(u);s===n.userId&&e.path.isEqual(c)?r=r.add(a):o.done()}));i.push(u)})),hu.$n(i).next((function(){return n.Ci(t,r)}))},t.prototype.xi=function(t,e){var n=this,r=e.path,i=r.length+1,o=Pu.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new os(Sr);return Ea(t).ls({range:s},(function(t,e,o){var s=t[0],a=t[1],c=t[2],h=xu(a);s===n.userId&&r.st(h)?h.length===i&&(u=u.add(c)):o.done()})).next((function(){return n.Ci(t,u)}))},t.prototype.Ci=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Ta(t).get(e).next((function(t){if(null===t)throw Ir();_r(t.userId===n.userId),r.push(ra(n.Kt,t))})))})),hu.$n(i).next((function(){return r}))},t.prototype.Ni=function(t,e){var n=this;return wa(t.vs,this.userId,e).next((function(r){return t.ps((function(){n.Fi(e.batchId)})),hu.forEach(r,(function(e){return n.mi.Oi(t,e)}))}))},t.prototype.Fi=function(t){delete this.Ai[t]},t.prototype.ki=function(t){var e=this;return this.Pi(t).next((function(n){if(!n)return hu.resolve();var r=IDBKeyRange.lowerBound(Pu.prefixForUser(e.userId)),i=[];return Ea(t).ls({range:r},(function(t,n,r){if(t[0]===e.userId){var o=xu(t[1]);i.push(o)}else r.done()})).next((function(){_r(0===i.length)}))}))},t.prototype.Mi=function(t,e){return _a(t,this.userId,e)},t.prototype.Li=function(t){var e=this;return Na(t).get(this.userId).next((function(t){return t||new Ou(e.userId,-1,"")}))},t}();function _a(t,e,n){var r=Pu.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Ea(t).ls({range:o,hs:!0},(function(t,n,r){var o=t[0],u=t[1];t[2],o===e&&u===i&&(s=!0),r.done()})).next((function(){return s}))}function Ta(t){return Ku(t,Cu.store)}function Ea(t){return Ku(t,Pu.store)}function Na(t){return Ku(t,Ou.store)}var Sa=function(){function t(t){this.$i=t}return t.prototype.next=function(){return this.$i+=2,this.$i},t.Bi=function(){return new t(0)},t.qi=function(){return new t(-1)},t}(),Aa=function(){function t(t,e){this.mi=t,this.Kt=e}return t.prototype.Ui=function(t){var e=this;return this.Qi(t).next((function(n){var r=new Sa(n.highestTargetId);return n.highestTargetId=r.next(),e.Ki(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Wi=function(t){return this.Qi(t).next((function(t){return Kr.W(new Br(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.ji=function(t){return this.Qi(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.Gi=function(t,e,n){var r=this;return this.Qi(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.G()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ki(t,i)}))},t.prototype.zi=function(t,e){var n=this;return this.Hi(t,e).next((function(){return n.Qi(t).next((function(r){return r.targetCount+=1,n.Ji(e,r),n.Ki(t,r)}))}))},t.prototype.Yi=function(t,e){return this.Hi(t,e)},t.prototype.Xi=function(t,e){var n=this;return this.Zi(t,e.targetId).next((function(){return xa(t).delete(e.targetId)})).next((function(){return n.Qi(t)})).next((function(e){return _r(e.targetCount>0),e.targetCount-=1,n.Ki(t,e)}))},t.prototype.tr=function(t,e,n){var r=this,i=0,o=[];return xa(t).ls((function(s,u){var a=ia(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Xi(t,a)))})).next((function(){return hu.$n(o)})).next((function(){return i}))},t.prototype.mn=function(t,e){return xa(t).ls((function(t,n){var r=ia(n);e(r)}))},t.prototype.Qi=function(t){return Da(t).get(qu.key).next((function(t){return _r(null!==t),t}))},t.prototype.Ki=function(t,e){return Da(t).put(qu.key,e)},t.prototype.Hi=function(t,e){return xa(t).put(oa(this.Kt,e))},t.prototype.Ji=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.er=function(t){return this.Qi(t).next((function(t){return t.targetCount}))},t.prototype.nr=function(t,e){var n=Ri(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return xa(t).ls({range:r,index:Uu.queryTargetsIndexName},(function(t,n,r){var o=ia(n);Mi(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.sr=function(t,e,n){var r=this,i=[],o=ka(t);return e.forEach((function(e){var s=Nu(e.path);i.push(o.put(new Gu(n,s))),i.push(r.mi.ir(t,n,e))})),hu.$n(i)},t.prototype.rr=function(t,e,n){var r=this,i=ka(t);return hu.forEach(e,(function(e){var o=Nu(e.path);return hu.$n([i.delete([n,o]),r.mi.cr(t,n,e)])}))},t.prototype.Zi=function(t,e){var n=ka(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.ar=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=ka(t),i=vs();return r.ls({range:n,hs:!0},(function(t,e,n){var r=xu(t[1]),o=new Qr(r);i=i.add(o)})).next((function(){return i}))},t.prototype.Mi=function(t,e){var n=Nu(e.path),r=IDBKeyRange.bound([n],[xr(n)],!1,!0),i=0;return ka(t).ls({index:Gu.documentTargetsIndex,hs:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Dn=function(t,e){return xa(t).get(e).next((function(t){return t?ia(t):null}))},t}();function xa(t){return Ku(t,Uu.store)}function Da(t){return Ku(t,qu.store)}function ka(t){return Ku(t,Gu.store)}function Oa(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Sr(n,i);return 0===s?Sr(r,o):s}var Ca=function(){function t(t){this.ur=t,this.buffer=new os(Oa),this.hr=0}return t.prototype.lr=function(){return++this.hr},t.prototype._r=function(t){var e=[t,this.lr()];if(this.buffer.size<this.ur)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Oa(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Pa=function(){function t(t,e){this.dr=t,this.fs=e,this.wr=!1,this.Er=null}return t.prototype.start=function(t){-1!==this.dr.params.Js&&this.Tr(t)},t.prototype.stop=function(){this.Er&&(this.Er.cancel(),this.Er=null)},Object.defineProperty(t.prototype,"Ir",{get:function(){return null!==this.Er},enumerable:!1,configurable:!0}),t.prototype.Tr=function(t){var e=this,n=this.wr?3e5:6e4;mr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.Er=this.fs.mr("lru_garbage_collection",n,(function(){return(0,dr.mG)(e,void 0,void 0,(function(){var e;return(0,dr.Jh)(this,(function(n){switch(n.label){case 0:this.Er=null,this.wr=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Ar(this.dr)];case 2:return n.sent(),[3,7];case 3:return vu(e=n.sent())?(mr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,ya(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Tr(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),La=function(){function t(t,e){this.Rr=t,this.params=e}return t.prototype.Pr=function(t,e){return this.Rr.yr(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.gr=function(t,e){var n=this;if(0===e)return hu.resolve(Hr.U);var r=new Ca(e);return this.Rr.mn(t,(function(t){return r._r(t.sequenceNumber)})).next((function(){return n.Rr.Vr(t,(function(t){return r._r(t)}))})).next((function(){return r.maxValue}))},t.prototype.tr=function(t,e,n){return this.Rr.tr(t,e,n)},t.prototype.pr=function(t,e){return this.Rr.pr(t,e)},t.prototype.br=function(t,e){var n=this;return-1===this.params.Js?(mr("LruGarbageCollector","Garbage collection skipped; disabled"),hu.resolve(da)):this.vr(t).next((function(r){return r<n.params.Js?(mr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Js),da):n.Sr(t,e)}))},t.prototype.vr=function(t){return this.Rr.vr(t)},t.prototype.Sr=function(t,e){var n,r,o,s,u,a,c,h=this,f=Date.now();return this.Pr(t,this.params.Ys).next((function(e){return e>h.params.Xs?(mr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Xs+" from "+e),r=h.params.Xs):r=e,s=Date.now(),h.gr(t,r)})).next((function(r){return n=r,u=Date.now(),h.tr(t,n,e)})).next((function(e){return o=e,a=Date.now(),h.pr(t,n)})).next((function(t){return c=Date.now(),yr()<=i.in.DEBUG&&mr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+r+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),hu.resolve({js:!0,Gs:r,zs:o,Hs:t})}))},t}(),Ra=function(){function t(t,e){this.db=t,this.dr=function(t,e){return new La(t,e)}(this,e)}return t.prototype.yr=function(t){var e=this.Dr(t);return this.db.Cr().er(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.Dr=function(t){var e=0;return this.Vr(t,(function(t){e++})).next((function(){return e}))},t.prototype.mn=function(t,e){return this.db.Cr().mn(t,e)},t.prototype.Vr=function(t,e){return this.Nr(t,(function(t,n){return e(n)}))},t.prototype.ir=function(t,e,n){return Ma(t,n)},t.prototype.cr=function(t,e,n){return Ma(t,n)},t.prototype.tr=function(t,e,n){return this.db.Cr().tr(t,e,n)},t.prototype.Oi=function(t,e){return Ma(t,e)},t.prototype.Fr=function(t,e){return function(t,e){var n=!1;return Na(t)._s((function(r){return _a(t,r,e).next((function(t){return t&&(n=!0),hu.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.pr=function(t,e){var n=this,r=this.db.kr().Or(),i=[],o=0;return this.Nr(t,(function(s,u){if(u<=e){var a=n.Fr(t,s).next((function(e){if(!e)return o++,r.di(t,s).next((function(){return r.fi(s),ka(t).delete([0,Nu(s.path)])}))}));i.push(a)}})).next((function(){return hu.$n(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.Lt(t.Ss);return this.db.Cr().Yi(t,n)},t.prototype.Mr=function(t,e){return Ma(t,e)},t.prototype.Nr=function(t,e){var n,r=ka(t),i=Hr.U;return r.ls({index:Gu.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),u=r.sequenceNumber;0===o?(i!==Hr.U&&e(new Qr(xu(n)),i),i=u,n=s):i=Hr.U})).next((function(){i!==Hr.U&&e(new Qr(xu(n)),i)}))},t.prototype.vr=function(t){return this.db.kr().Lr(t)},t}();function Ma(t,e){return ka(t).put(function(t,e){return new Gu(0,Nu(t.path),e)}(e,t.Ss))}var Va=function(){function t(t,e){this.Kt=t,this.Ii=e}return t.prototype.hi=function(t,e,n){return qa(t).put(ja(e),n)},t.prototype.fi=function(t,e){var n=qa(t),r=ja(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.$r(t,r)}))},t.prototype.di=function(t,e){var n=this;return qa(t).get(ja(e)).next((function(t){return n.Br(t)}))},t.prototype.qr=function(t,e){var n=this;return qa(t).get(ja(e)).next((function(t){var e=n.Br(t);return e?{_i:e,size:ba(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=cs();return this.Ur(t,e,(function(t,e){var i=n.Br(e);r=r.Ht(t,i)})).next((function(){return r}))},t.prototype.Qr=function(t,e){var n=this,r=cs(),i=new ns(Qr.J);return this.Ur(t,e,(function(t,e){var o=n.Br(e);o?(r=r.Ht(t,o),i=i.Ht(t,ba(e))):(r=r.Ht(t,null),i=i.Ht(t,0))})).next((function(){return{Kr:r,Wr:i}}))},t.prototype.Ur=function(t,e,n){if(e.nt())return hu.resolve();var r=IDBKeyRange.bound(e.first().path.rt(),e.last().path.rt()),i=e.ee(),o=i.ce();return qa(t).ls({range:r},(function(t,e,r){for(var s=Qr.Tt(t);o&&Qr.J(o,s)<0;)n(o,null),o=i.ce();o&&o.isEqual(s)&&(n(o,e),o=i.ae()?i.ce():null),o?r.rs(o.path.rt()):r.done()})).next((function(){for(;o;)n(o,null),o=i.ae()?i.ce():null}))},t.prototype.jr=function(t,e,n){var r=this,i=fs(),o=e.path.length+1,s={};if(n.isEqual(Kr.min())){var u=e.path.rt();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.rt(),c=$u(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=Mu.collectionReadTimeIndex}return qa(t).ls(s,(function(t,n,s){if(t.length===o){var u=Yu(r.Kt,n);e.path.st(u.key.path)?u instanceof ki&&po(e,u)&&(i=i.Ht(u.key,u)):s.done()}})).next((function(){return i}))},t.prototype.Or=function(t){return new Ua(this,!!t&&t.Gr)},t.prototype.Lr=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Ga(t).get(Vu.key).next((function(t){return _r(!!t),t}))},t.prototype.$r=function(t,e){return Ga(t).put(Vu.key,e)},t.prototype.Br=function(t){if(t){var e=Yu(this.Kt,t);return e instanceof Oi&&e.version.isEqual(Kr.min())?null:e}return null},t}(),Ua=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).zr=e,r.Gr=n,r.Hr=new ma((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return(0,dr.ZT)(e,t),e.prototype.Ti=function(t){var e=this,n=[],r=0,i=new os((function(t,e){return Sr(t.ot(),e.ot())}));return this.ci.forEach((function(o,s){var u=e.Hr.get(o);if(s._i){var a=Qu(e.zr.Kt,s._i,e.ui(o));i=i.add(o.path.Z());var c=ba(a);r+=c-u,n.push(e.zr.hi(t,o,a))}else if(r-=u,e.Gr){var h=Qu(e.zr.Kt,new Oi(o,Kr.min()),e.ui(o));n.push(e.zr.hi(t,o,h))}else n.push(e.zr.fi(t,o))})),i.forEach((function(r){n.push(e.zr.Ii.Qs(t,r))})),n.push(this.zr.updateMetadata(t,r)),hu.$n(n)},e.prototype.wi=function(t,e){var n=this;return this.zr.qr(t,e).next((function(t){return null===t?(n.Hr.set(e,0),null):(n.Hr.set(e,t.size),t._i)}))},e.prototype.Ei=function(t,e){var n=this;return this.zr.Qr(t,e).next((function(t){var e=t.Kr;return t.Wr.forEach((function(t,e){n.Hr.set(t,e)})),e}))},e}(ga);function Ga(t){return Ku(t,Vu.store)}function qa(t){return Ku(t,Mu.store)}function ja(t){return t.path.rt()}var Fa=function(){function t(t){this.Kt=t}return t.prototype.Yn=function(t,e,n,r){var i=this;_r(n<r&&n>=0&&r<=11);var o=new fu("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(ku.store)}(t),function(t){t.createObjectStore(Ou.store,{keyPath:Ou.keyPath}),t.createObjectStore(Cu.store,{keyPath:Cu.keyPath,autoIncrement:!0}).createIndex(Cu.userMutationsIndex,Cu.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Pu.store)}(t),Ja(t),function(t){t.createObjectStore(Mu.store)}(t));var s=hu.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Gu.store),t.deleteObjectStore(Uu.store),t.deleteObjectStore(qu.store)}(t),Ja(t)),s=s.next((function(){return function(t){var e=t.store(qu.store),n=new qu(0,0,Kr.min().G(),0);return e.put(qu.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(Cu.store).os().next((function(n){t.deleteObjectStore(Cu.store),t.createObjectStore(Cu.store,{keyPath:Cu.keyPath,autoIncrement:!0}).createIndex(Cu.userMutationsIndex,Cu.userMutationsKeyPath,{unique:!0});var r=e.store(Cu.store),i=n.map((function(t){return r.put(t)}));return hu.$n(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Fu.store,{keyPath:Fu.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.Jr(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(Vu.store)}(t),i.Yr(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.Xr(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Zr(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Mu.store);e.createIndex(Mu.readTimeIndex,Mu.readTimeIndexPath,{unique:!1}),e.createIndex(Mu.collectionReadTimeIndex,Mu.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.eo(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(Ju.store,{keyPath:Ju.keyPath})}(t),function(t){t.createObjectStore(zu.store,{keyPath:zu.keyPath})}(t)}))),s},t.prototype.Yr=function(t){var e=0;return t.store(Mu.store).ls((function(t,n){e+=ba(n)})).next((function(){var n=new Vu(e);return t.store(Vu.store).put(Vu.key,n)}))},t.prototype.Jr=function(t){var e=this,n=t.store(Ou.store),r=t.store(Cu.store);return n.os().next((function(n){return hu.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.os(Cu.userMutationsIndex,i).next((function(r){return hu.forEach(r,(function(r){_r(r.userId===n.userId);var i=ra(e.Kt,r);return wa(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.Xr=function(t){var e=t.store(Gu.store),n=t.store(Mu.store);return t.store(qu.store).get(qu.key).next((function(t){var r=[];return n.ls((function(n,i){var o=new Xr(n),s=function(t){return[0,Nu(t)]}(o);r.push(e.get(s).next((function(n){return n?hu.resolve():function(n){return e.put(new Gu(0,Nu(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return hu.$n(r)}))}))},t.prototype.Zr=function(t,e){t.createObjectStore(ju.store,{keyPath:ju.keyPath});var n=e.store(ju.store),r=new fa,i=function(t){if(r.add(t)){var e=t.et(),i=t.Z();return n.put({collectionId:e,parent:Nu(i)})}};return e.store(Mu.store).ls({hs:!0},(function(t,e){var n=new Xr(t);return i(n.Z())})).next((function(){return e.store(Pu.store).ls({hs:!0},(function(t,e){t[0];var n=t[1],r=(t[2],xu(n));return i(r.Z())}))}))},t.prototype.eo=function(t){var e=this,n=t.store(Uu.store);return n.ls((function(t,r){var i=ia(r),o=oa(e.Kt,i);return n.put(o)}))},t}();function Ja(t){t.createObjectStore(Gu.store,{keyPath:Gu.keyPath}).createIndex(Gu.documentTargetsIndex,Gu.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Uu.store,{keyPath:Uu.keyPath}).createIndex(Uu.queryTargetsIndexName,Uu.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(qu.store)}var za="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ha=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.no=o,this.window=s,this.document=u,this.so=c,this.io=h,this.ro=null,this.oo=!1,this.isPrimary=!1,this.networkEnabled=!0,this.co=null,this.inForeground=!1,this.ao=null,this.uo=null,this.ho=Number.NEGATIVE_INFINITY,this.lo=function(t){return Promise.resolve()},!t.Wn())throw new Or(kr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.mi=new Ra(this,i),this._o=n+"main",this.Kt=new Wu(a),this.fo=new lu(this._o,11,new Fa(this.Kt)),this.wo=new Aa(this.mi,this.Kt),this.Ii=new la,this.Eo=function(t,e){return new Va(t,e)}(this.Kt,this.Ii),this.To=new ua,this.window&&this.window.localStorage?this.Io=this.window.localStorage:(this.Io=null,!1===h&&gr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.mo().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Or(kr.FAILED_PRECONDITION,za);return t.Ao(),t.Ro(),t.Po(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.wo.ji(e)}))})).then((function(e){t.ro=new Hr(e,t.so)})).then((function(){t.oo=!0})).catch((function(e){return t.fo&&t.fo.close(),Promise.reject(e)}))},t.prototype.yo=function(t){var e=this;return this.lo=function(n){return(0,dr.mG)(e,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(e){return this.Ir?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.Vo=function(t){var e=this;this.fo.Zn((function(n){return(0,dr.mG)(e,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.po=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.no.ys((function(){return(0,dr.mG)(e,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(t){switch(t.label){case 0:return this.Ir?[4,this.mo()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.mo=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Ka(e).put(new Fu(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.bo(e).next((function(e){e||(t.isPrimary=!1,t.no.vo((function(){return t.lo(!1)})))}))})).next((function(){return t.So(e)})).next((function(n){return t.isPrimary&&!n?t.Do(e).next((function(){return!1})):!!n&&t.Co(e).next((function(){return!0}))}))})).catch((function(e){if(vu(e))return mr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return mr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.no.vo((function(){return t.lo(e)})),t.isPrimary=e}))},t.prototype.bo=function(t){var e=this;return Ba(t).get(ku.key).next((function(t){return hu.resolve(e.xo(t))}))},t.prototype.No=function(t){return Ka(t).delete(this.clientId)},t.prototype.Fo=function(){return(0,dr.mG)(this,void 0,void 0,(function(){var t,e,n,r,i=this;return(0,dr.Jh)(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.Oo(this.ho,18e5)?[3,2]:(this.ho=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=Ku(t,Fu.store);return e.os().next((function(t){var n=i.ko(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return hu.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Io)for(e=0,n=t;e<n.length;e++)r=n[e],this.Io.removeItem(this.Mo(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.Po=function(){var t=this;this.uo=this.no.mr("client_metadata_refresh",4e3,(function(){return t.mo().then((function(){return t.Fo()})).then((function(){return t.Po()}))}))},t.prototype.xo=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.So=function(t){var e=this;return this.io?hu.resolve(!0):Ba(t).get(ku.key).next((function(n){if(null!==n&&e.Oo(n.leaseTimestampMs,5e3)&&!e.Lo(n.ownerId)){if(e.xo(n)&&e.networkEnabled)return!0;if(!e.xo(n)){if(!n.allowTabSynchronization)throw new Or(kr.FAILED_PRECONDITION,za);return!1}}return!(!e.networkEnabled||!e.inForeground)||Ka(t).os().next((function(t){return void 0===e.ko(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&mr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.$o=function(){return(0,dr.mG)(this,void 0,void 0,(function(){var t=this;return(0,dr.Jh)(this,(function(e){switch(e.label){case 0:return this.oo=!1,this.Bo(),this.uo&&(this.uo.cancel(),this.uo=null),this.qo(),this.Uo(),[4,this.fo.runTransaction("shutdown","readwrite",[ku.store,Fu.store],(function(e){var n=new Bu(e,Hr.U);return t.Do(n).next((function(){return t.No(n)}))}))];case 1:return e.sent(),this.fo.close(),this.Qo(),[2]}}))}))},t.prototype.ko=function(t,e){var n=this;return t.filter((function(t){return n.Oo(t.updateTimeMs,e)&&!n.Lo(t.clientId)}))},t.prototype.Ko=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Ka(e).os().next((function(e){return t.ko(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"Ir",{get:function(){return this.oo},enumerable:!1,configurable:!0}),t.prototype.Wo=function(t){return Ia.Ri(t,this.Kt,this.Ii,this.mi)},t.prototype.Cr=function(){return this.wo},t.prototype.kr=function(){return this.Eo},t.prototype.jo=function(){return this.Ii},t.prototype.Go=function(){return this.To},t.prototype.runTransaction=function(t,e,n){var r=this;mr("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.fo.runTransaction(t,o,Hu,(function(o){return i=new Bu(o,r.ro?r.ro.next():Hr.U),"readwrite-primary"===e?r.bo(i).next((function(t){return!!t||r.So(i)})).next((function(e){if(!e)throw gr("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.no.vo((function(){return r.lo(!1)})),new Or(kr.FAILED_PRECONDITION,Tu);return n(i)})).next((function(t){return r.Co(i).next((function(){return t}))})):r.zo(i).next((function(){return n(i)}))})).then((function(t){return i.bs(),t}))},t.prototype.zo=function(t){var e=this;return Ba(t).get(ku.key).next((function(t){if(null!==t&&e.Oo(t.leaseTimestampMs,5e3)&&!e.Lo(t.ownerId)&&!e.xo(t)&&!(e.io||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Or(kr.FAILED_PRECONDITION,za)}))},t.prototype.Co=function(t){var e=new ku(this.clientId,this.allowTabSynchronization,Date.now());return Ba(t).put(ku.key,e)},t.Wn=function(){return lu.Wn()},t.prototype.Do=function(t){var e=this,n=Ba(t);return n.get(ku.key).next((function(t){return e.xo(t)?(mr("IndexedDbPersistence","Releasing primary lease."),n.delete(ku.key)):hu.resolve()}))},t.prototype.Oo=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(gr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Ao=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ao=function(){t.no.ys((function(){return t.inForeground="visible"===t.document.visibilityState,t.mo()}))},this.document.addEventListener("visibilitychange",this.ao),this.inForeground="visible"===this.document.visibilityState)},t.prototype.qo=function(){this.ao&&(this.document.removeEventListener("visibilitychange",this.ao),this.ao=null)},t.prototype.Ro=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.co=function(){e.Bo(),e.no.ys((function(){return e.$o()}))},this.window.addEventListener("unload",this.co))},t.prototype.Uo=function(){this.co&&(this.window.removeEventListener("unload",this.co),this.co=null)},t.prototype.Lo=function(t){var e;try{var n=null!==(null===(e=this.Io)||void 0===e?void 0:e.getItem(this.Mo(t)));return mr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return gr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.Bo=function(){if(this.Io)try{this.Io.setItem(this.Mo(this.clientId),String(Date.now()))}catch(t){gr("Failed to set zombie client id.",t)}},t.prototype.Qo=function(){if(this.Io)try{this.Io.removeItem(this.Mo(this.clientId))}catch(t){}},t.prototype.Mo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Ba(t){return Ku(t,ku.store)}function Ka(t){return Ku(t,Fu.store)}function Za(t,e){var n=t.projectId;return t.m||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Xa=function(){function t(t,e,n){this.Eo=t,this.Ho=e,this.Ii=n}return t.prototype.Jo=function(t,e){var n=this;return this.Ho.Si(t,e).next((function(r){return n.Yo(t,e,r)}))},t.prototype.Yo=function(t,e,n){return this.Eo.di(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].Ns(e,t);return t}))},t.prototype.Xo=function(t,e,n){var r=cs();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].Ns(t,e);r=r.Ht(t,e)})),r},t.prototype.Zo=function(t,e){var n=this;return this.Eo.getEntries(t,e).next((function(e){return n.tc(t,e)}))},t.prototype.tc=function(t,e){var n=this;return this.Ho.Di(t,e).next((function(r){var i=n.Xo(t,e,r),o=as();return i.forEach((function(t,e){e||(e=new Oi(t,Kr.min())),o=o.Ht(t,e)})),o}))},t.prototype.jr=function(t,e,n){return function(t){return Qr.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.ec(t,e.path):so(e)?this.nc(t,e,n):this.sc(t,e,n)},t.prototype.ec=function(t,e){return this.Jo(t,new Qr(e)).next((function(t){var e=fs();return t instanceof ki&&(e=e.Ht(t.key,t)),e}))},t.prototype.nc=function(t,e,n){var r=this,i=e.collectionGroup,o=fs();return this.Ii.Ks(t,i).next((function(s){return hu.forEach(s,(function(s){var u=function(t,e){return new $i(e,null,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.sc(t,u,n).next((function(t){t.forEach((function(t,e){o=o.Ht(t,e)}))}))})).next((function(){return o}))}))},t.prototype.sc=function(t,e,n){var r,i,o=this;return this.Eo.jr(t,e,n).next((function(n){return r=n,o.Ho.xi(t,e)})).next((function(e){return i=e,o.ic(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=r.get(c),f=Go(a,h,h,o.Ds);r=f instanceof ki?r.Ht(c,f):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){po(e,n)||(r=r.remove(t))})),r}))},t.prototype.ic=function(t,e,n){for(var r=vs(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof zo&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Eo.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof ki&&(c=c.Ht(t,e))})),c}))},t}(),Wa=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}return t.cc=function(e,n){for(var r=vs(),i=vs(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Ya=function(){function t(){}return t.prototype.ac=function(t){this.uc=t},t.prototype.jr=function(t,e,n,r){var o=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Nt.length||1===t.Nt.length&&t.Nt[0].field.ht())}(e)||n.isEqual(Kr.min())?this.hc(t,e):this.uc.Zo(t,r).next((function(s){var u=o.lc(e,s);return(no(e)||ro(e))&&o._c(e.limitType,u,r,n)?o.hc(t,e):(yr()<=i.in.DEBUG&&mr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),lo(e)),o.uc.jr(t,e,n).next((function(t){return u.forEach((function(e){t=t.Ht(e.key,e)})),t})))}))},t.prototype.lc=function(t,e){var n=new os(vo(t));return e.forEach((function(e,r){r instanceof ki&&po(t,r)&&(n=n.add(r))})),n},t.prototype._c=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.u(r)>0)},t.prototype.hc=function(t,e){return yr()<=i.in.DEBUG&&mr("QueryEngine","Using full collection scan to execute query:",lo(e)),this.uc.jr(t,e,Kr.min())},t}(),Qa=function(){function t(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new ns(Sr),this.wc=new ma((function(t){return Ri(t)}),Mi),this.Ec=Kr.min(),this.Ho=t.Wo(n),this.Tc=t.kr(),this.wo=t.Cr(),this.Ic=new Xa(this.Tc,this.Ho,this.persistence.jo()),this.To=t.Go(),this.fc.ac(this.Ic)}return t.prototype.Ar=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.br(n,e.dc)}))},t}();function $a(t,e,n,r){return new Qa(t,e,n,r)}function tc(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r,i,o;return(0,dr.Jh)(this,(function(s){switch(s.label){case 0:return n=Tr(t),r=n.Ho,i=n.Ic,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n.Ho.vi(t).next((function(s){return o=s,r=n.persistence.Wo(e),i=new Xa(n.Tc,r,n.persistence.jo()),r.vi(t)})).next((function(e){for(var n=[],r=[],s=vs(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++){var l=f[h];s=s.add(l.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];r.push(v.batchId);for(var y=0,m=v.mutations;y<m.length;y++){var g=m[y];s=s.add(g.key)}}return i.Zo(t,s).next((function(t){return{mc:t,Ac:n,Rc:r}}))}))}))];case 1:return o=s.sent(),[2,(n.Ho=r,n.Ic=i,n.fc.ac(n.Ic),o)]}}))}))}function ec(t,e){var n=Tr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Tc.Or({Gr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=hu.resolve();return o.forEach((function(t){s=s.next((function(){return r.di(e,t)})).next((function(e){var o=e,s=n.ks.get(t);_r(null!==s),(!o||o.version.u(s)<0)&&(o=i.Cs(t,o,n))&&r.hi(o,n.Os)}))})),s.next((function(){return t.Ho.Ni(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.Ho.ki(t)})).next((function(){return n.Ic.Zo(t,r)}))}))}function nc(t){var e=Tr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.wo.Wi(t)}))}function rc(t,e){var n=Tr(t),r=e.Mt,i=n.dc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Tc.Or({Gr:!0});i=n.dc;var s=[];e.Oe.forEach((function(e,o){var u=i.get(o);if(u){s.push(n.wo.rr(t,e.Ke,o).next((function(){return n.wo.sr(t,e.Ue,o)})));var a=e.resumeToken;if(a.o()>0){var c=u.$t(a,r).Lt(t.Ss);i=i.Ht(o,c),function(t,e,n){return _r(e.resumeToken.o()>0),0===t.resumeToken.o()||e.Mt.j()-t.Mt.j()>=3e8||n.Ue.size+n.Qe.size+n.Ke.size>0}(u,c,e)&&s.push(n.wo.Yi(t,c))}}}));var u=as();if(e.Me.forEach((function(r,i){e.Le.has(r)&&s.push(n.persistence.mi.Mr(t,r))})),s.push(ic(t,o,e.Me,r,void 0).next((function(t){u=t}))),!r.isEqual(Kr.min())){var a=n.wo.Wi(t).next((function(e){return n.wo.Gi(t,t.Ss,r)}));s.push(a)}return hu.$n(s).next((function(){return o.apply(t)})).next((function(){return n.Ic.tc(t,u)}))})).then((function(t){return n.dc=i,t}))}function ic(t,e,n,r,i){var o=vs();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=as();return n.forEach((function(n,s){var u=t.get(n),a=(null==i?void 0:i.get(n))||r;s instanceof Oi&&s.version.isEqual(Kr.min())?(e.fi(n,a),o=o.Ht(n,s)):null==u||s.version.u(u.version)>0||0===s.version.u(u.version)&&u.hasPendingWrites?(e.hi(s,a),o=o.Ht(n,s)):mr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",s.version)})),o}))}function oc(t,e){var n=Tr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.Ho.pi(t,e)}))}function sc(t,e){var n=Tr(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.wo.nr(t,e).next((function(i){return i?(r=i,hu.resolve(r)):n.wo.Ui(t).next((function(i){return r=new mo(e,i,0,t.Ss),n.wo.zi(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.dc.get(t.targetId);return(null===r||t.Mt.u(r.Mt)>0)&&(n.dc=n.dc.Ht(t.targetId,t),n.wc.set(e,t.targetId)),t}))}function uc(t,e,n){return(0,dr.mG)(this,void 0,void 0,(function(){var r,i,o,s;return(0,dr.Jh)(this,(function(u){switch(u.label){case 0:r=Tr(t),i=r.dc.get(e),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.mi.removeTarget(t,i)}))];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!vu(s=u.sent()))throw s;return mr("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.dc=r.dc.remove(e),r.wc.delete(i.target),[2]}}))}))}function ac(t,e,n){var r=Tr(t),i=Kr.min(),o=vs();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=Tr(t),i=r.wc.get(n);return void 0!==i?hu.resolve(r.dc.get(i)):r.wo.nr(e,n)}(r,t,ao(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.wo.ar(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.fc.jr(t,e,n?i:Kr.min(),n?o:vs())})).next((function(t){return{documents:t,Pc:o}}))}))}function cc(t,e){var n=Tr(t),r=Tr(n.wo),i=n.dc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Dn(t,e).next((function(t){return t?t.target:null}))}))}function hc(t){var e=Tr(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=Tr(t),i=as(),o=$u(n),s=qa(e),u=IDBKeyRange.lowerBound(o,!0);return s.ls({index:Mu.readTimeIndex,range:u},(function(t,e){var n=Yu(r.Kt,e);i=i.Ht(n.key,n),o=e.readTime})).next((function(){return{gs:i,readTime:ta(o)}}))}(e.Tc,t,e.Ec)})).then((function(t){var n=t.gs,r=t.readTime;return e.Ec=r,n}))}function fc(t){return(0,dr.mG)(this,void 0,void 0,(function(){var e;return(0,dr.Jh)(this,(function(n){return[2,(e=Tr(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=qa(t),n=Kr.min();return e.ls({index:Mu.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=ta(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.Ec=t}))]}))}))}function lc(t,e,n,r){return(0,dr.mG)(this,void 0,void 0,(function(){var i,o,s,u,a,c,h,f,l,p;return(0,dr.Jh)(this,(function(d){switch(d.label){case 0:for(i=Tr(t),o=vs(),s=as(),u=ps(),a=0,c=n;a<c.length;a++)h=c[a],f=e.yc(h.metadata.name),h.document&&(o=o.add(f)),s=s.Ht(f,e.gc(h)),u=u.Ht(f,e.Vc(h.metadata.readTime));return l=i.Tc.Or({Gr:!0}),[4,sc(i,function(t){return ao(eo(Xr.ct("__bundle__/docs/"+t)))}(r))];case 1:return p=d.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return ic(t,l,s,Kr.min(),u).next((function(e){return l.apply(t),e})).next((function(e){return i.wo.Zi(t,p.targetId).next((function(){return i.wo.sr(t,o,p.targetId)})).next((function(){return i.Ic.tc(t,e)}))}))}))]}}))}))}function pc(t,e,n){return void 0===n&&(n=vs()),(0,dr.mG)(this,void 0,void 0,(function(){var r,i;return(0,dr.Jh)(this,(function(o){switch(o.label){case 0:return[4,sc(t,ao(sa(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=Tr(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var o=Ms(e.readTime);if(r.Mt.u(o)>=0)return i.To.qs(t,e);var s=r.$t(Dr.h,o);return i.dc=i.dc.Ht(s.targetId,s),i.wo.Yi(t,s).next((function(){return i.wo.Zi(t,r.targetId)})).next((function(){return i.wo.sr(t,n,r.targetId)})).next((function(){return i.To.qs(t,e)}))}))]}}))}))}var dc=function(){function t(t){this.Kt=t,this.bc=new Map,this.vc=new Map}return t.prototype.Ls=function(t,e){return hu.resolve(this.bc.get(e))},t.prototype.$s=function(t,e){var n;return this.bc.set(e.id,{id:(n=e).id,version:n.version,createTime:Ms(n.createTime)}),hu.resolve()},t.prototype.Bs=function(t,e){return hu.resolve(this.vc.get(e))},t.prototype.qs=function(t,e){return this.vc.set(e.name,function(t){return{name:t.name,query:sa(t.bundledQuery),readTime:Ms(t.readTime)}}(e)),hu.resolve()},t}(),vc=function(){function t(){this.Sc=new os(yc.Dc),this.Cc=new os(yc.xc)}return t.prototype.nt=function(){return this.Sc.nt()},t.prototype.ir=function(t,e){var n=new yc(t,e);this.Sc=this.Sc.add(n),this.Cc=this.Cc.add(n)},t.prototype.Nc=function(t,e){var n=this;t.forEach((function(t){return n.ir(t,e)}))},t.prototype.cr=function(t,e){this.Fc(new yc(t,e))},t.prototype.Oc=function(t,e){var n=this;t.forEach((function(t){return n.cr(t,e)}))},t.prototype.kc=function(t){var e=this,n=new Qr(new Xr([])),r=new yc(n,t),i=new yc(n,t+1),o=[];return this.Cc.Ae([r,i],(function(t){e.Fc(t),o.push(t.key)})),o},t.prototype.Mc=function(){var t=this;this.Sc.forEach((function(e){return t.Fc(e)}))},t.prototype.Fc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},t.prototype.Lc=function(t){var e=new Qr(new Xr([])),n=new yc(e,t),r=new yc(e,t+1),i=vs();return this.Cc.Ae([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.Mi=function(t){var e=new yc(t,0),n=this.Sc.Pe(e);return null!==n&&t.isEqual(n.key)},t}(),yc=function(){function t(t,e){this.key=t,this.$c=e}return t.Dc=function(t,e){return Qr.J(t.key,e.key)||Sr(t.$c,e.$c)},t.xc=function(t,e){return Sr(t.$c,e.$c)||Qr.J(t.key,e.key)},t}(),mc=function(){function t(t,e){this.Ii=t,this.mi=e,this.Ho=[],this.Bc=1,this.qc=new os(yc.Dc)}return t.prototype.Pi=function(t){return hu.resolve(0===this.Ho.length)},t.prototype.yi=function(t,e,n,r){var i=this.Bc;this.Bc++,this.Ho.length>0&&this.Ho[this.Ho.length-1];var o=new Zu(i,e,n,r);this.Ho.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.qc=this.qc.add(new yc(a.key,i)),this.Ii.Qs(t,a.key.path.Z())}return hu.resolve(o)},t.prototype.gi=function(t,e){return hu.resolve(this.Uc(e))},t.prototype.pi=function(t,e){var n=e+1,r=this.Qc(n),i=r<0?0:r;return hu.resolve(this.Ho.length>i?this.Ho[i]:null)},t.prototype.bi=function(){return hu.resolve(0===this.Ho.length?-1:this.Bc-1)},t.prototype.vi=function(t){return hu.resolve(this.Ho.slice())},t.prototype.Si=function(t,e){var n=this,r=new yc(e,0),i=new yc(e,Number.POSITIVE_INFINITY),o=[];return this.qc.Ae([r,i],(function(t){var e=n.Uc(t.$c);o.push(e)})),hu.resolve(o)},t.prototype.Di=function(t,e){var n=this,r=new os(Sr);return e.forEach((function(t){var e=new yc(t,0),i=new yc(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,i],(function(t){r=r.add(t.$c)}))})),hu.resolve(this.Kc(r))},t.prototype.xi=function(t,e){var n=e.path,r=n.length+1,i=n;Qr.Et(i)||(i=i.child(""));var o=new yc(new Qr(i),0),s=new os(Sr);return this.qc.Re((function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(s=s.add(t.$c)),!0)}),o),hu.resolve(this.Kc(s))},t.prototype.Kc=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.Uc(t);null!==r&&n.push(r)})),n},t.prototype.Ni=function(t,e){var n=this;_r(0===this.Wc(e.batchId,"removed")),this.Ho.shift();var r=this.qc;return hu.forEach(e.mutations,(function(i){var o=new yc(i.key,e.batchId);return r=r.delete(o),n.mi.Oi(t,i.key)})).next((function(){n.qc=r}))},t.prototype.Fi=function(t){},t.prototype.Mi=function(t,e){var n=new yc(e,0),r=this.qc.Pe(n);return hu.resolve(e.isEqual(r&&r.key))},t.prototype.ki=function(t){return this.Ho.length,hu.resolve()},t.prototype.Wc=function(t,e){return this.Qc(t)},t.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},t.prototype.Uc=function(t){var e=this.Qc(t);return e<0||e>=this.Ho.length?null:this.Ho[e]},t}(),gc=function(){function t(t,e){this.Ii=t,this.jc=e,this.docs=new ns(Qr.J),this.size=0}return t.prototype.hi=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.jc(e);return this.docs=this.docs.Ht(r,{_i:e,size:s,readTime:n}),this.size+=s-o,this.Ii.Qs(t,r.path.Z())},t.prototype.fi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.di=function(t,e){var n=this.docs.get(e);return hu.resolve(n?n._i:null)},t.prototype.getEntries=function(t,e){var n=this,r=cs();return e.forEach((function(t){var e=n.docs.get(t);r=r.Ht(t,e?e._i:null)})),hu.resolve(r)},t.prototype.jr=function(t,e,n){for(var r=fs(),i=new Qr(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=o.ce(),u=s.key,a=s.value,c=a._i,h=a.readTime;if(!e.path.st(u.path))break;h.u(n)<=0||c instanceof ki&&po(e,c)&&(r=r.Ht(c.key,c))}return hu.resolve(r)},t.prototype.Gc=function(t,e){return hu.forEach(this.docs,(function(t){return e(t)}))},t.prototype.Or=function(t){return new wc(this)},t.prototype.Lr=function(t){return hu.resolve(this.size)},t}(),wc=function(t){function e(e){var n=this;return(n=t.call(this)||this).zr=e,n}return(0,dr.ZT)(e,t),e.prototype.Ti=function(t){var e=this,n=[];return this.ci.forEach((function(r,i){i&&i._i?n.push(e.zr.hi(t,i._i,e.ui(r))):e.zr.fi(r)})),hu.$n(n)},e.prototype.wi=function(t,e){return this.zr.di(t,e)},e.prototype.Ei=function(t,e){return this.zr.getEntries(t,e)},e}(ga),bc=function(){function t(t){this.persistence=t,this.zc=new ma((function(t){return Ri(t)}),Mi),this.lastRemoteSnapshotVersion=Kr.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new vc,this.targetCount=0,this.Yc=Sa.Bi()}return t.prototype.mn=function(t,e){return this.zc.forEach((function(t,n){return e(n)})),hu.resolve()},t.prototype.Wi=function(t){return hu.resolve(this.lastRemoteSnapshotVersion)},t.prototype.ji=function(t){return hu.resolve(this.Hc)},t.prototype.Ui=function(t){return this.highestTargetId=this.Yc.next(),hu.resolve(this.highestTargetId)},t.prototype.Gi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),hu.resolve()},t.prototype.Hi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new Sa(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},t.prototype.zi=function(t,e){return this.Hi(e),this.targetCount+=1,hu.resolve()},t.prototype.Yi=function(t,e){return this.Hi(e),hu.resolve()},t.prototype.Xi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),this.targetCount-=1,hu.resolve()},t.prototype.tr=function(t,e,n){var r=this,i=0,o=[];return this.zc.forEach((function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.zc.delete(s),o.push(r.Zi(t,u.targetId)),i++)})),hu.$n(o).next((function(){return i}))},t.prototype.er=function(t){return hu.resolve(this.targetCount)},t.prototype.nr=function(t,e){var n=this.zc.get(e)||null;return hu.resolve(n)},t.prototype.sr=function(t,e,n){return this.Jc.Nc(e,n),hu.resolve()},t.prototype.rr=function(t,e,n){this.Jc.Oc(e,n);var r=this.persistence.mi,i=[];return r&&e.forEach((function(e){i.push(r.Oi(t,e))})),hu.$n(i)},t.prototype.Zi=function(t,e){return this.Jc.kc(e),hu.resolve()},t.prototype.ar=function(t,e){var n=this.Jc.Lc(e);return hu.resolve(n)},t.prototype.Mi=function(t,e){return hu.resolve(this.Jc.Mi(e))},t}(),Ic=function(){function t(t,e){var n=this;this.Xc={},this.ro=new Hr(0),this.oo=!1,this.oo=!0,this.mi=t(this),this.wo=new bc(this),this.Ii=new ha,this.Eo=function(t,e){return new gc(t,(function(t){return n.mi.Zc(t)}))}(this.Ii),this.Kt=new Wu(e),this.To=new dc(this.Kt)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.$o=function(){return this.oo=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Ir",{get:function(){return this.oo},enumerable:!1,configurable:!0}),t.prototype.Vo=function(){},t.prototype.po=function(){},t.prototype.jo=function(){return this.Ii},t.prototype.Wo=function(t){var e=this.Xc[t.R()];return e||(e=new mc(this.Ii,this.mi),this.Xc[t.R()]=e),e},t.prototype.Cr=function(){return this.wo},t.prototype.kr=function(){return this.Eo},t.prototype.Go=function(){return this.To},t.prototype.runTransaction=function(t,e,n){var r=this;mr("MemoryPersistence","Starting transaction:",t);var i=new _c(this.ro.next());return this.mi.ta(),n(i).next((function(t){return r.mi.ea(i).next((function(){return t}))})).Mn().then((function(t){return i.bs(),t}))},t.prototype.na=function(t,e){return hu.Bn(Object.values(this.Xc).map((function(n){return function(){return n.Mi(t,e)}})))},t}(),_c=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ss=e,n}return(0,dr.ZT)(e,t),e}(Eu),Tc=function(){function t(t){this.persistence=t,this.sa=new vc,this.ia=null}return t.ra=function(e){return new t(e)},Object.defineProperty(t.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw Ir()},enumerable:!1,configurable:!0}),t.prototype.ir=function(t,e,n){return this.sa.ir(n,e),this.oa.delete(n.toString()),hu.resolve()},t.prototype.cr=function(t,e,n){return this.sa.cr(n,e),this.oa.add(n.toString()),hu.resolve()},t.prototype.Oi=function(t,e){return this.oa.add(e.toString()),hu.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach((function(t){return n.oa.add(t.toString())}));var r=this.persistence.Cr();return r.ar(t,e.targetId).next((function(t){t.forEach((function(t){return n.oa.add(t.toString())}))})).next((function(){return r.Xi(t,e)}))},t.prototype.ta=function(){this.ia=new Set},t.prototype.ea=function(t){var e=this,n=this.persistence.kr().Or();return hu.forEach(this.oa,(function(r){var i=Qr.ft(r);return e.ca(t,i).next((function(t){t||n.fi(i)}))})).next((function(){return e.ia=null,n.apply(t)}))},t.prototype.Mr=function(t,e){var n=this;return this.ca(t,e).next((function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())}))},t.prototype.Zc=function(t){return 0},t.prototype.ca=function(t,e){var n=this;return hu.Bn([function(){return hu.resolve(n.sa.Mi(e))},function(){return n.persistence.Cr().Mi(t,e)},function(){return n.persistence.na(t,e)}])},t}();function Ec(t,e){return"firestore_clients_"+t+"_"+e}function Nc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.A()&&(r+="_"+e.uid),r}function Sc(t,e){return"firestore_targets_"+t+"_"+e}var Ac=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.aa=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new Or(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(gr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),xc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.aa=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Or(r.error.code,r.error.message)),i?new t(e,r.state,o):(gr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Dc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.aa=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=ms(),s=0;i&&s<r.activeTargetIds.length;++s)i=li(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(gr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),kc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.aa=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(gr("SharedClientState","Failed to parse online state: "+e),null)},t}(),Oc=function(){function t(){this.activeTargetIds=ms()}return t.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Cc=function(){function t(t,e,n,r,i){this.window=t,this.no=e,this.persistenceKey=n,this._a=r,this.fa=null,this.da=null,this.L=null,this.wa=this.Ea.bind(this),this.Ta=new ns(Sr),this.Ir=!1,this.Ia=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ma=Ec(this.persistenceKey,this._a),this.Aa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ta=this.Ta.Ht(this._a,new Oc),this.Ra=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pa=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.ya=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ga=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Va=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.wa)}return t.Wn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return(0,dr.mG)(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,u,a,c,h,f=this;return(0,dr.Jh)(this,(function(l){switch(l.label){case 0:return[4,this.fa.Ko()];case 1:for(t=l.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this._a&&(i=this.getItem(Ec(this.persistenceKey,r)))&&(o=Dc.aa(r,i))&&(this.Ta=this.Ta.Ht(o.clientId,o));for(this.pa(),(s=this.storage.getItem(this.ga))&&(u=this.ba(s))&&this.va(u),a=0,c=this.Ia;a<c.length;a++)h=c[a],this.Ea(h);return this.Ia=[],this.window.addEventListener("unload",(function(){return f.$o()})),this.Ir=!0,[2]}}))}))},t.prototype.q=function(t){this.setItem(this.Aa,JSON.stringify(t))},t.prototype.Sa=function(){return this.Da(this.Ta)},t.prototype.Ca=function(t){var e=!1;return this.Ta.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.xa=function(t){this.Na(t,"pending")},t.prototype.Fa=function(t,e,n){this.Na(t,e,n),this.Oa(t)},t.prototype.ka=function(t){var e="not-current";if(this.Ca(t)){var n=this.storage.getItem(Sc(this.persistenceKey,t));if(n){var r=xc.aa(t,n);r&&(e=r.state)}}return this.Ma.ha(t),this.pa(),e},t.prototype.La=function(t){this.Ma.la(t),this.pa()},t.prototype.$a=function(t){return this.Ma.activeTargetIds.has(t)},t.prototype.Ba=function(t){this.removeItem(Sc(this.persistenceKey,t))},t.prototype.qa=function(t,e,n){this.Ua(t,e,n)},t.prototype.Qa=function(t,e,n){var r=this;e.forEach((function(t){r.Oa(t)})),this.currentUser=t,n.forEach((function(t){r.xa(t)}))},t.prototype.Ka=function(t){this.Wa(t)},t.prototype.ja=function(){this.Ga()},t.prototype.$o=function(){this.Ir&&(this.window.removeEventListener("storage",this.wa),this.removeItem(this.ma),this.Ir=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return mr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){mr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){mr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Ea=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(mr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ma)return void gr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.no.vo((function(){return(0,dr.mG)(e,void 0,void 0,(function(){var t,e,r,i,o,s;return(0,dr.Jh)(this,(function(u){if(this.Ir){if(null!==n.key)if(this.Ra.test(n.key)){if(null==n.newValue)return t=this.za(n.key),[2,this.Ha(t,null)];if(e=this.Ja(n.key,n.newValue))return[2,this.Ha(e.clientId,e)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(r=this.Ya(n.key,n.newValue)))return[2,this.Xa(r)]}else if(this.ya.test(n.key)){if(null!==n.newValue&&(i=this.Za(n.key,n.newValue)))return[2,this.tu(i)]}else if(n.key===this.ga){if(null!==n.newValue&&(o=this.ba(n.newValue)))return[2,this.va(o)]}else if(n.key===this.Aa)(s=function(t){var e=Hr.U;if(null!=t)try{var n=JSON.parse(t);_r("number"==typeof n),e=n}catch(t){gr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Hr.U&&this.L(s);else if(n.key===this.Va)return[2,this.fa.eu()]}else this.Ia.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Ma",{get:function(){return this.Ta.get(this._a)},enumerable:!1,configurable:!0}),t.prototype.pa=function(){this.setItem(this.ma,this.Ma.ua())},t.prototype.Na=function(t,e,n){var r=new Ac(this.currentUser,t,e,n),i=Nc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ua())},t.prototype.Oa=function(t){var e=Nc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Wa=function(t){var e={clientId:this._a,onlineState:t};this.storage.setItem(this.ga,JSON.stringify(e))},t.prototype.Ua=function(t,e,n){var r=Sc(this.persistenceKey,t),i=new xc(t,e,n);this.setItem(r,i.ua())},t.prototype.Ga=function(){this.setItem(this.Va,"value-not-used")},t.prototype.za=function(t){var e=this.Ra.exec(t);return e?e[1]:null},t.prototype.Ja=function(t,e){var n=this.za(t);return Dc.aa(n,e)},t.prototype.Ya=function(t,e){var n=this.Pa.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Ac.aa(new Gr(i),r,e)},t.prototype.Za=function(t,e){var n=this.ya.exec(t),r=Number(n[1]);return xc.aa(r,e)},t.prototype.ba=function(t){return kc.aa(t)},t.prototype.Xa=function(t){return(0,dr.mG)(this,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.fa.nu(t.batchId,t.state,t.error)]:(mr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.tu=function(t){return this.fa.su(t.targetId,t.state,t.error)},t.prototype.Ha=function(t,e){var n=this,r=e?this.Ta.Ht(t,e):this.Ta.remove(t),i=this.Da(this.Ta),o=this.Da(r),s=[],u=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||u.push(t)})),this.fa.iu(s,u).then((function(){n.Ta=r}))},t.prototype.va=function(t){this.Ta.get(t.clientId)&&this.da(t.onlineState)},t.prototype.Da=function(t){var e=ms();return t.forEach((function(t,n){e=e.ye(n.activeTargetIds)})),e},t}(),Pc=function(){function t(){this.ru=new Oc,this.ou={},this.da=null,this.L=null}return t.prototype.xa=function(t){},t.prototype.Fa=function(t,e,n){},t.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},t.prototype.qa=function(t,e,n){this.ou[t]=e},t.prototype.La=function(t){this.ru.la(t)},t.prototype.$a=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.Ba=function(t){delete this.ou[t]},t.prototype.Sa=function(){return this.ru.activeTargetIds},t.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.start=function(){return this.ru=new Oc,Promise.resolve()},t.prototype.Qa=function(t,e,n){},t.prototype.Ka=function(t){},t.prototype.$o=function(){},t.prototype.q=function(t){},t.prototype.ja=function(){},t}(),Lc=function(){function t(){}return t.prototype.cu=function(t){},t.prototype.$o=function(){},t}(),Rc=function(){function t(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}return t.prototype.cu=function(t){this._u.push(t)},t.prototype.$o=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},t.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},t.prototype.uu=function(){mr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},t.prototype.lu=function(){mr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},t.Wn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Mc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Vc=function(){function t(t){this.du=t.du,this.wu=t.wu}return t.prototype.Eu=function(t){this.Tu=t},t.prototype.Iu=function(t){this.mu=t},t.prototype.onMessage=function(t){this.Au=t},t.prototype.close=function(){this.wu()},t.prototype.send=function(t){this.du(t)},t.prototype.Ru=function(){this.Tu()},t.prototype.Pu=function(t){this.mu(t)},t.prototype.yu=function(t){this.Au(t)},t}(),Uc=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.I=e.I,n}return(0,dr.ZT)(e,t),e.prototype.Du=function(t,e,n,r){return new Promise((function(i,o){var s=new pr;s.listenOnce(cr.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case ar.NO_ERROR:var e=s.getResponseJson();mr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case ar.TIMEOUT:mr("Connection",'RPC "'+t+'" timed out'),o(new Or(kr.DEADLINE_EXCEEDED,"Request time out"));break;case ar.HTTP_ERROR:var n=s.getStatus();if(mr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(kr).indexOf(e)>=0?e:kr.UNKNOWN}(r.status);o(new Or(u,r.message))}else o(new Or(kr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Or(kr.UNAVAILABLE,"Connection failed."));break;default:Ir()}}finally{mr("Connection",'RPC "'+t+'" completed.')}}));var u=JSON.stringify(r);s.send(e,"POST",u,n,15)}))},e.prototype.xu=function(t,e){var n=[this.Vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=sr(),i=ur(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.Su(s.initMessageHeaders,e),(0,o.uI)()||(0,o.b$)()||(0,o.d)()||(0,o.w1)()||(0,o.Mn)()||(0,o.ru)()||(s.httpHeadersOverwriteParam="$httpHeaders");var u=n.join("");mr("Connection","Creating WebChannel: "+u,s);var a=r.createWebChannel(u,s),c=!1,h=!1,f=new Vc({du:function(t){h?mr("Connection","Not sending because WebChannel is closed:",t):(c||(mr("Connection","Opening WebChannel transport."),a.open(),c=!0),mr("Connection","WebChannel sending:",t),a.send(t))},wu:function(){return a.close()}}),l=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return l(a,lr.EventType.OPEN,(function(){h||mr("Connection","WebChannel transport opened.")})),l(a,lr.EventType.CLOSE,(function(){h||(h=!0,mr("Connection","WebChannel transport closed"),f.Pu())})),l(a,lr.EventType.ERROR,(function(t){h||(h=!0,wr("Connection","WebChannel transport errored:",t),f.Pu(new Or(kr.UNAVAILABLE,"The operation could not be completed")))})),l(a,lr.EventType.MESSAGE,(function(t){var e;if(!h){var n=t.data[0];_r(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){mr("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=Xo[t];if(void 0!==e)return es(e)}(o),u=i.message;void 0===s&&(s=kr.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),h=!0,f.Pu(new Or(s,u)),a.close()}else mr("Connection","WebChannel received:",n),f.yu(n)}})),l(i,hr.STAT_EVENT,(function(t){t.stat===fr.PROXY?mr("Connection","Detected buffering proxy"):t.stat===fr.NOPROXY&&mr("Connection","Detected no buffering proxy")})),setTimeout((function(){f.Ru()}),0),f},e}(function(){function t(t){this.gu=t,this.T=t.T;var e=t.ssl?"https":"http";this.Vu=e+"://"+t.host,this.pu="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}return t.prototype.bu=function(t,e,n,r){var i=this.vu(t,e);mr("RestConnection","Sending: ",i,n);var o={};return this.Su(o,r),this.Du(t,i,o,n).then((function(t){return mr("RestConnection","Received: ",t),t}),(function(e){throw wr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Cu=function(t,e,n,r){return this.bu(t,e,n,r)},t.prototype.Su=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.1",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},t.prototype.vu=function(t,e){var n=Mc[t];return this.Vu+"/v1/"+e+":"+n},t}());function Gc(){return"undefined"!=typeof window?window:null}function qc(){return"undefined"!=typeof document?document:null}function jc(t){return new Cs(t,!0)}var Fc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.no=t,this.ds=e,this.Nu=n,this.Fu=r,this.Ou=i,this.ku=0,this.Mu=null,this.Lu=Date.now(),this.reset()}return t.prototype.reset=function(){this.ku=0},t.prototype.$u=function(){this.ku=this.Ou},t.prototype.Bu=function(t){var e=this;this.cancel();var n=Math.floor(this.ku+this.qu()),r=Math.max(0,Date.now()-this.Lu),i=Math.max(0,n-r);i>0&&mr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ku+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Mu=this.no.mr(this.ds,i,(function(){return e.Lu=Date.now(),t()})),this.ku*=this.Fu,this.ku<this.Nu&&(this.ku=this.Nu),this.ku>this.Ou&&(this.ku=this.Ou)},t.prototype.Uu=function(){null!==this.Mu&&(this.Mu.Ps(),this.Mu=null)},t.prototype.cancel=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},t.prototype.qu=function(){return(Math.random()-.5)*this.ku},t}(),Jc=function(){function t(t,e,n,r,i,o){this.no=t,this.Qu=n,this.Ku=r,this.Wu=i,this.listener=o,this.state=0,this.ju=0,this.Gu=null,this.stream=null,this.zu=new Fc(t,e)}return t.prototype.Hu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Ju=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Yu()},t.prototype.stop=function(){return(0,dr.mG)(this,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(t){switch(t.label){case 0:return this.Hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.Xu=function(){this.state=0,this.zu.reset()},t.prototype.Zu=function(){var t=this;this.Ju()&&null===this.Gu&&(this.Gu=this.no.mr(this.Qu,6e4,(function(){return t.th()})))},t.prototype.eh=function(t){this.nh(),this.stream.send(t)},t.prototype.th=function(){return(0,dr.mG)(this,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(t){return this.Ju()?[2,this.close(0)]:[2]}))}))},t.prototype.nh=function(){this.Gu&&(this.Gu.cancel(),this.Gu=null)},t.prototype.close=function(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(n){switch(n.label){case 0:return this.nh(),this.zu.cancel(),this.ju++,3!==t?this.zu.reset():e&&e.code===kr.RESOURCE_EXHAUSTED?(gr(e.toString()),gr("Using maximum backoff delay to prevent overloading the backend."),this.zu.$u()):e&&e.code===kr.UNAUTHENTICATED&&this.Wu.v(),null!==this.stream&&(this.sh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Iu(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.sh=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.ih(this.ju),n=this.ju;this.Wu.getToken().then((function(e){t.ju===n&&t.rh(e)}),(function(n){e((function(){var e=new Or(kr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.oh(e)}))}))},t.prototype.rh=function(t){var e=this,n=this.ih(this.ju);this.stream=this.ah(t),this.stream.Eu((function(){n((function(){return e.state=2,e.listener.Eu()}))})),this.stream.Iu((function(t){n((function(){return e.oh(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.Yu=function(){var t=this;this.state=4,this.zu.Bu((function(){return(0,dr.mG)(t,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.oh=function(t){return mr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.ih=function(t){var e=this;return function(n){e.no.ys((function(){return e.ju===t?n():(mr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),zc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).Kt=i,s}return(0,dr.ZT)(e,t),e.prototype.ah=function(t){return this.Ku.xu("Listen",t)},e.prototype.onMessage=function(t){this.zu.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Ir()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.qt?(_r(void 0===e||"string"==typeof e),Dr.fromBase64String(e||"")):(_r(void 0===e||e instanceof Uint8Array),Dr.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(u=e.targetChange.cause)&&function(t){var e=void 0===t.code?kr.UNKNOWN:es(t.code);return new Or(e,t.message||"")}(u);n=new Ns(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=qs(t,r.document.name),o=Ms(r.document.updateTime);var u=new Si({mapValue:{fields:r.document.fields}}),a=(s=new ki(i,o,u,{}),r.targetIds||[]),c=r.removedTargetIds||[];n=new Ts(a,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=qs(t,r.document),o=r.readTime?Ms(r.readTime):Kr.min(),u=new Oi(i,o),s=r.removedTargetIds||[],n=new Ts([],s,u.key,u);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=qs(t,r.document),o=r.removedTargetIds||[],n=new Ts([],o,i,null);else{if(!("filter"in e))return Ir();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new $o(r),o=h.targetId,n=new Es(o,i)}return n}(this.Kt,t),n=function(t){if(!("targetChange"in t))return Kr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Kr.min():e.readTime?Ms(e.readTime):Kr.min()}(t);return this.listener.uh(e,n)},e.prototype.hh=function(t){var e={};e.database=Js(this.Kt),e.addTarget=function(t,e){var n,r=e.target;return(n=Vi(r)?{documents:Xs(t,r)}:{query:Ws(t,r)}).targetId=e.targetId,e.resumeToken.o()>0?n.resumeToken=Ls(t,e.resumeToken):e.Mt.u(Kr.min())>0&&(n.readTime=Ps(t,e.Mt.G())),n}(this.Kt,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ir()}}(0,e.kt);return null==n?null:{"goog-listen-tags":n}}(this.Kt,t);n&&(e.labels=n),this.eh(e)},e.prototype.lh=function(t){var e={};e.database=Js(this.Kt),e.removeTarget=t,this.eh(e)},e}(Jc),Hc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).Kt=i,s._h=!1,s}return(0,dr.ZT)(e,t),Object.defineProperty(e.prototype,"fh",{get:function(){return this._h},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._h=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.sh=function(){this._h&&this.dh([])},e.prototype.ah=function(t){return this.Ku.xu("Write",t)},e.prototype.onMessage=function(t){if(_r(!!t.streamToken),this.lastStreamToken=t.streamToken,this._h){this.zu.reset();var e=function(t,e){return t&&t.length>0?(_r(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?Ms(t.updateTime):Ms(e);n.isEqual(Kr.min())&&(n=Ms(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new Lo(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Ms(t.commitTime);return this.listener.wh(n,e)}return _r(!t.writeResults||0===t.writeResults.length),this._h=!0,this.listener.Eh()},e.prototype.Th=function(){var t={};t.database=Js(this.Kt),this.eh(t)},e.prototype.dh=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Ks(e.Kt,t)}))};this.eh(n)},e}(Jc),Bc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Ku=n,i.Kt=r,i.Ih=!1,i}return(0,dr.ZT)(e,t),e.prototype.mh=function(){if(this.Ih)throw new Or(kr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.bu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then((function(i){return r.Ku.bu(t,e,n,i)})).catch((function(t){throw t.code===kr.UNAUTHENTICATED&&r.credentials.v(),t}))},e.prototype.Cu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then((function(i){return r.Ku.Cu(t,e,n,i)})).catch((function(t){throw t.code===kr.UNAUTHENTICATED&&r.credentials.v(),t}))},e.prototype.terminate=function(){this.Ih=!1},e}((function(){})),Kc=function(){function t(t,e){this.fs=t,this.da=e,this.state="Unknown",this.Ah=0,this.Rh=null,this.Ph=!0}return t.prototype.yh=function(){var t=this;0===this.Ah&&(this.gh("Unknown"),this.Rh=this.fs.mr("online_state_timeout",1e4,(function(){return t.Rh=null,t.Vh("Backend didn't respond within 10 seconds."),t.gh("Offline"),Promise.resolve()})))},t.prototype.ph=function(t){"Online"===this.state?this.gh("Unknown"):(this.Ah++,this.Ah>=1&&(this.bh(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.gh("Offline")))},t.prototype.set=function(t){this.bh(),this.Ah=0,"Online"===t&&(this.Ph=!1),this.gh(t)},t.prototype.gh=function(t){t!==this.state&&(this.state=t,this.da(t))},t.prototype.Vh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ph?(gr(e),this.Ph=!1):mr("OnlineStateTracker",e)},t.prototype.bh=function(){null!==this.Rh&&(this.Rh.cancel(),this.Rh=null)},t}(),Zc=function(t,e,n,r,i){var o=this;this.Sh=t,this.Dh=e,this.fs=n,this.Ch={},this.xh=[],this.Nh=new Map,this.Fh=new Set,this.Oh=[],this.kh=i,this.kh.cu((function(t){n.ys((function(){return(0,dr.mG)(o,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(t){switch(t.label){case 0:return rh(this)?(mr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return(0,dr.mG)(this,void 0,void 0,(function(){var e;return(0,dr.Jh)(this,(function(n){switch(n.label){case 0:return(e=Tr(t)).Fh.add(4),[4,Wc(e)];case 1:return n.sent(),e.Mh.set("Unknown"),e.Fh.delete(4),[4,Xc(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Mh=new Kc(n,r)};function Xc(t){return(0,dr.mG)(this,void 0,void 0,(function(){var e,n;return(0,dr.Jh)(this,(function(r){switch(r.label){case 0:if(!rh(t))return[3,4];e=0,n=t.Oh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Wc(t){return(0,dr.mG)(this,void 0,void 0,(function(){var e,n;return(0,dr.Jh)(this,(function(r){switch(r.label){case 0:e=0,n=t.Oh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Yc(t,e){var n=Tr(t);n.Nh.has(e.targetId)||(n.Nh.set(e.targetId,e),nh(n)?eh(n):gh(n).Ju()&&$c(n,e))}function Qc(t,e){var n=Tr(t),r=gh(n);n.Nh.delete(e),r.Ju()&&th(n,e),0===n.Nh.size&&(r.Ju()?r.Zu():rh(n)&&n.Mh.set("Unknown"))}function $c(t,e){t.Lh.cn(e.targetId),gh(t).hh(e)}function th(t,e){t.Lh.cn(e),gh(t).lh(e)}function eh(t){t.Lh=new As({Sn:function(e){return t.Ch.Sn(e)},Dn:function(e){return t.Nh.get(e)||null}}),gh(t).start(),t.Mh.yh()}function nh(t){return rh(t)&&!gh(t).Hu()&&t.Nh.size>0}function rh(t){return 0===Tr(t).Fh.size}function ih(t){t.Lh=void 0}function oh(t){return(0,dr.mG)(this,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(e){return t.Nh.forEach((function(e,n){$c(t,e)})),[2]}))}))}function sh(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(n){return ih(t),nh(t)?(t.Mh.ph(e),eh(t)):t.Mh.set("Unknown"),[2]}))}))}function uh(t,e,n){return(0,dr.mG)(this,void 0,void 0,(function(){var r,i,o;return(0,dr.Jh)(this,(function(s){switch(s.label){case 0:if(t.Mh.set("Online"),!(e instanceof Ns&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r,i,o;return(0,dr.Jh)(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.Nh.has(o)?[4,t.Ch.$h(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.Nh.delete(o),t.Lh.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),mr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,ah(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Ts?t.Lh.wn(e):e instanceof Es?t.Lh.yn(e):t.Lh.In(e),n.isEqual(Kr.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,nc(t.Sh)];case 8:return i=s.sent(),n.u(i)>=0?[4,function(t,e){var n=t.Lh.pn(e);return n.Oe.forEach((function(n,r){if(n.resumeToken.o()>0){var i=t.Nh.get(r);i&&t.Nh.set(r,i.$t(n.resumeToken,e))}})),n.ke.forEach((function(e){var n=t.Nh.get(e);if(n){t.Nh.set(e,n.$t(Dr.h,n.Mt)),th(t,e);var r=new mo(n.target,e,1,n.sequenceNumber);$c(t,r)}})),t.Ch.Bh(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return mr("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,ah(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function ah(t,e,n){return(0,dr.mG)(this,void 0,void 0,(function(){var r=this;return(0,dr.Jh)(this,(function(i){switch(i.label){case 0:if(!vu(e))throw e;return t.Fh.add(1),[4,Wc(t)];case 1:return i.sent(),t.Mh.set("Offline"),n||(n=function(){return nc(t.Sh)}),t.fs.vo((function(){return(0,dr.mG)(r,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(e){switch(e.label){case 0:return mr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Fh.delete(1),[4,Xc(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function ch(t,e){return e().catch((function(n){return ah(t,n,e)}))}function hh(t){return(0,dr.mG)(this,void 0,void 0,(function(){var e,n,r,i,o;return(0,dr.Jh)(this,(function(s){switch(s.label){case 0:e=Tr(t),n=wh(e),r=e.xh.length>0?e.xh[e.xh.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return rh(t)&&t.xh.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,oc(e.Sh,r)];case 3:return null===(i=s.sent())?(0===e.xh.length&&n.Zu(),[3,7]):(r=i.batchId,function(t,e){t.xh.push(e);var n=wh(t);n.Ju()&&n.fh&&n.dh(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,ah(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return fh(e)&&lh(e),[2]}}))}))}function fh(t){return rh(t)&&!wh(t).Hu()&&t.xh.length>0}function lh(t){wh(t).start()}function ph(t){return(0,dr.mG)(this,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(e){return wh(t).Th(),[2]}))}))}function dh(t){return(0,dr.mG)(this,void 0,void 0,(function(){var e,n,r,i;return(0,dr.Jh)(this,(function(o){for(e=wh(t),n=0,r=t.xh;n<r.length;n++)i=r[n],e.dh(i.mutations);return[2]}))}))}function vh(t,e,n){return(0,dr.mG)(this,void 0,void 0,(function(){var r,i;return(0,dr.Jh)(this,(function(o){switch(o.label){case 0:return r=t.xh.shift(),i=Xu.from(r,e,n),[4,ch(t,(function(){return t.Ch.qh(i)}))];case 1:return o.sent(),[4,hh(t)];case 2:return o.sent(),[2]}}))}))}function yh(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(n){switch(n.label){case 0:return e&&wh(t).fh?[4,function(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r;return(0,dr.Jh)(this,(function(i){switch(i.label){case 0:return ts(r=e.code)&&r!==kr.ABORTED?(n=t.xh.shift(),wh(t).Xu(),[4,ch(t,(function(){return t.Ch.Uh(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,hh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return fh(t)&&lh(t),[2]}}))}))}function mh(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n;return(0,dr.Jh)(this,(function(r){switch(r.label){case 0:return n=Tr(t),e?(n.Fh.delete(2),[4,Xc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Fh.add(2),[4,Wc(n)]);case 3:r.sent(),n.Mh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function gh(t){var e=this;return t.Qh||(t.Qh=function(t,e,n){var r=Tr(t);return r.mh(),new zc(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:oh.bind(null,t),Iu:sh.bind(null,t),uh:uh.bind(null,t)}),t.Oh.push((function(n){return(0,dr.mG)(e,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(e){switch(e.label){case 0:return n?(t.Qh.Xu(),nh(t)?eh(t):t.Mh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Qh.stop()];case 2:e.sent(),ih(t),e.label=3;case 3:return[2]}}))}))}))),t.Qh}function wh(t){var e=this;return t.Kh||(t.Kh=function(t,e,n){var r=Tr(t);return r.mh(),new Hc(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:ph.bind(null,t),Iu:yh.bind(null,t),Eh:dh.bind(null,t),wh:vh.bind(null,t)}),t.Oh.push((function(n){return(0,dr.mG)(e,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(e){switch(e.label){case 0:return n?(t.Kh.Xu(),[4,hh(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kh.stop()];case 3:e.sent(),t.xh.length>0&&(mr("RemoteStore","Stopping write stream with "+t.xh.length+" pending writes"),t.xh=[]),e.label=4;case 4:return[2]}}))}))}))),t.Kh}var bh=function(){this.Wh=void 0,this.listeners=[]},Ih=function(){this.queries=new ma((function(t){return fo(t)}),ho),this.onlineState="Unknown",this.jh=new Set};function _h(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,u,a;return(0,dr.Jh)(this,(function(c){switch(c.label){case 0:if(n=Tr(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new bh),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.Gh(r)];case 2:return s.Wh=c.sent(),[3,4];case 3:return u=c.sent(),a=Iu(u,"Initialization of query '"+lo(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zh(n.onlineState),o.Wh&&e.Hh(o.Wh)&&Sh(n),[2]}}))}))}function Th(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r,i,o,s;return(0,dr.Jh)(this,(function(u){return n=Tr(t),r=e.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Jh(r))]:[2]}))}))}function Eh(t,e){for(var n=Tr(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,a=n.queries.get(u);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].Hh(s)&&(r=!0);a.Wh=s}}r&&Sh(n)}function Nh(t,e,n){var r=Tr(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Sh(t){t.jh.forEach((function(t){t.next()}))}var Ah=function(){function t(t,e,n){this.query=t,this.Yh=e,this.Xh=!1,this.Zh=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new bs(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.Xh?this.tl(t)&&(this.Yh.next(t),o=!0):this.el(t,this.onlineState)&&(this.nl(t),o=!0),this.Zh=t,o},t.prototype.onError=function(t){this.Yh.error(t)},t.prototype.zh=function(t){this.onlineState=t;var e=!1;return this.Zh&&!this.Xh&&this.el(this.Zh,t)&&(this.nl(this.Zh),e=!0),e},t.prototype.el=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.sl&&n||t.docs.nt()&&"Offline"!==e)},t.prototype.tl=function(t){if(t.docChanges.length>0)return!0;var e=this.Zh&&this.Zh.hasPendingWrites!==t.hasPendingWrites;return!(!t.xe&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.nl=function(t){t=bs.Fe(t.query,t.docs,t.Ce,t.fromCache),this.Xh=!0,this.Yh.next(t)},t}(),xh=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.il=function(){return"metadata"in this.payload},t}(),Dh=function(){function t(t){this.Kt=t}return t.prototype.yc=function(t){return qs(this.Kt,t)},t.prototype.gc=function(t){return t.metadata.exists?Bs(this.Kt,t.document,!1):new Oi(this.yc(t.metadata.name),this.Vc(t.metadata.readTime))},t.prototype.Vc=function(t){return Ms(t)},t}();!function(){function t(t,e,n){this.rl=t,this.Sh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=kh(t)}t.prototype.ol=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.cl=function(t){for(var e=new Map,n=new Dh(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||vs()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return(0,dr.mG)(this,void 0,void 0,(function(){var t,e,n,r,i;return(0,dr.Jh)(this,(function(o){switch(o.label){case 0:return[4,lc(this.Sh,new Dh(this.Kt),this.documents,this.rl.id)];case 1:t=o.sent(),e=this.cl(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,pc(this.Sh,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new _u(Object.assign({},this.progress),t))]}}))}))}}();function kh(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Oh=function(t){this.key=t},Ch=function(t){this.key=t},Ph=function(){function t(t,e){this.query=t,this.al=e,this.ul=null,this.qe=!1,this.hl=vs(),this.Ce=vs(),this.ll=vo(t),this._l=new gs(this.ll)}return Object.defineProperty(t.prototype,"fl",{get:function(){return this.al},enumerable:!1,configurable:!0}),t.prototype.dl=function(t,e){var n=this,r=e?e.wl:new ws,i=e?e._l:this._l,o=e?e.Ce:this.Ce,s=i,u=!1,a=no(this.query)&&i.size===this.query.limit?i.last():null,c=ro(this.query)&&i.size===this.query.limit?i.first():null;if(t.Zt((function(t,e){var h=i.get(t),f=e instanceof ki?e:null;f&&(f=po(n.query,f)?f:null);var l=!!h&&n.Ce.has(h.key),p=!!f&&(f.bt||n.Ce.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.El(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.ll(f,a)>0||c&&n.ll(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),no(this.query)||ro(this.query))for(;s.size>this.query.limit;){var h=no(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{_l:s,wl:r,_c:u,Ce:o}},t.prototype.El=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},t.prototype.Ti=function(t,e,n){var r=this,i=this._l;this._l=t._l,this.Ce=t.Ce;var o=t.wl.Se();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ir()}};return n(t)-n(e)}(t.type,e.type)||r.ll(t.doc,e.doc)})),this.Tl(n);var s=e?this.Il():[],u=0===this.hl.size&&this.qe?1:0,a=u!==this.ul;return this.ul=u,0!==o.length||a?{snapshot:new bs(this.query,t._l,i,o,t.Ce,0===u,a,!1),ml:s}:{ml:s}},t.prototype.zh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ti({_l:this._l,wl:new ws,Ce:this.Ce,_c:!1},!1)):{ml:[]}},t.prototype.Al=function(t){return!this.al.has(t)&&!!this._l.has(t)&&!this._l.get(t).bt},t.prototype.Tl=function(t){var e=this;t&&(t.Ue.forEach((function(t){return e.al=e.al.add(t)})),t.Qe.forEach((function(t){})),t.Ke.forEach((function(t){return e.al=e.al.delete(t)})),this.qe=t.qe)},t.prototype.Il=function(){var t=this;if(!this.qe)return[];var e=this.hl;this.hl=vs(),this._l.forEach((function(e){t.Al(e.key)&&(t.hl=t.hl.add(e.key))}));var n=[];return e.forEach((function(e){t.hl.has(e)||n.push(new Ch(e))})),this.hl.forEach((function(t){e.has(t)||n.push(new Oh(t))})),n},t.prototype.Rl=function(t){this.al=t.Pc,this.hl=vs();var e=this.dl(t.documents);return this.Ti(e,!0)},t.prototype.Pl=function(){return bs.Fe(this.query,this._l,this.Ce,0===this.ul)},t}(),Lh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Rh=function(t){this.key=t,this.yl=!1},Mh=function(){function t(t,e,n,r,i,o){this.Sh=t,this.gl=e,this.Vl=n,this.pl=r,this.currentUser=i,this.bl=o,this.vl={},this.Sl=new ma((function(t){return fo(t)}),ho),this.Dl=new Map,this.Cl=[],this.xl=new ns(Qr.J),this.Nl=new Map,this.Fl=new vc,this.Ol={},this.kl=new Map,this.Ml=Sa.qi(),this.onlineState="Unknown",this.Ll=void 0}return Object.defineProperty(t.prototype,"$l",{get:function(){return!0===this.Ll},enumerable:!1,configurable:!0}),t}();function Vh(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,u;return(0,dr.Jh)(this,(function(a){switch(a.label){case 0:return n=pf(t),(o=n.Sl.get(e))?(r=o.targetId,n.pl.ka(r),i=o.view.Pl(),[3,4]):[3,1];case 1:return[4,sc(n.Sh,ao(e))];case 2:return s=a.sent(),u=n.pl.ka(s.targetId),r=s.targetId,[4,Uh(n,e,r,"current"===u)];case 3:i=a.sent(),n.$l&&Yc(n.gl,s),a.label=4;case 4:return[2,i]}}))}))}function Uh(t,e,n,r){return(0,dr.mG)(this,void 0,void 0,(function(){var i,o,s,u,a,c;return(0,dr.Jh)(this,(function(h){switch(h.label){case 0:return t.Bl=function(e,n,r){return function(t,e,n,r){return(0,dr.mG)(this,void 0,void 0,(function(){var i,o,s;return(0,dr.Jh)(this,(function(u){switch(u.label){case 0:return(i=e.view.dl(n))._c?[4,ac(t.Sh,e.query,!1).then((function(t){var n=t.documents;return e.view.dl(n,i)}))]:[3,2];case 1:i=u.sent(),u.label=2;case 2:return o=r&&r.Oe.get(e.targetId),s=e.view.Ti(i,t.$l,o),[2,(Yh(t,e.targetId,s.ml),s.snapshot)]}}))}))}(t,e,n,r)},[4,ac(t.Sh,e,!0)];case 1:return i=h.sent(),o=new Ph(e,i.Pc),s=o.dl(i.documents),u=_s.Be(n,r&&"Offline"!==t.onlineState),a=o.Ti(s,t.$l,u),Yh(t,n,a.ml),c=new Lh(e,n,o),[2,(t.Sl.set(e,c),t.Dl.has(n)?t.Dl.get(n).push(e):t.Dl.set(n,[e]),a.snapshot)]}}))}))}function Gh(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,dr.Jh)(this,(function(o){switch(o.label){case 0:return n=Tr(t),r=n.Sl.get(e),(i=n.Dl.get(r.targetId)).length>1?[2,(n.Dl.set(r.targetId,i.filter((function(t){return!ho(t,e)}))),void n.Sl.delete(e))]:n.$l?(n.pl.La(r.targetId),n.pl.Ca(r.targetId)?[3,2]:[4,uc(n.Sh,r.targetId,!1).then((function(){n.pl.Ba(r.targetId),Qc(n.gl,r.targetId),Xh(n,r.targetId)})).catch(ya)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Xh(n,r.targetId),[4,uc(n.Sh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function qh(t,e,n){return(0,dr.mG)(this,void 0,void 0,(function(){var r,i,o,s;return(0,dr.Jh)(this,(function(u){switch(u.label){case 0:r=df(t),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(t,e){var n,r=Tr(t),i=Br.now(),o=e.reduce((function(t,e){return t.add(e.key)}),vs());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Ic.Zo(t,o).next((function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=qo(c,n.get(c.key));null!=h&&s.push(new zo(c.key,h,xi(h.proto.mapValue),Ro.exists(!0)))}return r.Ho.yi(t,i,s,e)}))})).then((function(t){var e=t.Fs(n);return{batchId:t.batchId,ci:e}}))}(r.Sh,e)];case 2:return i=u.sent(),r.pl.xa(i.batchId),function(t,e,n){var r=t.Ol[t.currentUser.R()];r||(r=new ns(Sr)),r=r.Ht(e,n),t.Ol[t.currentUser.R()]=r}(r,i.batchId,n),[4,tf(r,i.ci)];case 3:return u.sent(),[4,hh(r.gl)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=Iu(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function jh(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r;return(0,dr.Jh)(this,(function(i){switch(i.label){case 0:n=Tr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,rc(n.Sh,e)];case 2:return r=i.sent(),e.Oe.forEach((function(t,e){var r=n.Nl.get(e);r&&(_r(t.Ue.size+t.Qe.size+t.Ke.size<=1),t.Ue.size>0?r.yl=!0:t.Qe.size>0?_r(r.yl):t.Ke.size>0&&(_r(r.yl),r.yl=!1))})),[4,tf(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,ya(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Fh(t,e,n){var r=Tr(t);if(r.$l&&0===n||!r.$l&&1===n){var i=[];r.Sl.forEach((function(t,n){var r=n.view.zh(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=Tr(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zh(e)&&(r=!0)})),r&&Sh(n)}(r.Vl,e),i.length&&r.vl.uh(i),r.onlineState=e,r.$l&&r.pl.Ka(e)}}function Jh(t,e,n){return(0,dr.mG)(this,void 0,void 0,(function(){var r,i,o,s,u,a;return(0,dr.Jh)(this,(function(c){switch(c.label){case 0:return(r=Tr(t)).pl.qa(e,"rejected",n),i=r.Nl.get(e),(o=i&&i.key)?(s=(s=new ns(Qr.J)).Ht(o,new Oi(o,Kr.min())),u=vs().add(o),a=new Is(Kr.min(),new Map,new os(Sr),s,u),[4,jh(r,a)]):[3,2];case 1:return c.sent(),r.xl=r.xl.remove(o),r.Nl.delete(e),$h(r),[3,4];case 2:return[4,uc(r.Sh,e,!1).then((function(){return Xh(r,e,n)})).catch(ya)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function zh(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,dr.Jh)(this,(function(o){switch(o.label){case 0:n=Tr(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,ec(n.Sh,e)];case 2:return i=o.sent(),Zh(n,r,null),Kh(n,r),n.pl.Fa(r,"acknowledged"),[4,tf(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,ya(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Hh(t,e,n){return(0,dr.mG)(this,void 0,void 0,(function(){var r,i;return(0,dr.Jh)(this,(function(o){switch(o.label){case 0:r=Tr(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Tr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.Ho.gi(t,e).next((function(e){return _r(null!==e),r=e.keys(),n.Ho.Ni(t,e)})).next((function(){return n.Ho.ki(t)})).next((function(){return n.Ic.Zo(t,r)}))}))}(r.Sh,e)];case 2:return i=o.sent(),Zh(r,e,n),Kh(r,e),r.pl.Fa(e,"rejected",n),[4,tf(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,ya(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Bh(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r,i,o,s;return(0,dr.Jh)(this,(function(u){switch(u.label){case 0:rh((n=Tr(t)).gl)||mr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(t){var e=Tr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.Ho.bi(t)}))}(n.Sh)];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.kl.get(r)||[]).push(e),n.kl.set(r,i),[3,4]);case 3:return o=u.sent(),s=Iu(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}function Kh(t,e){(t.kl.get(e)||[]).forEach((function(t){t.resolve()})),t.kl.delete(e)}function Zh(t,e,n){var r=Tr(t),i=r.Ol[r.currentUser.R()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Ol[r.currentUser.R()]=i}}function Xh(t,e,n){void 0===n&&(n=null),t.pl.La(e);for(var r=0,i=t.Dl.get(e);r<i.length;r++){var o=i[r];t.Sl.delete(o),n&&t.vl.ql(o,n)}t.Dl.delete(e),t.$l&&t.Fl.kc(e).forEach((function(e){t.Fl.Mi(e)||Wh(t,e)}))}function Wh(t,e){var n=t.xl.get(e);null!==n&&(Qc(t.gl,n),t.xl=t.xl.remove(e),t.Nl.delete(n),$h(t))}function Yh(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Oh?(t.Fl.ir(o.key,e),Qh(t,o)):o instanceof Ch?(mr("SyncEngine","Document no longer in limbo: "+o.key),t.Fl.cr(o.key,e),t.Fl.Mi(o.key)||Wh(t,o.key)):Ir()}}function Qh(t,e){var n=e.key;t.xl.get(n)||(mr("SyncEngine","New document in limbo: "+n),t.Cl.push(n),$h(t))}function $h(t){for(;t.Cl.length>0&&t.xl.size<t.bl;){var e=t.Cl.shift(),n=t.Ml.next();t.Nl.set(n,new Rh(e)),t.xl=t.xl.Ht(e,n),Yc(t.gl,new mo(ao(eo(e.path)),n,2,Hr.U))}}function tf(t,e,n){return(0,dr.mG)(this,void 0,void 0,(function(){var r,i,o,s;return(0,dr.Jh)(this,(function(u){switch(u.label){case 0:return r=Tr(t),i=[],o=[],s=[],r.Sl.nt()?[3,3]:(r.Sl.forEach((function(t,u){s.push(r.Bl(u,e,n).then((function(t){if(t){r.$l&&r.pl.qa(u.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Wa.cc(u.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return u.sent(),r.vl.uh(i),[4,function(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,u,a,c,h;return(0,dr.Jh)(this,(function(f){switch(f.label){case 0:n=Tr(t),f.label=1;case 1:return f.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return hu.forEach(e,(function(e){return hu.forEach(e.rc,(function(r){return n.persistence.mi.ir(t,e.targetId,r)})).next((function(){return hu.forEach(e.oc,(function(r){return n.persistence.mi.cr(t,e.targetId,r)}))}))}))}))];case 2:return f.sent(),[3,4];case 3:if(!vu(r=f.sent()))throw r;return mr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],u=s.targetId,s.fromCache||(a=n.dc.get(u),c=a.Mt,h=a.Bt(c),n.dc=n.dc.Ht(u,h));return[2]}}))}))}(r.Sh,o)];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))}function ef(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r;return(0,dr.Jh)(this,(function(i){switch(i.label){case 0:return(n=Tr(t)).currentUser.isEqual(e)?[3,3]:(mr("SyncEngine","User change. New user:",e.R()),[4,tc(n.Sh,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.kl.forEach((function(t){t.forEach((function(t){t.reject(new Or(kr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.kl.clear()}(n),n.pl.Qa(e,r.Ac,r.Rc),[4,tf(n,r.mc)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function nf(t,e){var n=Tr(t),r=n.Nl.get(e);if(r&&r.yl)return vs().add(r.key);var i=vs(),o=n.Dl.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=u[s],c=n.Sl.get(a);i=i.ye(c.view.fl)}return i}function rf(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,dr.Jh)(this,(function(o){switch(o.label){case 0:return[4,ac((n=Tr(t)).Sh,e.query,!0)];case 1:return r=o.sent(),i=e.view.Rl(r),[2,(n.$l&&Yh(n,e.targetId,i.ml),i)]}}))}))}function of(t){return(0,dr.mG)(this,void 0,void 0,(function(){var e;return(0,dr.Jh)(this,(function(n){return[2,hc((e=Tr(t)).Sh).then((function(t){return tf(e,t)}))]}))}))}function sf(t,e,n,r){return(0,dr.mG)(this,void 0,void 0,(function(){var i,o;return(0,dr.Jh)(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=Tr(t),r=Tr(n.Ho);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.Vi(t,e).next((function(e){return e?n.Ic.Zo(t,e):hu.resolve(null)}))}))}((i=Tr(t)).Sh,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,hh(i.gl)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Zh(i,e,r||null),Kh(i,e),function(t,e){Tr(Tr(t).Ho).Fi(e)}(i.Sh,e)):Ir(),s.label=4;case 4:return[4,tf(i,o)];case 5:return s.sent(),[3,7];case 6:mr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function uf(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,u,a,c;return(0,dr.Jh)(this,(function(h){switch(h.label){case 0:return pf(n=Tr(t)),df(n),!0!==e||!0===n.Ll?[3,3]:(r=n.pl.Sa(),[4,af(n,r.rt())]);case 1:return i=h.sent(),n.Ll=!0,[4,mh(n.gl,!0)];case 2:for(h.sent(),o=0,s=i;o<s.length;o++)u=s[o],Yc(n.gl,u);return[3,7];case 3:return!1!==e||!1===n.Ll?[3,7]:(a=[],c=Promise.resolve(),n.Dl.forEach((function(t,e){n.pl.$a(e)?a.push(e):c=c.then((function(){return Xh(n,e),uc(n.Sh,e,!0)})),Qc(n.gl,e)})),[4,c]);case 4:return h.sent(),[4,af(n,a)];case 5:return h.sent(),function(t){var e=Tr(t);e.Nl.forEach((function(t,n){Qc(e.gl,n)})),e.Fl.Mc(),e.Nl=new Map,e.xl=new ns(Qr.J)}(n),n.Ll=!1,[4,mh(n.gl,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}}))}))}function af(t,e,n){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,u,a,c,h,f,l,p,d,v;return(0,dr.Jh)(this,(function(y){switch(y.label){case 0:n=Tr(t),r=[],i=[],o=0,s=e,y.label=1;case 1:return o<s.length?(u=s[o],a=void 0,(c=n.Dl.get(u))&&0!==c.length?[4,sc(n.Sh,ao(c[0]))]:[3,7]):[3,13];case 2:a=y.sent(),h=0,f=c,y.label=3;case 3:return h<f.length?(l=f[h],p=n.Sl.get(l),[4,rf(n,p)]):[3,6];case 4:(d=y.sent()).snapshot&&i.push(d.snapshot),y.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,cc(n.Sh,u)];case 8:return v=y.sent(),[4,sc(n.Sh,v)];case 9:return a=y.sent(),[4,Uh(n,cf(v),u,!1)];case 10:y.sent(),y.label=11;case 11:r.push(a),y.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vl.uh(i),r)]}}))}))}function cf(t){return to(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function hf(t){var e=Tr(t);return Tr(Tr(e.Sh).persistence).Ko()}function ff(t,e,n,r){return(0,dr.mG)(this,void 0,void 0,(function(){var i,o,s;return(0,dr.Jh)(this,(function(u){switch(u.label){case 0:return(i=Tr(t)).Ll?(mr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Dl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,hc(i.Sh)];case 3:return o=u.sent(),s=Is.$e(e,"current"===n),[4,tf(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,uc(i.Sh,e,!0)];case 6:return u.sent(),Xh(i,e,r),[3,8];case 7:Ir(),u.label=8;case 8:return[2]}}))}))}function lf(t,e,n){return(0,dr.mG)(this,void 0,void 0,(function(){var r,i,o,s,u,a,c,h,f,l;return(0,dr.Jh)(this,(function(p){switch(p.label){case 0:if(!(r=pf(t)).Ll)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?(s=o[i],r.Dl.has(s)?(mr("SyncEngine","Adding an already active target "+s),[3,5]):[4,cc(r.Sh,s)]):[3,6];case 2:return u=p.sent(),[4,sc(r.Sh,u)];case 3:return a=p.sent(),[4,Uh(r,cf(u),a.targetId,!1)];case 4:p.sent(),Yc(r.gl,a),p.label=5;case 5:return i++,[3,1];case 6:c=function(t){return(0,dr.Jh)(this,(function(e){switch(e.label){case 0:return r.Dl.has(t)?[4,uc(r.Sh,t,!1).then((function(){Qc(r.gl,t),Xh(r,t)})).catch(ya)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,f=n,p.label=7;case 7:return h<f.length?(l=f[h],[5,c(l)]):[3,10];case 8:p.sent(),p.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function pf(t){var e=Tr(t);return e.gl.Ch.Bh=jh.bind(null,e),e.gl.Ch.Sn=nf.bind(null,e),e.gl.Ch.$h=Jh.bind(null,e),e.vl.uh=Eh.bind(null,e.Vl),e.vl.ql=Nh.bind(null,e.Vl),e}function df(t){var e=Tr(t);return e.gl.Ch.qh=zh.bind(null,e),e.gl.Ch.Uh=Hh.bind(null,e),e}var vf=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return(0,dr.mG)(this,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(e){switch(e.label){case 0:return this.Kt=jc(t.gu.T),this.pl=this.jl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Sh=this.Jl(t),[2]}}))}))},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return $a(this.persistence,new Ya,t.Yl,this.Kt)},t.prototype.Gl=function(t){return new Ic(Tc.ra,this.Kt)},t.prototype.jl=function(t){return new Pc},t.prototype.terminate=function(){return(0,dr.mG)(this,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.pl.$o()];case 1:return t.sent(),[4,this.persistence.$o()];case 2:return t.sent(),[2]}}))}))},t}(),yf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return(0,dr.ZT)(e,t),e.prototype.initialize=function(e){return(0,dr.mG)(this,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,fc(this.Sh)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,df(this.Xl.fa)];case 4:return n.sent(),[4,hh(this.Xl.gl)];case 5:return n.sent(),[2]}}))}))},e.prototype.Jl=function(t){return $a(this.persistence,new Ya,t.Yl,this.Kt)},e.prototype.Hl=function(t){var e=this.persistence.mi.dr;return new Pa(e,t.fs)},e.prototype.Gl=function(t){var e=Za(t.gu.T,t.gu.persistenceKey),n=void 0!==this.cacheSizeBytes?va.Zs(this.cacheSizeBytes):va.ni;return new Ha(this.synchronizeTabs,e,t.clientId,n,t.fs,Gc(),qc(),this.Kt,this.pl,!!this.forceOwnership)},e.prototype.jl=function(t){return new Pc},e}(vf),mf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return(0,dr.ZT)(e,t),e.prototype.initialize=function(e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r=this;return(0,dr.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Xl.fa,this.pl instanceof Cc?(this.pl.fa={nu:sf.bind(null,n),su:ff.bind(null,n),iu:lf.bind(null,n),Ko:hf.bind(null,n),eu:of.bind(null,n)},[4,this.pl.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.yo((function(t){return(0,dr.mG)(r,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(e){switch(e.label){case 0:return[4,uf(this.Xl.fa,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.Ir?this.zl.start(this.Sh):t||this.zl.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.jl=function(t){var e=Gc();if(!Cc.Wn(e))throw new Or(kr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Za(t.gu.T,t.gu.persistenceKey);return new Cc(e,t.fs,n,t.clientId,t.Yl)},e}(yf),gf=function(){function t(){}return t.prototype.initialize=function(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n=this;return(0,dr.Jh)(this,(function(r){switch(r.label){case 0:return this.Sh?[3,2]:(this.Sh=t.Sh,this.pl=t.pl,this.Dh=this.Zl(e),this.gl=this.t_(e),this.Vl=this.e_(e),this.fa=this.n_(e,!t.synchronizeTabs),this.pl.da=function(t){return Fh(n.fa,t,1)},this.gl.Ch.s_=ef.bind(null,this.fa),[4,mh(this.gl,this.fa.$l)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.e_=function(t){return new Ih},t.prototype.Zl=function(t){var e,n=jc(t.gu.T),r=(e=t.gu,new Uc(e));return function(t,e,n){return new Bc(t,e,n)}(t.credentials,r,n)},t.prototype.t_=function(t){var e,n,r,i,o,s=this;return e=this.Sh,n=this.Dh,r=t.fs,i=function(t){return Fh(s.fa,t,0)},o=Rc.Wn()?new Rc:new Lc,new Zc(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){var u=new Mh(t,e,n,r,i,o);return s&&(u.Ll=!0),u}(this.Sh,this.gl,this.Vl,this.pl,t.Yl,t.bl,e)},t.prototype.terminate=function(){return function(t){return(0,dr.mG)(this,void 0,void 0,(function(){var e;return(0,dr.Jh)(this,(function(n){switch(n.label){case 0:return e=Tr(t),mr("RemoteStore","RemoteStore shutting down."),e.Fh.add(5),[4,Wc(e)];case 1:return n.sent(),e.kh.$o(),e.Mh.set("Unknown"),[2]}}))}))}(this.gl)},t}();var wf=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),bf=(function(){function t(t,e){var n=this;this.o_=t,this.Kt=e,this.metadata=new cu,this.buffer=new Uint8Array,this.c_=new TextDecoder("utf-8"),this.a_().then((function(t){t&&t.il()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}t.prototype.close=function(){return this.o_.cancel()},t.prototype.getMetadata=function(){return(0,dr.mG)(this,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Kl=function(){return(0,dr.mG)(this,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.a_())]}}))}))},t.prototype.a_=function(){return(0,dr.mG)(this,void 0,void 0,(function(){var t,e,n,r;return(0,dr.Jh)(this,(function(i){switch(i.label){case 0:return[4,this.u_()];case 1:return null===(t=i.sent())?[2,null]:(e=this.c_.decode(t),n=Number(e),isNaN(n)&&this.h_("length string ("+e+") is not valid number"),[4,this.l_(n)]);case 2:return r=i.sent(),[2,new xh(JSON.parse(r),t.length+n)]}}))}))},t.prototype.__=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.u_=function(){return(0,dr.mG)(this,void 0,void 0,(function(){var t,e;return(0,dr.Jh)(this,(function(n){switch(n.label){case 0:return this.__()<0?[4,this.f_()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.__())<0&&this.h_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.l_=function(t){return(0,dr.mG)(this,void 0,void 0,(function(){var e;return(0,dr.Jh)(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.f_()]:[3,3];case 1:n.sent()&&this.h_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.c_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.h_=function(t){throw this.o_.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.f_=function(){return(0,dr.mG)(this,void 0,void 0,(function(){var t,e;return(0,dr.Jh)(this,(function(n){switch(n.label){case 0:return[4,this.o_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))}}(),function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Or(kr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.d_=new Yr(t)}return t.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},t}()),If=function(t){this._methodName=t};function _f(t,e,n){if(!n)throw new Or(kr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Tf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Or(kr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Ef(t,e,n,r){if(!0===e&&!0===r)throw new Or(kr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Nf(t){if(!Qr.Et(t))throw new Or(kr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Sf(t){if(Qr.Et(t))throw new Or(kr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Af(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Ir()}function xf(t,e){if("_delegate"in t&&(t=t._),!(t instanceof e)){if(e.name===t.constructor.name)throw new Or(kr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Af(t);throw new Or(kr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Df(t,e){if(e<=0)throw new Or(kr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var kf=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Or(kr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Or(kr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Ef("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Of=new Map,Cf=function(){function t(t,e){this.w_="(lite)",this.E_=new kf({}),this.T_=!1,t instanceof Ur?(this.I_=t,this.m_=new jr):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Or(kr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ur(t.options.projectId)}(t),this.m_=new Fr(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.A_)throw new Or(kr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),t.prototype.g_=function(t){if(this.T_)throw new Or(kr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new kf(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new jr;switch(t.type){case"gapi":var e=t.client;return _r(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new zr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Or(kr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.V_=function(){return this.E_},t.prototype.p_=function(){return this.T_=!0,this.E_},t.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},t.prototype.b_=function(){return this,(t=Of.get(this))&&(mr("ComponentProvider","Removing Datastore"),Of.delete(this),t.terminate()),Promise.resolve();var t},t}(),Pf=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Rf(this.firestore,this.v_,this.S_.path.Z())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),Lf=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),Rf=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,eo(r))||this).firestore=e,i.D_=r,i.type="collection",i}return(0,dr.ZT)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.C_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.C_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.D_.Z();return t.nt()?null:new Pf(this.firestore,null,new Qr(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.D_)},e}(Lf);function Mf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Pr&&(t=t._),_f("collection","path",e),t instanceof Cf)return Sf(n=Xr.ct.apply(Xr,(0,dr.pr)([e],r))),new Rf(t,null,n);if(!(t instanceof Pf||t instanceof Rf))throw new Or(kr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Sf(n=Xr.ct.apply(Xr,(0,dr.pr)([t.path],r)).child(Xr.ct(e))),new Rf(t.firestore,null,n)}function Vf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Pr&&(t=t._),1===arguments.length&&(e=Nr.t()),_f("doc","path",e),t instanceof Cf)return Nf(n=Xr.ct.apply(Xr,(0,dr.pr)([e],r))),new Pf(t,null,new Qr(n));if(!(t instanceof Pf||t instanceof Rf))throw new Or(kr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Nf(n=t.D_.child(Xr.ct.apply(Xr,(0,dr.pr)([e],r)))),new Pf(t.firestore,t instanceof Rf?t.v_:null,new Qr(n))}function Uf(t,e){return t instanceof Pr&&(t=t._),e instanceof Pr&&(e=e._),(t instanceof Pf||t instanceof Rf)&&(e instanceof Pf||e instanceof Rf)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Gf(t,e){return t instanceof Pr&&(t=t._),e instanceof Pr&&(e=e._),t instanceof Lf&&e instanceof Lf&&t.firestore===e.firestore&&ho(t.C_,e.C_)&&t.v_===e.v_}var qf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Or(kr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Or(kr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.K=function(t){return Sr(this.x_,t.x_)||Sr(this.N_,t.N_)},t}(),jf=/^__.*__$/,Ff=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return null!==this.zt?new zo(t,this.data,this.zt,e,this.fieldTransforms):new Jo(t,this.data,e,this.fieldTransforms)},t}(),Jf=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return new zo(t,this.data,this.zt,e,this.fieldTransforms)},t}();function zf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ir()}}var Hf=function(){function t(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.zt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.O_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return fl(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},t.prototype.contains=function(t){return void 0!==this.zt.find((function(e){return t.st(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.st(e.field)}))},t.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(zf(this.k_)&&jf.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),Bf=function(){function t(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||jc(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new Hf({k_:t,methodName:e,j_:n,path:Yr.at(),B_:!1,W_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},t}();function Kf(t){var e=t.p_(),n=jc(t.I_);return new Bf(t.I_,!!e.ignoreUndefinedProperties,n)}function Zf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);ul("Data must be an object, but it was:",s,r);var u,a,c=ol(r,s);if(o.merge)u=new ni(s.zt),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=al(e,l[f],n);if(!s.contains(p))throw new Or(kr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");ll(h,p)||h.push(p)}u=new ni(h),a=s.fieldTransforms.filter((function(t){return u.It(t.field)}))}else u=null,a=s.fieldTransforms;return new Ff(new Si(c),u,a)}var Xf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,dr.ZT)(e,t),e.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(If);function Wf(t,e,n){return new Hf({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var Yf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,dr.ZT)(e,t),e.prototype.z_=function(t){return new Po(t.path,new No)},e.prototype.isEqual=function(t){return t instanceof e},e}(If),Qf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return(0,dr.ZT)(e,t),e.prototype.z_=function(t){var e=Wf(this,t,!0),n=this.H_.map((function(t){return il(t,e)})),r=new So(n);return new Po(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(If),$f=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return(0,dr.ZT)(e,t),e.prototype.z_=function(t){var e=Wf(this,t,!0),n=this.H_.map((function(t){return il(t,e)})),r=new xo(n);return new Po(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(If),tl=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return(0,dr.ZT)(e,t),e.prototype.z_=function(t){var e=new ko(t.Kt,bo(t.Kt,this.J_));return new Po(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(If);function el(t,e,n,r){var i=t.G_(1,e,n);ul("Data must be an object, but it was:",i,r);var o=[],s=new Ai;ti(r,(function(t,r){var u=hl(e,t,n);r instanceof Pr&&(r=r._);var a=i.U_(u);if(r instanceof Xf)o.push(u);else{var c=il(r,a);null!=c&&(o.push(u),s.set(u,c))}}));var u=new ni(o);return new Jf(s.yt(),u,i.fieldTransforms)}function nl(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[al(e,r,n)],a=[i];if(o.length%2!=0)throw new Or(kr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(al(e,o[c])),a.push(o[c+1]);for(var h=[],f=new Ai,l=u.length-1;l>=0;--l)if(!ll(h,u[l])){var p=u[l],d=a[l];d instanceof Pr&&(d=d._);var v=s.U_(p);if(d instanceof Xf)h.push(p);else{var y=il(d,v);null!=y&&(h.push(p),f.set(p,y))}}var m=new ni(h);return new Jf(f.yt(),m,s.fieldTransforms)}function rl(t,e,n,r){return void 0===r&&(r=!1),il(n,t.G_(r?4:3,e))}function il(t,e){if(t instanceof Pr&&(t=t._),sl(t))return ul("Unsupported field value:",e,t),ol(t,e);if(t instanceof If)return function(t,e){if(!zf(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.zt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=il(o[i],e.Q_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Pr&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return bo(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Br.fromDate(t);return{timestampValue:Ps(e.Kt,n)}}if(t instanceof Br)return n=new Br(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Ps(e.Kt,n)};if(t instanceof qf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Cr)return{bytesValue:Ls(e.Kt,t.l)};if(t instanceof Pf){n=e.T;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Vs(t.firestore.I_||e.T,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+Af(t))}(t,e)}function ol(t,e){var n={};return ei(t)?e.path&&e.path.length>0&&e.zt.push(e.path):ti(t,(function(t,r){var i=il(r,e.L_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function sl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Br||t instanceof qf||t instanceof Cr||t instanceof Pf||t instanceof If)}function ul(t,e,n){if(!sl(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Af(n);throw"an object"===r?e.K_(t+" a custom object"):e.K_(t+" "+r)}}function al(t,e,n){if(e instanceof Pr&&(e=e._),e instanceof bf)return e.d_;if("string"==typeof e)return hl(t,e);throw fl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var cl=new RegExp("[~\\*/\\[\\]]");function hl(t,e,n){if(e.search(cl)>=0)throw fl("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(bf.bind.apply(bf,(0,dr.pr)([void 0],e.split("."))))).d_}catch(r){throw fl("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function fl(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Or(kr.INVALID_ARGUMENT,(u+=". ")+t+a)}function ll(t,e){return t.some((function(t){return t.isEqual(e)}))}var pl=function(){function t(t){this.Dh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return(0,dr.mG)(this,void 0,void 0,(function(){var e,n=this;return(0,dr.Jh)(this,(function(r){switch(r.label){case 0:if(this.nf(),this.mutations.length>0)throw new Or(kr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,u;return(0,dr.Jh)(this,(function(a){switch(a.label){case 0:return n=Tr(t),r=Js(n.Kt)+"/documents",i={documents:e.map((function(t){return Gs(n.Kt,t)}))},[4,n.Cu("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){_r(!!e.found),e.found.name,e.found.updateTime;var n=qs(t,e.found.name),r=Ms(e.found.updateTime),i=new Si({mapValue:{fields:e.found.fields}});return new ki(n,r,i,{})}(t,e):"missing"in e?function(t,e){_r(!!e.missing),_r(!!e.readTime);var n=qs(t,e.missing),r=Ms(e.readTime);return new Oi(n,r)}(t,e):Ir()}(n.Kt,t);s.set(e.key.toString(),e)})),u=[],[2,(e.forEach((function(t){var e=s.get(t.toString());_r(!!e),u.push(e)})),u)]}}))}))}(this.Dh,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof Oi||t instanceof ki?n.sf(t):Ir()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.F_(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new Yo(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return(0,dr.mG)(this,void 0,void 0,(function(){var t,e=this;return(0,dr.Jh)(this,(function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Qr.ft(n);e.mutations.push(new Qo(r,e.Gt(r)))})),[4,function(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,dr.Jh)(this,(function(o){switch(o.label){case 0:return n=Tr(t),r=Js(n.Kt)+"/documents",i={writes:e.map((function(t){return Ks(n.Kt,t)}))},[4,n.bu("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.Dh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}}))}))},t.prototype.sf=function(t){var e;if(t instanceof ki)e=t.version;else{if(!(t instanceof Oi))throw Ir();e=Kr.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Or(kr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.Gt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Ro.updateTime(e):Ro.Wt()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(Kr.min()))throw new Or(kr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ro.updateTime(e)}return Ro.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),dl=function(){function t(t,e,n,r){this.fs=t,this.Dh=e,this.updateFunction=n,this.Ts=r,this.cf=5,this.zu=new Fc(this.fs,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.zu.Bu((function(){return(0,dr.mG)(t,void 0,void 0,(function(){var t,e,n=this;return(0,dr.Jh)(this,(function(r){return t=new pl(this.Dh),(e=this.uf(t))&&e.then((function(e){n.fs.ys((function(){return t.commit().then((function(){n.Ts.resolve(e)})).catch((function(t){n.hf(t)}))}))})).catch((function(t){n.hf(t)})),[2]}))}))}))},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!hi(e)&&e.catch&&e.then?e:(this.Ts.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ts.reject(t),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this.fs.ys((function(){return e.af(),Promise.resolve()}))):this.Ts.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!ts(e)}return!1},t}(),vl=function(){function t(t,e,n){var r=this;this.credentials=t,this.fs=e,this.gu=n,this.user=Gr.UNAUTHENTICATED,this.clientId=Nr.t(),this._f=function(){},this.N=new cu,this.credentials.S((function(t){mr("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.N.resolve()}))}return t.prototype.getConfiguration=function(){return(0,dr.mG)(this,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,gu:this.gu,clientId:this.clientId,credentials:this.credentials,Yl:this.user,bl:100})]}}))}))},t.prototype.ff=function(t){var e=this;this._f=t,this.N.promise.then((function(){return e._f(e.user)}))},t.prototype.df=function(){if(this.fs.wf)throw new Or(kr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.fs.Ef();var e=new cu;return this.fs.Tf((function(){return(0,dr.mG)(t,void 0,void 0,(function(){var t,n;return(0,dr.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.D(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Iu(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function yl(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r,i=this;return(0,dr.Jh)(this,(function(o){switch(o.label){case 0:return t.fs.Af(),mr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.Yl,t.ff((function(n){r.isEqual(n)||(r=n,t.fs.vo((function(){return(0,dr.mG)(i,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(t){switch(t.label){case 0:return[4,tc(e.Sh,n)];case 1:return t.sent(),[2]}}))}))})))})),e.persistence.Vo((function(){return t.terminate()})),t.mf=e,[2]}}))}))}function ml(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r;return(0,dr.Jh)(this,(function(i){switch(i.label){case 0:return t.fs.Af(),[4,gl(t)];case 1:return n=i.sent(),mr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.ff((function(n){return t.fs.vo((function(){return function(t,e){return(0,dr.mG)(this,void 0,void 0,(function(){var n,r;return(0,dr.Jh)(this,(function(i){switch(i.label){case 0:return(n=Tr(t)).fs.Af(),mr("RemoteStore","RemoteStore received new credentials"),r=rh(n),n.Fh.add(3),[4,Wc(n)];case 1:return i.sent(),r&&n.Mh.set("Unknown"),[4,n.Ch.s_(e)];case 2:return i.sent(),n.Fh.delete(3),[4,Xc(n)];case 3:return i.sent(),[2]}}))}))}(e.gl,n)}))})),t.If=e,[2]}}))}))}function gl(t){return(0,dr.mG)(this,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(e){switch(e.label){case 0:return t.mf?[3,2]:(mr("FirestoreClient","Using default OfflineComponentProvider"),[4,yl(t,new vf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}}))}))}function wl(t){return(0,dr.mG)(this,void 0,void 0,(function(){return(0,dr.Jh)(this,(function(e){switch(e.label){case 0:return t.If?[3,2]:(mr("FirestoreClient","Using default OnlineComponentProvider"),[4,ml(t,new gf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}}))}))}function bl(t){return gl(t).then((function(t){return t.persistence}))}function Il(t){return gl(t).then((function(t){return t.Sh}))}function _l(t){return wl(t).then((function(t){return t.gl}))}function Tl(t){return wl(t).then((function(t){return t.fa}))}function El(t){return(0,dr.mG)(this,void 0,void 0,(function(){var e,n;return(0,dr.Jh)(this,(function(r){switch(r.label){case 0:return[4,wl(t)];case 1:return e=r.sent(),[2,((n=e.Vl).Gh=Vh.bind(null,e.fa),n.Jh=Gh.bind(null,e.fa),n)]}}))}))}function Nl(t,e,n){var r=this;void 0===n&&(n={});var i=new cu;return t.fs.ys((function(){return(0,dr.mG)(r,void 0,void 0,(function(){var r;return(0,dr.Jh)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new wf({next:function(o){e.ys((function(){return Th(t,s)}));var u=o.docs.has(n);!u&&o.fromCache?i.reject(new Or(kr.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new Or(kr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Ah(eo(n.path),o,{includeMetadataChanges:!0,sl:!0});return _h(t,s)},[4,El(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}}))}))})),i.promise}function Sl(t,e,n){var r=this;void 0===n&&(n={});var i=new cu;return t.fs.ys((function(){return(0,dr.mG)(r,void 0,void 0,(function(){var r;return(0,dr.Jh)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new wf({next:function(n){e.ys((function(){return Th(t,s)})),n.fromCache&&"server"===r.source?i.reject(new Or(kr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Ah(n,o,{includeMetadataChanges:!0,sl:!0});return _h(t,s)},[4,El(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}}))}))})),i.promise}var Al=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.zu=new Fc(this,"async_queue_retry"),this.vf=function(){var e=qc();e&&mr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.zu.Uu()};var e=qc();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.ys=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=qc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise((function(t){})):this.Df(t)},t.prototype.vo=function(t){var e=this;this.ys((function(){return e.Pf.push(t),e.Cf()}))},t.prototype.Cf=function(){return(0,dr.mG)(this,void 0,void 0,(function(){var t,e=this;return(0,dr.Jh)(this,(function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.zu.reset(),[3,4];case 3:if(!vu(t=n.sent()))throw t;return mr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.zu.Bu((function(){return e.Cf()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Df=function(t){var e=this,n=this.Rf.then((function(){return e.pf=!0,t().catch((function(t){throw e.Vf=t,e.pf=!1,gr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.pf=!1,t}))}));return this.Rf=n,n},t.prototype.mr=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=bu.Is(this,t,e,n,(function(t){return r.xf(t)}));return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&Ir()},t.prototype.Af=function(){},t.prototype.Nf=function(){return(0,dr.mG)(this,void 0,void 0,(function(){var t;return(0,dr.Jh)(this,(function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Ff=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].ds===t)return!0;return!1},t.prototype.Of=function(t){var e=this;return this.Nf().then((function(){e.gf.sort((function(t,e){return t.ws-e.ws}));for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Ps(),"all"!==t&&i.ds===t)break}return e.Nf()}))},t.prototype.kf=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}(),xl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Mf=new Al,r.w_="name"in e?e.name:"[DEFAULT]",r}return(0,dr.ZT)(e,t),e.prototype.b_=function(){return this.Lf||kl(this),this.Lf.terminate()},e}(Cf);function Dl(t){return t.Lf||kl(t),t.Lf.df(),t.Lf}function kl(t){var e=t.p_(),n=function(t,e,n){return new Vr(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.I_,t.w_,e);t.Lf=new vl(t.m_,t.Mf,n)}function Ol(t,e,n){var r=this,i=new cu;return t.fs.enqueue((function(){return(0,dr.mG)(r,void 0,void 0,(function(){var r;return(0,dr.Jh)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,yl(t,n)];case 1:return o.sent(),[4,ml(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===kr.FAILED_PRECONDITION||t.code===kr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function Cl(t){if(t.R_||t.P_)throw new Or(kr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Pl=function(){function t(){}return t.prototype.$f=function(t,e){switch(void 0===e&&(e="none"),pi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return oi(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(si(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.Wf(t.arrayValue,e);case 10:return this.jf(t.mapValue,e);default:throw Ir()}},t.prototype.jf=function(t,e){var n=this,r={};return ti(t.fields||{},(function(t,i){r[t]=n.$f(i,e)})),r},t.prototype.Kf=function(t){return new qf(oi(t.latitude),oi(t.longitude))},t.prototype.Wf=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.$f(t,e)}))},t.prototype.qf=function(t,e){switch(e){case"previous":var n=ai(t);return null==n?null:this.$f(n,e);case"estimate":return this.Bf(ci(t));default:return null}},t.prototype.Bf=function(t){var e=ii(t);return new Br(e.seconds,e.nanos)},t.prototype.Gf=function(t,e){var n=Xr.ct(t);_r(au(n));var r=new Ur(n.get(1),n.get(3)),i=new Qr(n.X(5));return r.isEqual(e)||gr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),Ll=function(){function t(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Pf(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Jf},t.prototype.data=function(){if(this.Jf){if(this.v_){var t=new Rl(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.$f(this.Jf.vt())}},t.prototype.get=function(t){if(this.Jf){var e=this.Jf.data().field(Ml("DocumentSnapshot.get",t));if(null!==e)return this.Hf.$f(e)}},t}(),Rl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,dr.ZT)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Ll);function Ml(t,e){return"string"==typeof e?hl(t,e):e instanceof Pr?e._.d_:e.d_}function Vl(t){if(ro(t)&&0===t.Nt.length)throw new Or(kr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ul=function(){};function Gl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.Yf(t)}return t}var ql=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xf=e,i.Zf=n,i.td=r,i.type="where",i}return(0,dr.ZT)(e,t),e.prototype.Yf=function(t){var e=Kf(t.firestore),n=function(t,e,n,r,i,o,s){var u;if(i.ht()){if("array-contains"===o||"array-contains-any"===o)throw new Or(kr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Kl(s,o);for(var a=[],c=0,h=s;c<h.length;c++){var f=h[c];a.push(Bl(r,t,f))}u={arrayValue:{values:a}}}else u=Bl(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Kl(s,o),u=rl(n,"where",s,"in"===o||"not-in"===o);var l=Ui.create(i,o,u);return function(t,e){if(e.xt()){var n=oo(t);if(null!==n&&!n.isEqual(e.field))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=io(t);null!==r&&Zl(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new Or(kr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Or(kr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t.C_,0,e,t.firestore.I_,this.Xf,this.Zf,this.td);return new Lf(t.firestore,t.v_,function(t,e){var n=t.filters.concat([e]);return new $i(t.path,t.collectionGroup,t.Nt.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,n))},e}(Ul),jl=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Xf=e,r.ed=n,r.type="orderBy",r}return(0,dr.ZT)(e,t),e.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Or(kr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Or(kr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Xi(e,n);return function(t,e){if(null===io(t)){var n=oo(t);null!==n&&Zl(t,n,e.field)}}(t,r),r}(t.C_,this.Xf,this.ed);return new Lf(t.firestore,t.v_,function(t,e){var n=t.Nt.concat([e]);return new $i(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,e))},e}(Ul),Fl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.nd=n,i.sd=r,i}return(0,dr.ZT)(e,t),e.prototype.Yf=function(t){return new Lf(t.firestore,t.v_,co(t.C_,this.nd,this.sd))},e}(Ul),Jl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return(0,dr.ZT)(e,t),e.prototype.Yf=function(t){var e=Hl(t,this.type,this.rd,this.od);return new Lf(t.firestore,t.v_,function(t,e){return new $i(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.C_,e))},e}(Ul),zl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return(0,dr.ZT)(e,t),e.prototype.Yf=function(t){var e=Hl(t,this.type,this.rd,this.od);return new Lf(t.firestore,t.v_,function(t,e){return new $i(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.C_,e))},e}(Ul);function Hl(t,e,n,r){if(n[0]instanceof Pr&&(n[0]=n[0]._),n[0]instanceof Ll)return function(t,e,n,r,i){if(!r)throw new Or(kr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=uo(t);s<u.length;s++){var a=u[s];if(a.field.ht())o.push(bi(e,r.key));else{var c=r.field(a.field);if(ui(c))throw new Or(kr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.ot();throw new Or(kr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Ki(o,i)}(t.C_,t.firestore.I_,e,n[0].Jf,r);var i=Kf(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new Or(kr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ht()){if("string"!=typeof c)throw new Or(kr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!so(t)&&-1!==c.indexOf("/"))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Xr.ct(c));if(!Qr.Et(h))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new Qr(h);u.push(bi(e,f))}else{var l=rl(n,r,c);u.push(l)}}return new Ki(u,o)}(t.C_,t.firestore.I_,i,e,n,r)}function Bl(t,e,n){if(n instanceof Pr&&(n=n._),"string"==typeof n){if(""===n)throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!so(e)&&-1!==n.indexOf("/"))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Xr.ct(n));if(!Qr.Et(r))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return bi(t,new Qr(r))}if(n instanceof Pf)return bi(t,n.S_);throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Af(n)+".")}function Kl(t,e){if(!Array.isArray(t)||0===t.length)throw new Or(kr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Or(kr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Zl(t,e,n){if(!n.isEqual(e))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Xl(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}function Wl(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Yl=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,dr.ZT)(e,t),e.prototype.Uf=function(t){return new Cr(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new Pf(this.firestore,null,e)},e}(Pl),Ql=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),$l=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).zf=e,u.ad=e,u.metadata=o,u}return(0,dr.ZT)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new tp(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.$f(this.Jf.vt(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf){var n=this.Jf.data().field(Ml("DocumentSnapshot.get",t));if(null!==n)return this.Hf.$f(n,e.serverTimestamps)}},e}(Ll),tp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,dr.ZT)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}($l),ep=function(){function t(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new Ql(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.ud.docs.forEach((function(r){t.call(e,new tp(n.zf,n.Hf,r.key,r,new Ql(n.ud.Ce.has(r.key),n.ud.fromCache),n.query.v_))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.ud.Ne)throw new Or(kr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===e||(this.hd=function(t,e){if(t.ud.De.nt()){var n=0;return t.ud.docChanges.map((function(e){var r=new tp(t.zf,t.Hf,e.doc.key,e.doc,new Ql(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t.ud.De;return t.ud.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new tp(t.zf,t.Hf,e.doc.key,e.doc,new Ql(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:np(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this.ld=e),this.hd},t}();function np(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ir()}}function rp(t,e){return t instanceof $l&&e instanceof $l?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof ep&&e instanceof ep&&t.zf===e.zf&&Gf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var ip=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,dr.ZT)(e,t),e.prototype.Uf=function(t){return new Cr(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new Pf(this.firestore,null,e)},e}(Pl);function op(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=xf(t,Pf);var o=xf(t.firestore,xl),s=Kf(o);return e instanceof Pr&&(e=e._),up(o,[("string"==typeof e||e instanceof bf?nl(s,"updateDoc",t.S_,e,n,r):el(s,"updateDoc",t.S_,e)).F_(t.S_,Ro.exists(!0))])}function sp(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t instanceof Pr&&(t=t._);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Xl(i[u])||(s=i[u],u++);var a,c,h,f={includeMetadataChanges:s.includeMetadataChanges};if(Xl(i[u])){var l=i[u];i[u]=null===(e=l.next)||void 0===e?void 0:e.bind(l),i[u+1]=null===(n=l.error)||void 0===n?void 0:n.bind(l),i[u+2]=null===(r=l.complete)||void 0===r?void 0:r.bind(l)}if(t instanceof Pf)c=xf(t.firestore,xl),h=eo(t.S_.path),a={next:function(e){i[u]&&i[u](ap(c,t,e))},error:i[u+1],complete:i[u+2]};else{var p=xf(t,Lf);c=xf(p.firestore,xl),h=p.C_;var d=new ip(c);a={next:function(t){i[u]&&i[u](new ep(c,d,p,t))},error:i[u+1],complete:i[u+2]},Vl(t.C_)}return function(t,e,n,r){var i=this,o=new wf(r),s=new Ah(e,o,n);return t.fs.ys((function(){return(0,dr.mG)(i,void 0,void 0,(function(){var e;return(0,dr.Jh)(this,(function(n){switch(n.label){case 0:return e=_h,[4,El(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.r_(),t.fs.ys((function(){return(0,dr.mG)(i,void 0,void 0,(function(){var e;return(0,dr.Jh)(this,(function(n){switch(n.label){case 0:return e=Th,[4,El(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(Dl(c),h,f,a)}function up(t,e){return function(t,e){var n=this,r=new cu;return t.fs.ys((function(){return(0,dr.mG)(n,void 0,void 0,(function(){var n;return(0,dr.Jh)(this,(function(i){switch(i.label){case 0:return n=qh,[4,Tl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(Dl(t),e)}function ap(t,e,n){var r=n.docs.get(e.S_),i=new ip(t);return new $l(t,i,e.S_,r,new Ql(n.hasPendingWrites,n.fromCache),e.v_)}var cp=function(){function t(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=Kf(t)}return t.prototype.set=function(t,e,n){this.Ed();var r=hp(t,this.zf),i=Wl(r.v_,e,n),o=Zf(this.wd,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.fd.push(o.F_(r.S_,Ro.Wt())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ed();var o,s=hp(t,this.zf);return e instanceof Pr&&(e=e._),o="string"==typeof e||e instanceof bf?nl(this.wd,"WriteBatch.update",s.S_,e,n,r):el(this.wd,"WriteBatch.update",s.S_,e),this.fd.push(o.F_(s.S_,Ro.exists(!0))),this},t.prototype.delete=function(t){this.Ed();var e=hp(t,this.zf);return this.fd=this.fd.concat(new Yo(e.S_,Ro.Wt())),this},t.prototype.commit=function(){return this.Ed(),this.dd=!0,this.fd.length>0?this._d(this.fd):Promise.resolve()},t.prototype.Ed=function(){if(this.dd)throw new Or(kr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function hp(t,e){if(t instanceof Pr&&(t=t._),t.firestore!==e)throw new Or(kr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var fp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).zf=e,r}return(0,dr.ZT)(e,t),e.prototype.get=function(e){var n=this,r=hp(e,this.zf),i=new ip(this.zf);return t.prototype.get.call(this,e).then((function(t){return new $l(n.zf,i,r.S_,t.Jf,new Ql(!1,!1),r.v_)}))},e}(function(){function t(t,e){this.zf=t,this.Td=e,this.wd=Kf(t)}return t.prototype.get=function(t){var e=this,n=hp(t,this.zf),r=new Yl(this.zf);return this.Td.ef([n.S_]).then((function(t){if(!t||1!==t.length)return Ir();var i=t[0];if(i instanceof Oi)return new Ll(e.zf,r,n.S_,null,n.v_);if(i instanceof ki)return new Ll(e.zf,r,i.key,i,n.v_);throw Ir()}))},t.prototype.set=function(t,e,n){var r=hp(t,this.zf),i=Wl(r.v_,e,n),o=Zf(this.wd,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Td.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=hp(t,this.zf);return e instanceof Pr&&(e=e._),o="string"==typeof e||e instanceof bf?nl(this.wd,"Transaction.update",s.S_,e,n,r):el(this.wd,"Transaction.update",s.S_,e),this.Td.update(s.S_,o),this},t.prototype.delete=function(t){var e=hp(t,this.zf);return this.Td.delete(e.S_),this},t}()),lp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Cl(t=xf(t,xl));var n=Dl(t),r=t.p_(),i=new gf;return Ol(n,i,new yf(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Cl(t=xf(t,xl));var e=Dl(t),n=t.p_(),r=new gf;return Ol(e,r,new mf(r,n.cacheSizeBytes))}(t._)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new Or(kr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new cu;return t.Mf.Tf((function(){return(0,dr.mG)(e,void 0,void 0,(function(){var e;return(0,dr.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return(0,dr.mG)(this,void 0,void 0,(function(){var e;return(0,dr.Jh)(this,(function(n){switch(n.label){case 0:return lu.Wn()?(e=t+"main",[4,lu.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(Za(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._)},t}(),pp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Id=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof Ur||(i.md=e),i}return(0,dr.ZT)(e,t),Object.defineProperty(e.prototype,"I_",{get:function(){return this._.I_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.V_()),t)).merge,this._.g_(t)},e.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this._.V_().host&&wr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.fs.enqueue((function(){return(0,dr.mG)(e,void 0,void 0,(function(){var e,n;return(0,dr.Jh)(this,(function(r){switch(r.label){case 0:return[4,bl(t)];case 1:return e=r.sent(),[4,_l(t)];case 2:return n=r.sent(),[2,(e.po(!0),function(t){var e=Tr(t);return e.Fh.delete(0),Xc(e)}(n))]}}))}))}))}(Dl(xf(this._,xl)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.fs.enqueue((function(){return(0,dr.mG)(e,void 0,void 0,(function(){var e,n;return(0,dr.Jh)(this,(function(r){switch(r.label){case 0:return[4,bl(t)];case 1:return e=r.sent(),[4,_l(t)];case 2:return n=r.sent(),[2,(e.po(!1),function(t){return(0,dr.mG)(this,void 0,void 0,(function(){var e;return(0,dr.Jh)(this,(function(n){switch(n.label){case 0:return(e=Tr(t)).Fh.add(0),[4,Wc(e)];case 1:return n.sent(),e.Mh.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(Dl(xf(this._,xl)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Ef("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new cu;return t.fs.ys((function(){return(0,dr.mG)(e,void 0,void 0,(function(){var e;return(0,dr.Jh)(this,(function(r){switch(r.label){case 0:return e=Bh,[4,Tl(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(Dl(xf(this._,xl)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new wf(e);return t.fs.ys((function(){return(0,dr.mG)(n,void 0,void 0,(function(){var e;return(0,dr.Jh)(this,(function(n){switch(n.label){case 0:return e=function(t,e){Tr(t).jh.add(e),e.next()},[4,El(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.r_(),t.fs.ys((function(){return(0,dr.mG)(n,void 0,void 0,(function(){var e;return(0,dr.Jh)(this,(function(n){switch(n.label){case 0:return e=function(t,e){Tr(t).jh.delete(e)},[4,El(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(Dl(t=xf(t,xl)),Xl(e)?e:{next:e})}(this._,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.md)throw new Or(kr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Sp(this,Mf(this._,t))}catch(t){throw gp(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new mp(this,Vf(this._,t))}catch(t){throw gp(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new Tp(this,function(t,e){if(t=xf(t,Cf),_f("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Or(kr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Lf(t,null,function(t){return new $i(Xr.at(),t)}(e))}(this._,t))}catch(t){throw gp(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new cu;return t.fs.ys((function(){return(0,dr.mG)(n,void 0,void 0,(function(){var n;return(0,dr.Jh)(this,(function(i){switch(i.label){case 0:return[4,function(t){return wl(t).then((function(t){return t.Dh}))}(t)];case 1:return n=i.sent(),new dl(t.fs,n,e,r).run(),[2]}}))}))})),r.promise}(Dl(t),(function(n){return e(new fp(t,n))}))}(this._,(function(n){return t(new vp(e,n))}))},e.prototype.batch=function(){var t=this;return Dl(this._),new yp(new cp(this._,(function(e){return up(t._,e)})))},e.prototype.loadBundle=function(t){throw new Or(kr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new Or(kr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(Pr),dp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,dr.ZT)(e,t),e.prototype.Uf=function(t){return new Mr(new Cr(t))},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return mp.Ad(e,this.firestore,null)},e}(Pl);var vp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return(0,dr.ZT)(e,t),e.prototype.get=function(t){var e=this,n=Ap(t);return this._.get(n).then((function(t){return new Ip(e.zf,t)}))},e.prototype.set=function(t,e,n){var r=Ap(t);return n?(Tf("Transaction.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Ap(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,(0,dr.pr)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Ap(t);return this._.delete(e),this},e}(Pr),yp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,dr.ZT)(e,t),e.prototype.set=function(t,e,n){var r=Ap(t);return n?(Tf("WriteBatch.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Ap(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,(0,dr.pr)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Ap(t);return this._.delete(e),this},e.prototype.commit=function(){return this._.commit()},e}(Pr),mp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new dp(e),r}return(0,dr.ZT)(e,t),e.Rd=function(t,n,r){if(t.length%2!=0)throw new Or(kr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new e(n,new Pf(n._,r,new Qr(t)))},e.Ad=function(t,n,r){return new e(n,new Pf(n._,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Sp(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Sp(this.firestore,Mf(this._,t))}catch(t){throw gp(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof Pr&&(t=t._),t instanceof Pf&&Uf(this._,t)},e.prototype.set=function(t,e){e=Tf("DocumentReference.set",e);try{return function(t,e,n){t=xf(t,Pf);var r=xf(t.firestore,xl),i=Wl(t.v_,e,n);return up(r,[Zf(Kf(r),"setDoc",t.S_,i,null!==t.v_,n).F_(t.S_,Ro.Wt())])}(this._,t,e)}catch(t){throw gp(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?op(this._,t):op.apply(void 0,(0,dr.pr)([this._,t,e],n))}catch(t){throw gp(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return up(xf((t=this._).firestore,xl),[new Yo(t.S_,Ro.Wt())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=wp(e),i=bp(e,(function(e){return new Ip(t.firestore,new $l(t.firestore._,t.Hf,e.S_,e.Jf,e.metadata,t._.v_))}));return sp(this._,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=xf(t,Pf);var e=xf(t.firestore,xl),n=Dl(e),r=new ip(e);return function(t,e){var n=this,r=new cu;return t.fs.ys((function(){return(0,dr.mG)(n,void 0,void 0,(function(){var n;return(0,dr.Jh)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return(0,dr.mG)(this,void 0,void 0,(function(){var r,i;return(0,dr.Jh)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Tr(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Ic.Jo(t,e)}))}(t,e)];case 1:return(i=o.sent())instanceof ki?n.resolve(i):i instanceof Oi?n.resolve(null):n.reject(new Or(kr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Iu(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,Il(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t.S_).then((function(n){return new $l(e,r,t.S_,n,new Ql(n instanceof ki&&n.bt,!0),t.v_)}))}(this._):"server"===(null==t?void 0:t.source)?function(t){t=xf(t,Pf);var e=xf(t.firestore,xl);return Nl(Dl(e),t.S_,{source:"server"}).then((function(n){return ap(e,t,n)}))}(this._):function(t){t=xf(t,Pf);var e=xf(t.firestore,xl);return Nl(Dl(e),t.S_).then((function(n){return ap(e,t,n)}))}(this._)).then((function(t){return new Ip(e.firestore,new $l(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))}))},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(Pr);function gp(t,e,n){return t.message=t.message.replace(e,n),t}function wp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Xl(r))return r}return{}}function bp(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Xl(t[0])?t[0]:Xl(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Ip=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return(0,dr.ZT)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new mp(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this._.data(t)},e.prototype.get=function(t,e){return this._.get(t,e)},e.prototype.isEqual=function(t){return rp(this._,t._)},e}(Pr),_p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,dr.ZT)(e,t),e.prototype.data=function(t){return this._.data(t)},e}(Ip),Tp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new dp(e),r}return(0,dr.ZT)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,Gl(this._,function(t,e,n){var r=e,i=Ml("where",t);return new ql(i,r,n)}(t,n,r)))}catch(t){throw gp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,Gl(this._,function(t,e){void 0===e&&(e="asc");var n=e,r=Ml("orderBy",t);return new jl(r,n)}(t,n)))}catch(t){throw gp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,Gl(this._,function(t){return Df("limit",t),new Fl("limit",t,"F")}(t)))}catch(t){throw gp(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,Gl(this._,function(t){return Df("limitToLast",t),new Fl("limitToLast",t,"L")}(t)))}catch(t){throw gp(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Gl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Jl("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw gp(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Gl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Jl("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw gp(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Gl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new zl("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw gp(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Gl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new zl("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw gp(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return Gf(this._,t._)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=xf(t,Lf);var e=xf(t.firestore,xl),n=Dl(e),r=new ip(e);return function(t,e){var n=this,r=new cu;return t.fs.ys((function(){return(0,dr.mG)(n,void 0,void 0,(function(){var n;return(0,dr.Jh)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return(0,dr.mG)(this,void 0,void 0,(function(){var r,i,o,s,u;return(0,dr.Jh)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,ac(t,e,!0)];case 1:return u=a.sent(),r=new Ph(e,u.Pc),i=r.dl(u.documents),o=r.Ti(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=a.sent(),u=Iu(s,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}}))}))},[4,Il(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t.C_).then((function(n){return new ep(e,r,t,n)}))}(this._):"server"===(null==t?void 0:t.source)?function(t){t=xf(t,Lf);var e=xf(t.firestore,xl),n=Dl(e),r=new ip(e);return Sl(n,t.C_,{source:"server"}).then((function(n){return new ep(e,r,t,n)}))}(this._):function(t){t=xf(t,Lf);var e=xf(t.firestore,xl),n=Dl(e),r=new ip(e);return Vl(t.C_),Sl(n,t.C_).then((function(n){return new ep(e,r,t,n)}))}(this._)).then((function(t){return new Np(e.firestore,new ep(e.firestore._,e.Hf,e._,t.ud))}))},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=wp(e),i=bp(e,(function(e){return new Np(t.firestore,new ep(t.firestore._,t.Hf,t._,e.ud))}));return sp(this._,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(Pr),Ep=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return(0,dr.ZT)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new _p(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),e}(Pr),Np=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return(0,dr.ZT)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new Tp(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this._.docs.map((function(e){return new _p(t.zf,e)}))},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map((function(t){return new Ep(e.zf,t)}))},e.prototype.forEach=function(t,e){var n=this;this._.forEach((function(r){t.call(e,new _p(n.zf,r))}))},e.prototype.isEqual=function(t){return rp(this._,t._)},e}(Pr),Sp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._=n,r}return(0,dr.ZT)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._.parent;return t?new mp(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new mp(this.firestore,void 0===t?Vf(this._):Vf(this._,t))}catch(t){throw gp(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=xf(t.firestore,xl),r=Vf(t),i=Wl(t.v_,e);return up(n,[Zf(Kf(t.firestore),"addDoc",r.S_,i,null!==t.v_,{}).F_(r.S_,Ro.exists(!1))]).then((function(){return r}))}(this._,t).then((function(t){return new mp(e.firestore,t)}))},e.prototype.isEqual=function(t){return Uf(this._,t._)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(Tp);function Ap(t){return t instanceof Pr&&(t=t._),xf(t,Pf)}var xp=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(bf.bind.apply(bf,(0,dr.pr)([void 0],e))))||this}return(0,dr.ZT)(e,t),e.documentId=function(){return new e(Yr.lt().ot())},e.prototype.isEqual=function(t){return t instanceof Pr&&(t=t._),t instanceof bf&&this._.d_.isEqual(t.d_)},e}(Pr),Dp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,dr.ZT)(e,t),e.serverTimestamp=function(){var t=new Yf("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new Xf("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Qf("arrayUnion",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new $f("arrayRemove",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new tl("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e}(Pr);!function(){function t(){this.Pd={},this.yd=new cu,this.gd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this.Pd={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this.yd.promise.catch(t)},t.prototype.then=function(t,e){return this.yd.promise.then(t,e)},t.prototype.Ul=function(t){this.Ql(t),this.Pd.complete&&this.Pd.complete(),this.yd.resolve(t)},t.prototype.Wl=function(t){this.gd.taskState="Error",this.Pd.next&&this.Pd.next(this.gd),this.Pd.error&&this.Pd.error(t),this.yd.reject(t)},t.prototype.Ql=function(t){this.gd=t,this.Pd.next&&this.Pd.next(t)}}();var kp,Op=n(767),Cp={Firestore:pp,GeoPoint:qf,Timestamp:Br,Blob:Mr,Transaction:vp,WriteBatch:yp,DocumentReference:mp,DocumentSnapshot:Ip,Query:Tp,QueryDocumentSnapshot:_p,QuerySnapshot:Np,CollectionReference:Sp,FieldPath:xp,FieldValue:Dp,setLogLevel:function(t){var e;e=t,vr.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Op.wA("firestore",(function(t){return function(t,e){return new pp(t,new xl(t,e),new lp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},Cp)))})(kp=r.Z),kp.registerVersion("@firebase/firestore","2.1.1")}}]);